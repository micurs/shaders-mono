(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();function Id(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Kf={exports:{}},al={},Zf={exports:{}},Zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ro=Symbol.for("react.element"),Cd=Symbol.for("react.portal"),Td=Symbol.for("react.fragment"),bd=Symbol.for("react.strict_mode"),Ed=Symbol.for("react.profiler"),Dd=Symbol.for("react.provider"),Ad=Symbol.for("react.context"),Fd=Symbol.for("react.forward_ref"),Rd=Symbol.for("react.suspense"),Od=Symbol.for("react.memo"),Ud=Symbol.for("react.lazy"),bc=Symbol.iterator;function Bd(t){return t===null||typeof t!="object"?null:(t=bc&&t[bc]||t["@@iterator"],typeof t=="function"?t:null)}var Jf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},t1=Object.assign,e1={};function jn(t,e,s){this.props=t,this.context=e,this.refs=e1,this.updater=s||Jf}jn.prototype.isReactComponent={};jn.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};jn.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function i1(){}i1.prototype=jn.prototype;function Mu(t,e,s){this.props=t,this.context=e,this.refs=e1,this.updater=s||Jf}var Pu=Mu.prototype=new i1;Pu.constructor=Mu;t1(Pu,jn.prototype);Pu.isPureReactComponent=!0;var Ec=Array.isArray,s1=Object.prototype.hasOwnProperty,_u={current:null},r1={key:!0,ref:!0,__self:!0,__source:!0};function n1(t,e,s){var r,n={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)s1.call(e,r)&&!r1.hasOwnProperty(r)&&(n[r]=e[r]);var l=arguments.length-2;if(l===1)n.children=s;else if(1<l){for(var h=Array(l),u=0;u<l;u++)h[u]=arguments[u+2];n.children=h}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)n[r]===void 0&&(n[r]=l[r]);return{$$typeof:Ro,type:t,key:o,ref:a,props:n,_owner:_u.current}}function jd(t,e){return{$$typeof:Ro,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Lu(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ro}function $d(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return e[s]})}var Dc=/\/+/g;function Vl(t,e){return typeof t=="object"&&t!==null&&t.key!=null?$d(""+t.key):e.toString(36)}function ma(t,e,s,r,n){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Ro:case Cd:a=!0}}if(a)return a=t,n=n(a),t=r===""?"."+Vl(a,0):r,Ec(n)?(s="",t!=null&&(s=t.replace(Dc,"$&/")+"/"),ma(n,e,s,"",function(u){return u})):n!=null&&(Lu(n)&&(n=jd(n,s+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(Dc,"$&/")+"/")+t)),e.push(n)),1;if(a=0,r=r===""?".":r+":",Ec(t))for(var l=0;l<t.length;l++){o=t[l];var h=r+Vl(o,l);a+=ma(o,e,s,h,n)}else if(h=Bd(t),typeof h=="function")for(t=h.call(t),l=0;!(o=t.next()).done;)o=o.value,h=r+Vl(o,l++),a+=ma(o,e,s,h,n);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ho(t,e,s){if(t==null)return t;var r=[],n=0;return ma(t,r,"","",function(o){return e.call(s,o,n++)}),r}function Gd(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xi={current:null},va={transition:null},Hd={ReactCurrentDispatcher:Xi,ReactCurrentBatchConfig:va,ReactCurrentOwner:_u};Zt.Children={map:Ho,forEach:function(t,e,s){Ho(t,function(){e.apply(this,arguments)},s)},count:function(t){var e=0;return Ho(t,function(){e++}),e},toArray:function(t){return Ho(t,function(e){return e})||[]},only:function(t){if(!Lu(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Zt.Component=jn;Zt.Fragment=Td;Zt.Profiler=Ed;Zt.PureComponent=Mu;Zt.StrictMode=bd;Zt.Suspense=Rd;Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hd;Zt.cloneElement=function(t,e,s){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=t1({},t.props),n=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=_u.current),e.key!==void 0&&(n=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(h in e)s1.call(e,h)&&!r1.hasOwnProperty(h)&&(r[h]=e[h]===void 0&&l!==void 0?l[h]:e[h])}var h=arguments.length-2;if(h===1)r.children=s;else if(1<h){l=Array(h);for(var u=0;u<h;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Ro,type:t.type,key:n,ref:o,props:r,_owner:a}};Zt.createContext=function(t){return t={$$typeof:Ad,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Dd,_context:t},t.Consumer=t};Zt.createElement=n1;Zt.createFactory=function(t){var e=n1.bind(null,t);return e.type=t,e};Zt.createRef=function(){return{current:null}};Zt.forwardRef=function(t){return{$$typeof:Fd,render:t}};Zt.isValidElement=Lu;Zt.lazy=function(t){return{$$typeof:Ud,_payload:{_status:-1,_result:t},_init:Gd}};Zt.memo=function(t,e){return{$$typeof:Od,type:t,compare:e===void 0?null:e}};Zt.startTransition=function(t){var e=va.transition;va.transition={};try{t()}finally{va.transition=e}};Zt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Zt.useCallback=function(t,e){return Xi.current.useCallback(t,e)};Zt.useContext=function(t){return Xi.current.useContext(t)};Zt.useDebugValue=function(){};Zt.useDeferredValue=function(t){return Xi.current.useDeferredValue(t)};Zt.useEffect=function(t,e){return Xi.current.useEffect(t,e)};Zt.useId=function(){return Xi.current.useId()};Zt.useImperativeHandle=function(t,e,s){return Xi.current.useImperativeHandle(t,e,s)};Zt.useInsertionEffect=function(t,e){return Xi.current.useInsertionEffect(t,e)};Zt.useLayoutEffect=function(t,e){return Xi.current.useLayoutEffect(t,e)};Zt.useMemo=function(t,e){return Xi.current.useMemo(t,e)};Zt.useReducer=function(t,e,s){return Xi.current.useReducer(t,e,s)};Zt.useRef=function(t){return Xi.current.useRef(t)};Zt.useState=function(t){return Xi.current.useState(t)};Zt.useSyncExternalStore=function(t,e,s){return Xi.current.useSyncExternalStore(t,e,s)};Zt.useTransition=function(){return Xi.current.useTransition()};Zt.version="18.2.0";Zf.exports=Zt;var Vu=Zf.exports;const Ns=Id(Vu);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wd=Vu,qd=Symbol.for("react.element"),Qd=Symbol.for("react.fragment"),Yd=Object.prototype.hasOwnProperty,Xd=Wd.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Kd={key:!0,ref:!0,__self:!0,__source:!0};function o1(t,e,s){var r,n={},o=null,a=null;s!==void 0&&(o=""+s),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Yd.call(e,r)&&!Kd.hasOwnProperty(r)&&(n[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:qd,type:t,key:o,ref:a,props:n,_owner:Xd.current}}al.Fragment=Qd;al.jsx=o1;al.jsxs=o1;Kf.exports=al;var ye=Kf.exports,ah={},a1={exports:{}},vs={},l1={exports:{}},h1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,W){var V=L.length;L.push(W);t:for(;0<V;){var q=V-1>>>1,H=L[q];if(0<n(H,W))L[q]=W,L[V]=H,V=q;else break t}}function s(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var W=L[0],V=L.pop();if(V!==W){L[0]=V;t:for(var q=0,H=L.length,Q=H>>>1;q<Q;){var vt=2*(q+1)-1,Dt=L[vt],It=vt+1,K=L[It];if(0>n(Dt,V))It<H&&0>n(K,Dt)?(L[q]=K,L[It]=V,q=It):(L[q]=Dt,L[vt]=V,q=vt);else if(It<H&&0>n(K,V))L[q]=K,L[It]=V,q=It;else break t}}return W}function n(L,W){var V=L.sortIndex-W.sortIndex;return V!==0?V:L.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var h=[],u=[],c=1,f=null,p=3,g=!1,y=!1,v=!1,z=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function d(L){for(var W=s(u);W!==null;){if(W.callback===null)r(u);else if(W.startTime<=L)r(u),W.sortIndex=W.expirationTime,e(h,W);else break;W=s(u)}}function w(L){if(v=!1,d(L),!y)if(s(h)!==null)y=!0,zt(N);else{var W=s(u);W!==null&&tt(w,W.startTime-L)}}function N(L,W){y=!1,v&&(v=!1,x(O),O=-1),g=!0;var V=p;try{for(d(W),f=s(h);f!==null&&(!(f.expirationTime>W)||L&&!R());){var q=f.callback;if(typeof q=="function"){f.callback=null,p=f.priorityLevel;var H=q(f.expirationTime<=W);W=t.unstable_now(),typeof H=="function"?f.callback=H:f===s(h)&&r(h),d(W)}else r(h);f=s(h)}if(f!==null)var Q=!0;else{var vt=s(u);vt!==null&&tt(w,vt.startTime-W),Q=!1}return Q}finally{f=null,p=V,g=!1}}var S=!1,k=null,O=-1,E=5,M=-1;function R(){return!(t.unstable_now()-M<E)}function D(){if(k!==null){var L=t.unstable_now();M=L;var W=!0;try{W=k(!0,L)}finally{W?A():(S=!1,k=null)}}else S=!1}var A;if(typeof m=="function")A=function(){m(D)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,st=P.port2;P.port1.onmessage=D,A=function(){st.postMessage(null)}}else A=function(){z(D,0)};function zt(L){k=L,S||(S=!0,A())}function tt(L,W){O=z(function(){L(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,zt(N))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return s(h)},t.unstable_next=function(L){switch(p){case 1:case 2:case 3:var W=3;break;default:W=p}var V=p;p=W;try{return L()}finally{p=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,W){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var V=p;p=L;try{return W()}finally{p=V}},t.unstable_scheduleCallback=function(L,W,V){var q=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?q+V:q):V=q,L){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=V+H,L={id:c++,callback:W,priorityLevel:L,startTime:V,expirationTime:H,sortIndex:-1},V>q?(L.sortIndex=V,e(u,L),s(h)===null&&L===s(u)&&(v?(x(O),O=-1):v=!0,tt(w,V-q))):(L.sortIndex=H,e(h,L),y||g||(y=!0,zt(N))),L},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(L){var W=p;return function(){var V=p;p=W;try{return L.apply(this,arguments)}finally{p=V}}}})(h1);l1.exports=h1;var Zd=l1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u1=Vu,ms=Zd;function X(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)e+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c1=new Set,wo={};function nn(t,e){Dn(t,e),Dn(t+"Capture",e)}function Dn(t,e){for(wo[t]=e,t=0;t<e.length;t++)c1.add(e[t])}var vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lh=Object.prototype.hasOwnProperty,Jd=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ac={},Fc={};function tm(t){return lh.call(Fc,t)?!0:lh.call(Ac,t)?!1:Jd.test(t)?Fc[t]=!0:(Ac[t]=!0,!1)}function em(t,e,s,r){if(s!==null&&s.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function im(t,e,s,r){if(e===null||typeof e>"u"||em(t,e,s,r))return!0;if(r)return!1;if(s!==null)switch(s.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ki(t,e,s,r,n,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=s,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var Mi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Mi[t]=new Ki(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Mi[e]=new Ki(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Mi[t]=new Ki(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Mi[t]=new Ki(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Mi[t]=new Ki(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Mi[t]=new Ki(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Mi[t]=new Ki(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Mi[t]=new Ki(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Mi[t]=new Ki(t,5,!1,t.toLowerCase(),null,!1,!1)});var Iu=/[\-:]([a-z])/g;function Cu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Iu,Cu);Mi[e]=new Ki(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Iu,Cu);Mi[e]=new Ki(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Iu,Cu);Mi[e]=new Ki(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Mi[t]=new Ki(t,1,!1,t.toLowerCase(),null,!1,!1)});Mi.xlinkHref=new Ki("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Mi[t]=new Ki(t,1,!1,t.toLowerCase(),null,!0,!0)});function Tu(t,e,s,r){var n=Mi.hasOwnProperty(e)?Mi[e]:null;(n!==null?n.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(im(e,s,n,r)&&(s=null),r||n===null?tm(e)&&(s===null?t.removeAttribute(e):t.setAttribute(e,""+s)):n.mustUseProperty?t[n.propertyName]=s===null?n.type===3?!1:"":s:(e=n.attributeName,r=n.attributeNamespace,s===null?t.removeAttribute(e):(n=n.type,s=n===3||n===4&&s===!0?"":""+s,r?t.setAttributeNS(r,e,s):t.setAttribute(e,s))))}var wr=u1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wo=Symbol.for("react.element"),dn=Symbol.for("react.portal"),mn=Symbol.for("react.fragment"),bu=Symbol.for("react.strict_mode"),hh=Symbol.for("react.profiler"),f1=Symbol.for("react.provider"),p1=Symbol.for("react.context"),Eu=Symbol.for("react.forward_ref"),uh=Symbol.for("react.suspense"),ch=Symbol.for("react.suspense_list"),Du=Symbol.for("react.memo"),kr=Symbol.for("react.lazy"),d1=Symbol.for("react.offscreen"),Rc=Symbol.iterator;function Qn(t){return t===null||typeof t!="object"?null:(t=Rc&&t[Rc]||t["@@iterator"],typeof t=="function"?t:null)}var Xe=Object.assign,Il;function ro(t){if(Il===void 0)try{throw Error()}catch(s){var e=s.stack.trim().match(/\n( *(at )?)/);Il=e&&e[1]||""}return`
`+Il+t}var Cl=!1;function Tl(t,e){if(!t||Cl)return"";Cl=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),o=r.stack.split(`
`),a=n.length-1,l=o.length-1;1<=a&&0<=l&&n[a]!==o[l];)l--;for(;1<=a&&0<=l;a--,l--)if(n[a]!==o[l]){if(a!==1||l!==1)do if(a--,l--,0>l||n[a]!==o[l]){var h=`
`+n[a].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=a&&0<=l);break}}}finally{Cl=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?ro(t):""}function sm(t){switch(t.tag){case 5:return ro(t.type);case 16:return ro("Lazy");case 13:return ro("Suspense");case 19:return ro("SuspenseList");case 0:case 2:case 15:return t=Tl(t.type,!1),t;case 11:return t=Tl(t.type.render,!1),t;case 1:return t=Tl(t.type,!0),t;default:return""}}function fh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case mn:return"Fragment";case dn:return"Portal";case hh:return"Profiler";case bu:return"StrictMode";case uh:return"Suspense";case ch:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case p1:return(t.displayName||"Context")+".Consumer";case f1:return(t._context.displayName||"Context")+".Provider";case Eu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Du:return e=t.displayName||null,e!==null?e:fh(t.type)||"Memo";case kr:e=t._payload,t=t._init;try{return fh(t(e))}catch{}}return null}function rm(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fh(e);case 8:return e===bu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Rr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function m1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function nm(t){var e=m1(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var n=s.get,o=s.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:s.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function qo(t){t._valueTracker||(t._valueTracker=nm(t))}function v1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var s=e.getValue(),r="";return t&&(r=m1(t)?t.checked?"true":"false":t.value),t=r,t!==s?(e.setValue(t),!0):!1}function Va(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ph(t,e){var s=e.checked;return Xe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function Oc(t,e){var s=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;s=Rr(e.value!=null?e.value:s),t._wrapperState={initialChecked:r,initialValue:s,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function y1(t,e){e=e.checked,e!=null&&Tu(t,"checked",e,!1)}function dh(t,e){y1(t,e);var s=Rr(e.value),r=e.type;if(s!=null)r==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?mh(t,e.type,s):e.hasOwnProperty("defaultValue")&&mh(t,e.type,Rr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Uc(t,e,s){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,s||e===t.value||(t.value=e),t.defaultValue=e}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function mh(t,e,s){(e!=="number"||Va(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var no=Array.isArray;function _n(t,e,s,r){if(t=t.options,e){e={};for(var n=0;n<s.length;n++)e["$"+s[n]]=!0;for(s=0;s<t.length;s++)n=e.hasOwnProperty("$"+t[s].value),t[s].selected!==n&&(t[s].selected=n),n&&r&&(t[s].defaultSelected=!0)}else{for(s=""+Rr(s),e=null,n=0;n<t.length;n++){if(t[n].value===s){t[n].selected=!0,r&&(t[n].defaultSelected=!0);return}e!==null||t[n].disabled||(e=t[n])}e!==null&&(e.selected=!0)}}function vh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return Xe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Bc(t,e){var s=e.value;if(s==null){if(s=e.children,e=e.defaultValue,s!=null){if(e!=null)throw Error(X(92));if(no(s)){if(1<s.length)throw Error(X(93));s=s[0]}e=s}e==null&&(e=""),s=e}t._wrapperState={initialValue:Rr(s)}}function x1(t,e){var s=Rr(e.value),r=Rr(e.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),e.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),r!=null&&(t.defaultValue=""+r)}function jc(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function g1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?g1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Qo,w1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,s,r,n){MSApp.execUnsafeLocalFunction(function(){return t(e,s,r,n)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Qo=Qo||document.createElement("div"),Qo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Qo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zo(t,e){if(e){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=e;return}}t.textContent=e}var uo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},om=["Webkit","ms","Moz","O"];Object.keys(uo).forEach(function(t){om.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),uo[e]=uo[t]})});function z1(t,e,s){return e==null||typeof e=="boolean"||e===""?"":s||typeof e!="number"||e===0||uo.hasOwnProperty(t)&&uo[t]?(""+e).trim():e+"px"}function N1(t,e){t=t.style;for(var s in e)if(e.hasOwnProperty(s)){var r=s.indexOf("--")===0,n=z1(s,e[s],r);s==="float"&&(s="cssFloat"),r?t.setProperty(s,n):t[s]=n}}var am=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xh(t,e){if(e){if(am[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function gh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wh=null;function Au(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zh=null,Ln=null,Vn=null;function $c(t){if(t=Bo(t)){if(typeof zh!="function")throw Error(X(280));var e=t.stateNode;e&&(e=fl(e),zh(t.stateNode,t.type,e))}}function S1(t){Ln?Vn?Vn.push(t):Vn=[t]:Ln=t}function k1(){if(Ln){var t=Ln,e=Vn;if(Vn=Ln=null,$c(t),e)for(t=0;t<e.length;t++)$c(e[t])}}function M1(t,e){return t(e)}function P1(){}var bl=!1;function _1(t,e,s){if(bl)return t(e,s);bl=!0;try{return M1(t,e,s)}finally{bl=!1,(Ln!==null||Vn!==null)&&(P1(),k1())}}function No(t,e){var s=t.stateNode;if(s===null)return null;var r=fl(s);if(r===null)return null;s=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break t;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(X(231,e,typeof s));return s}var Nh=!1;if(vr)try{var Yn={};Object.defineProperty(Yn,"passive",{get:function(){Nh=!0}}),window.addEventListener("test",Yn,Yn),window.removeEventListener("test",Yn,Yn)}catch{Nh=!1}function lm(t,e,s,r,n,o,a,l,h){var u=Array.prototype.slice.call(arguments,3);try{e.apply(s,u)}catch(c){this.onError(c)}}var co=!1,Ia=null,Ca=!1,Sh=null,hm={onError:function(t){co=!0,Ia=t}};function um(t,e,s,r,n,o,a,l,h){co=!1,Ia=null,lm.apply(hm,arguments)}function cm(t,e,s,r,n,o,a,l,h){if(um.apply(this,arguments),co){if(co){var u=Ia;co=!1,Ia=null}else throw Error(X(198));Ca||(Ca=!0,Sh=u)}}function on(t){var e=t,s=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(s=e.return),t=e.return;while(t)}return e.tag===3?s:null}function L1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Gc(t){if(on(t)!==t)throw Error(X(188))}function fm(t){var e=t.alternate;if(!e){if(e=on(t),e===null)throw Error(X(188));return e!==t?null:t}for(var s=t,r=e;;){var n=s.return;if(n===null)break;var o=n.alternate;if(o===null){if(r=n.return,r!==null){s=r;continue}break}if(n.child===o.child){for(o=n.child;o;){if(o===s)return Gc(n),t;if(o===r)return Gc(n),e;o=o.sibling}throw Error(X(188))}if(s.return!==r.return)s=n,r=o;else{for(var a=!1,l=n.child;l;){if(l===s){a=!0,s=n,r=o;break}if(l===r){a=!0,r=n,s=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===s){a=!0,s=o,r=n;break}if(l===r){a=!0,r=o,s=n;break}l=l.sibling}if(!a)throw Error(X(189))}}if(s.alternate!==r)throw Error(X(190))}if(s.tag!==3)throw Error(X(188));return s.stateNode.current===s?t:e}function V1(t){return t=fm(t),t!==null?I1(t):null}function I1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=I1(t);if(e!==null)return e;t=t.sibling}return null}var C1=ms.unstable_scheduleCallback,Hc=ms.unstable_cancelCallback,pm=ms.unstable_shouldYield,dm=ms.unstable_requestPaint,ti=ms.unstable_now,mm=ms.unstable_getCurrentPriorityLevel,Fu=ms.unstable_ImmediatePriority,T1=ms.unstable_UserBlockingPriority,Ta=ms.unstable_NormalPriority,vm=ms.unstable_LowPriority,b1=ms.unstable_IdlePriority,ll=null,or=null;function ym(t){if(or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(ll,t,void 0,(t.current.flags&128)===128)}catch{}}var Os=Math.clz32?Math.clz32:wm,xm=Math.log,gm=Math.LN2;function wm(t){return t>>>=0,t===0?32:31-(xm(t)/gm|0)|0}var Yo=64,Xo=4194304;function oo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ba(t,e){var s=t.pendingLanes;if(s===0)return 0;var r=0,n=t.suspendedLanes,o=t.pingedLanes,a=s&268435455;if(a!==0){var l=a&~n;l!==0?r=oo(l):(o&=a,o!==0&&(r=oo(o)))}else a=s&~n,a!==0?r=oo(a):o!==0&&(r=oo(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&n)&&(n=r&-r,o=e&-e,n>=o||n===16&&(o&4194240)!==0))return e;if(r&4&&(r|=s&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)s=31-Os(e),n=1<<s,r|=t[s],e&=~n;return r}function zm(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nm(t,e){for(var s=t.suspendedLanes,r=t.pingedLanes,n=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-Os(o),l=1<<a,h=n[a];h===-1?(!(l&s)||l&r)&&(n[a]=zm(l,e)):h<=e&&(t.expiredLanes|=l),o&=~l}}function kh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function E1(){var t=Yo;return Yo<<=1,!(Yo&4194240)&&(Yo=64),t}function El(t){for(var e=[],s=0;31>s;s++)e.push(t);return e}function Oo(t,e,s){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Os(e),t[e]=s}function Sm(t,e){var s=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<s;){var n=31-Os(s),o=1<<n;e[n]=0,r[n]=-1,t[n]=-1,s&=~o}}function Ru(t,e){var s=t.entangledLanes|=e;for(t=t.entanglements;s;){var r=31-Os(s),n=1<<r;n&e|t[r]&e&&(t[r]|=e),s&=~n}}var xe=0;function D1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var A1,Ou,F1,R1,O1,Mh=!1,Ko=[],Ir=null,Cr=null,Tr=null,So=new Map,ko=new Map,Pr=[],km="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wc(t,e){switch(t){case"focusin":case"focusout":Ir=null;break;case"dragenter":case"dragleave":Cr=null;break;case"mouseover":case"mouseout":Tr=null;break;case"pointerover":case"pointerout":So.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ko.delete(e.pointerId)}}function Xn(t,e,s,r,n,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:s,eventSystemFlags:r,nativeEvent:o,targetContainers:[n]},e!==null&&(e=Bo(e),e!==null&&Ou(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),t)}function Mm(t,e,s,r,n){switch(e){case"focusin":return Ir=Xn(Ir,t,e,s,r,n),!0;case"dragenter":return Cr=Xn(Cr,t,e,s,r,n),!0;case"mouseover":return Tr=Xn(Tr,t,e,s,r,n),!0;case"pointerover":var o=n.pointerId;return So.set(o,Xn(So.get(o)||null,t,e,s,r,n)),!0;case"gotpointercapture":return o=n.pointerId,ko.set(o,Xn(ko.get(o)||null,t,e,s,r,n)),!0}return!1}function U1(t){var e=Qr(t.target);if(e!==null){var s=on(e);if(s!==null){if(e=s.tag,e===13){if(e=L1(s),e!==null){t.blockedOn=e,O1(t.priority,function(){F1(s)});return}}else if(e===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ya(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var s=Ph(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var r=new s.constructor(s.type,s);wh=r,s.target.dispatchEvent(r),wh=null}else return e=Bo(s),e!==null&&Ou(e),t.blockedOn=s,!1;e.shift()}return!0}function qc(t,e,s){ya(t)&&s.delete(e)}function Pm(){Mh=!1,Ir!==null&&ya(Ir)&&(Ir=null),Cr!==null&&ya(Cr)&&(Cr=null),Tr!==null&&ya(Tr)&&(Tr=null),So.forEach(qc),ko.forEach(qc)}function Kn(t,e){t.blockedOn===e&&(t.blockedOn=null,Mh||(Mh=!0,ms.unstable_scheduleCallback(ms.unstable_NormalPriority,Pm)))}function Mo(t){function e(n){return Kn(n,t)}if(0<Ko.length){Kn(Ko[0],t);for(var s=1;s<Ko.length;s++){var r=Ko[s];r.blockedOn===t&&(r.blockedOn=null)}}for(Ir!==null&&Kn(Ir,t),Cr!==null&&Kn(Cr,t),Tr!==null&&Kn(Tr,t),So.forEach(e),ko.forEach(e),s=0;s<Pr.length;s++)r=Pr[s],r.blockedOn===t&&(r.blockedOn=null);for(;0<Pr.length&&(s=Pr[0],s.blockedOn===null);)U1(s),s.blockedOn===null&&Pr.shift()}var In=wr.ReactCurrentBatchConfig,Ea=!0;function _m(t,e,s,r){var n=xe,o=In.transition;In.transition=null;try{xe=1,Uu(t,e,s,r)}finally{xe=n,In.transition=o}}function Lm(t,e,s,r){var n=xe,o=In.transition;In.transition=null;try{xe=4,Uu(t,e,s,r)}finally{xe=n,In.transition=o}}function Uu(t,e,s,r){if(Ea){var n=Ph(t,e,s,r);if(n===null)Gl(t,e,r,Da,s),Wc(t,r);else if(Mm(n,t,e,s,r))r.stopPropagation();else if(Wc(t,r),e&4&&-1<km.indexOf(t)){for(;n!==null;){var o=Bo(n);if(o!==null&&A1(o),o=Ph(t,e,s,r),o===null&&Gl(t,e,r,Da,s),o===n)break;n=o}n!==null&&r.stopPropagation()}else Gl(t,e,r,null,s)}}var Da=null;function Ph(t,e,s,r){if(Da=null,t=Au(r),t=Qr(t),t!==null)if(e=on(t),e===null)t=null;else if(s=e.tag,s===13){if(t=L1(e),t!==null)return t;t=null}else if(s===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Da=t,null}function B1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mm()){case Fu:return 1;case T1:return 4;case Ta:case vm:return 16;case b1:return 536870912;default:return 16}default:return 16}}var Lr=null,Bu=null,xa=null;function j1(){if(xa)return xa;var t,e=Bu,s=e.length,r,n="value"in Lr?Lr.value:Lr.textContent,o=n.length;for(t=0;t<s&&e[t]===n[t];t++);var a=s-t;for(r=1;r<=a&&e[s-r]===n[o-r];r++);return xa=n.slice(t,1<r?1-r:void 0)}function ga(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Zo(){return!0}function Qc(){return!1}function ys(t){function e(s,r,n,o,a){this._reactName=s,this._targetInst=n,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(s=t[l],this[l]=s?s(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Zo:Qc,this.isPropagationStopped=Qc,this}return Xe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Zo)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Zo)},persist:function(){},isPersistent:Zo}),e}var $n={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ju=ys($n),Uo=Xe({},$n,{view:0,detail:0}),Vm=ys(Uo),Dl,Al,Zn,hl=Xe({},Uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$u,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Zn&&(Zn&&t.type==="mousemove"?(Dl=t.screenX-Zn.screenX,Al=t.screenY-Zn.screenY):Al=Dl=0,Zn=t),Dl)},movementY:function(t){return"movementY"in t?t.movementY:Al}}),Yc=ys(hl),Im=Xe({},hl,{dataTransfer:0}),Cm=ys(Im),Tm=Xe({},Uo,{relatedTarget:0}),Fl=ys(Tm),bm=Xe({},$n,{animationName:0,elapsedTime:0,pseudoElement:0}),Em=ys(bm),Dm=Xe({},$n,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Am=ys(Dm),Fm=Xe({},$n,{data:0}),Xc=ys(Fm),Rm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Om={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Um={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bm(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Um[t])?!!e[t]:!1}function $u(){return Bm}var jm=Xe({},Uo,{key:function(t){if(t.key){var e=Rm[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ga(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Om[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$u,charCode:function(t){return t.type==="keypress"?ga(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ga(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$m=ys(jm),Gm=Xe({},hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kc=ys(Gm),Hm=Xe({},Uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$u}),Wm=ys(Hm),qm=Xe({},$n,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qm=ys(qm),Ym=Xe({},hl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Xm=ys(Ym),Km=[9,13,27,32],Gu=vr&&"CompositionEvent"in window,fo=null;vr&&"documentMode"in document&&(fo=document.documentMode);var Zm=vr&&"TextEvent"in window&&!fo,$1=vr&&(!Gu||fo&&8<fo&&11>=fo),Zc=String.fromCharCode(32),Jc=!1;function G1(t,e){switch(t){case"keyup":return Km.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function H1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vn=!1;function Jm(t,e){switch(t){case"compositionend":return H1(e);case"keypress":return e.which!==32?null:(Jc=!0,Zc);case"textInput":return t=e.data,t===Zc&&Jc?null:t;default:return null}}function t0(t,e){if(vn)return t==="compositionend"||!Gu&&G1(t,e)?(t=j1(),xa=Bu=Lr=null,vn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $1&&e.locale!=="ko"?null:e.data;default:return null}}var e0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!e0[t.type]:e==="textarea"}function W1(t,e,s,r){S1(r),e=Aa(e,"onChange"),0<e.length&&(s=new ju("onChange","change",null,s,r),t.push({event:s,listeners:e}))}var po=null,Po=null;function i0(t){sp(t,0)}function ul(t){var e=gn(t);if(v1(e))return t}function s0(t,e){if(t==="change")return e}var q1=!1;if(vr){var Rl;if(vr){var Ol="oninput"in document;if(!Ol){var ef=document.createElement("div");ef.setAttribute("oninput","return;"),Ol=typeof ef.oninput=="function"}Rl=Ol}else Rl=!1;q1=Rl&&(!document.documentMode||9<document.documentMode)}function sf(){po&&(po.detachEvent("onpropertychange",Q1),Po=po=null)}function Q1(t){if(t.propertyName==="value"&&ul(Po)){var e=[];W1(e,Po,t,Au(t)),_1(i0,e)}}function r0(t,e,s){t==="focusin"?(sf(),po=e,Po=s,po.attachEvent("onpropertychange",Q1)):t==="focusout"&&sf()}function n0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ul(Po)}function o0(t,e){if(t==="click")return ul(e)}function a0(t,e){if(t==="input"||t==="change")return ul(e)}function l0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Bs=typeof Object.is=="function"?Object.is:l0;function _o(t,e){if(Bs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var s=Object.keys(t),r=Object.keys(e);if(s.length!==r.length)return!1;for(r=0;r<s.length;r++){var n=s[r];if(!lh.call(e,n)||!Bs(t[n],e[n]))return!1}return!0}function rf(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function nf(t,e){var s=rf(t);t=0;for(var r;s;){if(s.nodeType===3){if(r=t+s.textContent.length,t<=e&&r>=e)return{node:s,offset:e-t};t=r}t:{for(;s;){if(s.nextSibling){s=s.nextSibling;break t}s=s.parentNode}s=void 0}s=rf(s)}}function Y1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Y1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function X1(){for(var t=window,e=Va();e instanceof t.HTMLIFrameElement;){try{var s=typeof e.contentWindow.location.href=="string"}catch{s=!1}if(s)t=e.contentWindow;else break;e=Va(t.document)}return e}function Hu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function h0(t){var e=X1(),s=t.focusedElem,r=t.selectionRange;if(e!==s&&s&&s.ownerDocument&&Y1(s.ownerDocument.documentElement,s)){if(r!==null&&Hu(s)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in s)s.selectionStart=e,s.selectionEnd=Math.min(t,s.value.length);else if(t=(e=s.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var n=s.textContent.length,o=Math.min(r.start,n);r=r.end===void 0?o:Math.min(r.end,n),!t.extend&&o>r&&(n=r,r=o,o=n),n=nf(s,o);var a=nf(s,r);n&&a&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=s;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<e.length;s++)t=e[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var u0=vr&&"documentMode"in document&&11>=document.documentMode,yn=null,_h=null,mo=null,Lh=!1;function of(t,e,s){var r=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Lh||yn==null||yn!==Va(r)||(r=yn,"selectionStart"in r&&Hu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),mo&&_o(mo,r)||(mo=r,r=Aa(_h,"onSelect"),0<r.length&&(e=new ju("onSelect","select",null,e,s),t.push({event:e,listeners:r}),e.target=yn)))}function Jo(t,e){var s={};return s[t.toLowerCase()]=e.toLowerCase(),s["Webkit"+t]="webkit"+e,s["Moz"+t]="moz"+e,s}var xn={animationend:Jo("Animation","AnimationEnd"),animationiteration:Jo("Animation","AnimationIteration"),animationstart:Jo("Animation","AnimationStart"),transitionend:Jo("Transition","TransitionEnd")},Ul={},K1={};vr&&(K1=document.createElement("div").style,"AnimationEvent"in window||(delete xn.animationend.animation,delete xn.animationiteration.animation,delete xn.animationstart.animation),"TransitionEvent"in window||delete xn.transitionend.transition);function cl(t){if(Ul[t])return Ul[t];if(!xn[t])return t;var e=xn[t],s;for(s in e)if(e.hasOwnProperty(s)&&s in K1)return Ul[t]=e[s];return t}var Z1=cl("animationend"),J1=cl("animationiteration"),tp=cl("animationstart"),ep=cl("transitionend"),ip=new Map,af="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Br(t,e){ip.set(t,e),nn(e,[t])}for(var Bl=0;Bl<af.length;Bl++){var jl=af[Bl],c0=jl.toLowerCase(),f0=jl[0].toUpperCase()+jl.slice(1);Br(c0,"on"+f0)}Br(Z1,"onAnimationEnd");Br(J1,"onAnimationIteration");Br(tp,"onAnimationStart");Br("dblclick","onDoubleClick");Br("focusin","onFocus");Br("focusout","onBlur");Br(ep,"onTransitionEnd");Dn("onMouseEnter",["mouseout","mouseover"]);Dn("onMouseLeave",["mouseout","mouseover"]);Dn("onPointerEnter",["pointerout","pointerover"]);Dn("onPointerLeave",["pointerout","pointerover"]);nn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));nn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));nn("onBeforeInput",["compositionend","keypress","textInput","paste"]);nn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));nn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));nn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p0=new Set("cancel close invalid load scroll toggle".split(" ").concat(ao));function lf(t,e,s){var r=t.type||"unknown-event";t.currentTarget=s,cm(r,e,void 0,t),t.currentTarget=null}function sp(t,e){e=(e&4)!==0;for(var s=0;s<t.length;s++){var r=t[s],n=r.event;r=r.listeners;t:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],h=l.instance,u=l.currentTarget;if(l=l.listener,h!==o&&n.isPropagationStopped())break t;lf(n,l,u),o=h}else for(a=0;a<r.length;a++){if(l=r[a],h=l.instance,u=l.currentTarget,l=l.listener,h!==o&&n.isPropagationStopped())break t;lf(n,l,u),o=h}}}if(Ca)throw t=Sh,Ca=!1,Sh=null,t}function Fe(t,e){var s=e[bh];s===void 0&&(s=e[bh]=new Set);var r=t+"__bubble";s.has(r)||(rp(e,t,2,!1),s.add(r))}function $l(t,e,s){var r=0;e&&(r|=4),rp(s,t,r,e)}var ta="_reactListening"+Math.random().toString(36).slice(2);function Lo(t){if(!t[ta]){t[ta]=!0,c1.forEach(function(s){s!=="selectionchange"&&(p0.has(s)||$l(s,!1,t),$l(s,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ta]||(e[ta]=!0,$l("selectionchange",!1,e))}}function rp(t,e,s,r){switch(B1(e)){case 1:var n=_m;break;case 4:n=Lm;break;default:n=Uu}s=n.bind(null,e,s,t),n=void 0,!Nh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),r?n!==void 0?t.addEventListener(e,s,{capture:!0,passive:n}):t.addEventListener(e,s,!0):n!==void 0?t.addEventListener(e,s,{passive:n}):t.addEventListener(e,s,!1)}function Gl(t,e,s,r,n){var o=r;if(!(e&1)&&!(e&2)&&r!==null)t:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(a===4)for(a=r.return;a!==null;){var h=a.tag;if((h===3||h===4)&&(h=a.stateNode.containerInfo,h===n||h.nodeType===8&&h.parentNode===n))return;a=a.return}for(;l!==null;){if(a=Qr(l),a===null)return;if(h=a.tag,h===5||h===6){r=o=a;continue t}l=l.parentNode}}r=r.return}_1(function(){var u=o,c=Au(s),f=[];t:{var p=ip.get(t);if(p!==void 0){var g=ju,y=t;switch(t){case"keypress":if(ga(s)===0)break t;case"keydown":case"keyup":g=$m;break;case"focusin":y="focus",g=Fl;break;case"focusout":y="blur",g=Fl;break;case"beforeblur":case"afterblur":g=Fl;break;case"click":if(s.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Yc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Cm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Wm;break;case Z1:case J1:case tp:g=Em;break;case ep:g=Qm;break;case"scroll":g=Vm;break;case"wheel":g=Xm;break;case"copy":case"cut":case"paste":g=Am;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Kc}var v=(e&4)!==0,z=!v&&t==="scroll",x=v?p!==null?p+"Capture":null:p;v=[];for(var m=u,d;m!==null;){d=m;var w=d.stateNode;if(d.tag===5&&w!==null&&(d=w,x!==null&&(w=No(m,x),w!=null&&v.push(Vo(m,w,d)))),z)break;m=m.return}0<v.length&&(p=new g(p,y,null,s,c),f.push({event:p,listeners:v}))}}if(!(e&7)){t:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&s!==wh&&(y=s.relatedTarget||s.fromElement)&&(Qr(y)||y[yr]))break t;if((g||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,g?(y=s.relatedTarget||s.toElement,g=u,y=y?Qr(y):null,y!==null&&(z=on(y),y!==z||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=u),g!==y)){if(v=Yc,w="onMouseLeave",x="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(v=Kc,w="onPointerLeave",x="onPointerEnter",m="pointer"),z=g==null?p:gn(g),d=y==null?p:gn(y),p=new v(w,m+"leave",g,s,c),p.target=z,p.relatedTarget=d,w=null,Qr(c)===u&&(v=new v(x,m+"enter",y,s,c),v.target=d,v.relatedTarget=z,w=v),z=w,g&&y)e:{for(v=g,x=y,m=0,d=v;d;d=hn(d))m++;for(d=0,w=x;w;w=hn(w))d++;for(;0<m-d;)v=hn(v),m--;for(;0<d-m;)x=hn(x),d--;for(;m--;){if(v===x||x!==null&&v===x.alternate)break e;v=hn(v),x=hn(x)}v=null}else v=null;g!==null&&hf(f,p,g,v,!1),y!==null&&z!==null&&hf(f,z,y,v,!0)}}t:{if(p=u?gn(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var N=s0;else if(tf(p))if(q1)N=a0;else{N=n0;var S=r0}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=o0);if(N&&(N=N(t,u))){W1(f,N,s,c);break t}S&&S(t,p,u),t==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&mh(p,"number",p.value)}switch(S=u?gn(u):window,t){case"focusin":(tf(S)||S.contentEditable==="true")&&(yn=S,_h=u,mo=null);break;case"focusout":mo=_h=yn=null;break;case"mousedown":Lh=!0;break;case"contextmenu":case"mouseup":case"dragend":Lh=!1,of(f,s,c);break;case"selectionchange":if(u0)break;case"keydown":case"keyup":of(f,s,c)}var k;if(Gu)t:{switch(t){case"compositionstart":var O="onCompositionStart";break t;case"compositionend":O="onCompositionEnd";break t;case"compositionupdate":O="onCompositionUpdate";break t}O=void 0}else vn?G1(t,s)&&(O="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(O="onCompositionStart");O&&($1&&s.locale!=="ko"&&(vn||O!=="onCompositionStart"?O==="onCompositionEnd"&&vn&&(k=j1()):(Lr=c,Bu="value"in Lr?Lr.value:Lr.textContent,vn=!0)),S=Aa(u,O),0<S.length&&(O=new Xc(O,t,null,s,c),f.push({event:O,listeners:S}),k?O.data=k:(k=H1(s),k!==null&&(O.data=k)))),(k=Zm?Jm(t,s):t0(t,s))&&(u=Aa(u,"onBeforeInput"),0<u.length&&(c=new Xc("onBeforeInput","beforeinput",null,s,c),f.push({event:c,listeners:u}),c.data=k))}sp(f,e)})}function Vo(t,e,s){return{instance:t,listener:e,currentTarget:s}}function Aa(t,e){for(var s=e+"Capture",r=[];t!==null;){var n=t,o=n.stateNode;n.tag===5&&o!==null&&(n=o,o=No(t,s),o!=null&&r.unshift(Vo(t,o,n)),o=No(t,e),o!=null&&r.push(Vo(t,o,n))),t=t.return}return r}function hn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function hf(t,e,s,r,n){for(var o=e._reactName,a=[];s!==null&&s!==r;){var l=s,h=l.alternate,u=l.stateNode;if(h!==null&&h===r)break;l.tag===5&&u!==null&&(l=u,n?(h=No(s,o),h!=null&&a.unshift(Vo(s,h,l))):n||(h=No(s,o),h!=null&&a.push(Vo(s,h,l)))),s=s.return}a.length!==0&&t.push({event:e,listeners:a})}var d0=/\r\n?/g,m0=/\u0000|\uFFFD/g;function uf(t){return(typeof t=="string"?t:""+t).replace(d0,`
`).replace(m0,"")}function ea(t,e,s){if(e=uf(e),uf(t)!==e&&s)throw Error(X(425))}function Fa(){}var Vh=null,Ih=null;function Ch(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Th=typeof setTimeout=="function"?setTimeout:void 0,v0=typeof clearTimeout=="function"?clearTimeout:void 0,cf=typeof Promise=="function"?Promise:void 0,y0=typeof queueMicrotask=="function"?queueMicrotask:typeof cf<"u"?function(t){return cf.resolve(null).then(t).catch(x0)}:Th;function x0(t){setTimeout(function(){throw t})}function Hl(t,e){var s=e,r=0;do{var n=s.nextSibling;if(t.removeChild(s),n&&n.nodeType===8)if(s=n.data,s==="/$"){if(r===0){t.removeChild(n),Mo(e);return}r--}else s!=="$"&&s!=="$?"&&s!=="$!"||r++;s=n}while(s);Mo(e)}function br(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ff(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(e===0)return t;e--}else s==="/$"&&e++}t=t.previousSibling}return null}var Gn=Math.random().toString(36).slice(2),nr="__reactFiber$"+Gn,Io="__reactProps$"+Gn,yr="__reactContainer$"+Gn,bh="__reactEvents$"+Gn,g0="__reactListeners$"+Gn,w0="__reactHandles$"+Gn;function Qr(t){var e=t[nr];if(e)return e;for(var s=t.parentNode;s;){if(e=s[yr]||s[nr]){if(s=e.alternate,e.child!==null||s!==null&&s.child!==null)for(t=ff(t);t!==null;){if(s=t[nr])return s;t=ff(t)}return e}t=s,s=t.parentNode}return null}function Bo(t){return t=t[nr]||t[yr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function gn(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(X(33))}function fl(t){return t[Io]||null}var Eh=[],wn=-1;function jr(t){return{current:t}}function Re(t){0>wn||(t.current=Eh[wn],Eh[wn]=null,wn--)}function _e(t,e){wn++,Eh[wn]=t.current,t.current=e}var Or={},Ii=jr(Or),ls=jr(!1),Jr=Or;function An(t,e){var s=t.type.contextTypes;if(!s)return Or;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var n={},o;for(o in s)n[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=n),n}function hs(t){return t=t.childContextTypes,t!=null}function Ra(){Re(ls),Re(Ii)}function pf(t,e,s){if(Ii.current!==Or)throw Error(X(168));_e(Ii,e),_e(ls,s)}function np(t,e,s){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return s;r=r.getChildContext();for(var n in r)if(!(n in e))throw Error(X(108,rm(t)||"Unknown",n));return Xe({},s,r)}function Oa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Or,Jr=Ii.current,_e(Ii,t),_e(ls,ls.current),!0}function df(t,e,s){var r=t.stateNode;if(!r)throw Error(X(169));s?(t=np(t,e,Jr),r.__reactInternalMemoizedMergedChildContext=t,Re(ls),Re(Ii),_e(Ii,t)):Re(ls),_e(ls,s)}var cr=null,pl=!1,Wl=!1;function op(t){cr===null?cr=[t]:cr.push(t)}function z0(t){pl=!0,op(t)}function $r(){if(!Wl&&cr!==null){Wl=!0;var t=0,e=xe;try{var s=cr;for(xe=1;t<s.length;t++){var r=s[t];do r=r(!0);while(r!==null)}cr=null,pl=!1}catch(n){throw cr!==null&&(cr=cr.slice(t+1)),C1(Fu,$r),n}finally{xe=e,Wl=!1}}return null}var zn=[],Nn=0,Ua=null,Ba=0,Ss=[],ks=0,tn=null,pr=1,dr="";function Gr(t,e){zn[Nn++]=Ba,zn[Nn++]=Ua,Ua=t,Ba=e}function ap(t,e,s){Ss[ks++]=pr,Ss[ks++]=dr,Ss[ks++]=tn,tn=t;var r=pr;t=dr;var n=32-Os(r)-1;r&=~(1<<n),s+=1;var o=32-Os(e)+n;if(30<o){var a=n-n%5;o=(r&(1<<a)-1).toString(32),r>>=a,n-=a,pr=1<<32-Os(e)+n|s<<n|r,dr=o+t}else pr=1<<o|s<<n|r,dr=t}function Wu(t){t.return!==null&&(Gr(t,1),ap(t,1,0))}function qu(t){for(;t===Ua;)Ua=zn[--Nn],zn[Nn]=null,Ba=zn[--Nn],zn[Nn]=null;for(;t===tn;)tn=Ss[--ks],Ss[ks]=null,dr=Ss[--ks],Ss[ks]=null,pr=Ss[--ks],Ss[ks]=null}var ds=null,ps=null,Ge=!1,Rs=null;function lp(t,e){var s=Ms(5,null,null,0);s.elementType="DELETED",s.stateNode=e,s.return=t,e=t.deletions,e===null?(t.deletions=[s],t.flags|=16):e.push(s)}function mf(t,e){switch(t.tag){case 5:var s=t.type;return e=e.nodeType!==1||s.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ds=t,ps=br(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ds=t,ps=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(s=tn!==null?{id:pr,overflow:dr}:null,t.memoizedState={dehydrated:e,treeContext:s,retryLane:1073741824},s=Ms(18,null,null,0),s.stateNode=e,s.return=t,t.child=s,ds=t,ps=null,!0):!1;default:return!1}}function Dh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ah(t){if(Ge){var e=ps;if(e){var s=e;if(!mf(t,e)){if(Dh(t))throw Error(X(418));e=br(s.nextSibling);var r=ds;e&&mf(t,e)?lp(r,s):(t.flags=t.flags&-4097|2,Ge=!1,ds=t)}}else{if(Dh(t))throw Error(X(418));t.flags=t.flags&-4097|2,Ge=!1,ds=t}}}function vf(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ds=t}function ia(t){if(t!==ds)return!1;if(!Ge)return vf(t),Ge=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ch(t.type,t.memoizedProps)),e&&(e=ps)){if(Dh(t))throw hp(),Error(X(418));for(;e;)lp(t,e),e=br(e.nextSibling)}if(vf(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(X(317));t:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(e===0){ps=br(t.nextSibling);break t}e--}else s!=="$"&&s!=="$!"&&s!=="$?"||e++}t=t.nextSibling}ps=null}}else ps=ds?br(t.stateNode.nextSibling):null;return!0}function hp(){for(var t=ps;t;)t=br(t.nextSibling)}function Fn(){ps=ds=null,Ge=!1}function Qu(t){Rs===null?Rs=[t]:Rs.push(t)}var N0=wr.ReactCurrentBatchConfig;function As(t,e){if(t&&t.defaultProps){e=Xe({},e),t=t.defaultProps;for(var s in t)e[s]===void 0&&(e[s]=t[s]);return e}return e}var ja=jr(null),$a=null,Sn=null,Yu=null;function Xu(){Yu=Sn=$a=null}function Ku(t){var e=ja.current;Re(ja),t._currentValue=e}function Fh(t,e,s){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===s)break;t=t.return}}function Cn(t,e){$a=t,Yu=Sn=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(as=!0),t.firstContext=null)}function Ls(t){var e=t._currentValue;if(Yu!==t)if(t={context:t,memoizedValue:e,next:null},Sn===null){if($a===null)throw Error(X(308));Sn=t,$a.dependencies={lanes:0,firstContext:t}}else Sn=Sn.next=t;return e}var Yr=null;function Zu(t){Yr===null?Yr=[t]:Yr.push(t)}function up(t,e,s,r){var n=e.interleaved;return n===null?(s.next=s,Zu(e)):(s.next=n.next,n.next=s),e.interleaved=s,xr(t,r)}function xr(t,e){t.lanes|=e;var s=t.alternate;for(s!==null&&(s.lanes|=e),s=t,t=t.return;t!==null;)t.childLanes|=e,s=t.alternate,s!==null&&(s.childLanes|=e),s=t,t=t.return;return s.tag===3?s.stateNode:null}var Mr=!1;function Ju(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cp(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function mr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Er(t,e,s){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,se&2){var n=r.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e,xr(t,s)}return n=r.interleaved,n===null?(e.next=e,Zu(r)):(e.next=n.next,n.next=e),r.interleaved=e,xr(t,s)}function wa(t,e,s){if(e=e.updateQueue,e!==null&&(e=e.shared,(s&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,s|=r,e.lanes=s,Ru(t,s)}}function yf(t,e){var s=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,s===r)){var n=null,o=null;if(s=s.firstBaseUpdate,s!==null){do{var a={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};o===null?n=o=a:o=o.next=a,s=s.next}while(s!==null);o===null?n=o=e:o=o.next=e}else n=o=e;s={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=e:t.next=e,s.lastBaseUpdate=e}function Ga(t,e,s,r){var n=t.updateQueue;Mr=!1;var o=n.firstBaseUpdate,a=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var h=l,u=h.next;h.next=null,a===null?o=u:a.next=u,a=h;var c=t.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==a&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=h))}if(o!==null){var f=n.baseState;a=0,c=u=h=null,l=o;do{var p=l.lane,g=l.eventTime;if((r&p)===p){c!==null&&(c=c.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});t:{var y=t,v=l;switch(p=e,g=s,v.tag){case 1:if(y=v.payload,typeof y=="function"){f=y.call(g,f,p);break t}f=y;break t;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,p=typeof y=="function"?y.call(g,f,p):y,p==null)break t;f=Xe({},f,p);break t;case 2:Mr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=n.effects,p===null?n.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=g,h=f):c=c.next=g,a|=p;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;p=l,l=p.next,p.next=null,n.lastBaseUpdate=p,n.shared.pending=null}}while(1);if(c===null&&(h=f),n.baseState=h,n.firstBaseUpdate=u,n.lastBaseUpdate=c,e=n.shared.interleaved,e!==null){n=e;do a|=n.lane,n=n.next;while(n!==e)}else o===null&&(n.shared.lanes=0);sn|=a,t.lanes=a,t.memoizedState=f}}function xf(t,e,s){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],n=r.callback;if(n!==null){if(r.callback=null,r=s,typeof n!="function")throw Error(X(191,n));n.call(r)}}}var fp=new u1.Component().refs;function Rh(t,e,s,r){e=t.memoizedState,s=s(r,e),s=s==null?e:Xe({},e,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var dl={isMounted:function(t){return(t=t._reactInternals)?on(t)===t:!1},enqueueSetState:function(t,e,s){t=t._reactInternals;var r=Qi(),n=Ar(t),o=mr(r,n);o.payload=e,s!=null&&(o.callback=s),e=Er(t,o,n),e!==null&&(Us(e,t,n,r),wa(e,t,n))},enqueueReplaceState:function(t,e,s){t=t._reactInternals;var r=Qi(),n=Ar(t),o=mr(r,n);o.tag=1,o.payload=e,s!=null&&(o.callback=s),e=Er(t,o,n),e!==null&&(Us(e,t,n,r),wa(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var s=Qi(),r=Ar(t),n=mr(s,r);n.tag=2,e!=null&&(n.callback=e),e=Er(t,n,r),e!==null&&(Us(e,t,r,s),wa(e,t,r))}};function gf(t,e,s,r,n,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!_o(s,r)||!_o(n,o):!0}function pp(t,e,s){var r=!1,n=Or,o=e.contextType;return typeof o=="object"&&o!==null?o=Ls(o):(n=hs(e)?Jr:Ii.current,r=e.contextTypes,o=(r=r!=null)?An(t,n):Or),e=new e(s,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=dl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=o),e}function wf(t,e,s,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(s,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(s,r),e.state!==t&&dl.enqueueReplaceState(e,e.state,null)}function Oh(t,e,s,r){var n=t.stateNode;n.props=s,n.state=t.memoizedState,n.refs=fp,Ju(t);var o=e.contextType;typeof o=="object"&&o!==null?n.context=Ls(o):(o=hs(e)?Jr:Ii.current,n.context=An(t,o)),n.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Rh(t,e,o,s),n.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&dl.enqueueReplaceState(n,n.state,null),Ga(t,s,n,r),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function Jn(t,e,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(X(309));var r=s.stateNode}if(!r)throw Error(X(147,t));var n=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var l=n.refs;l===fp&&(l=n.refs={}),a===null?delete l[o]:l[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(X(284));if(!s._owner)throw Error(X(290,t))}return t}function sa(t,e){throw t=Object.prototype.toString.call(e),Error(X(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function zf(t){var e=t._init;return e(t._payload)}function dp(t){function e(x,m){if(t){var d=x.deletions;d===null?(x.deletions=[m],x.flags|=16):d.push(m)}}function s(x,m){if(!t)return null;for(;m!==null;)e(x,m),m=m.sibling;return null}function r(x,m){for(x=new Map;m!==null;)m.key!==null?x.set(m.key,m):x.set(m.index,m),m=m.sibling;return x}function n(x,m){return x=Fr(x,m),x.index=0,x.sibling=null,x}function o(x,m,d){return x.index=d,t?(d=x.alternate,d!==null?(d=d.index,d<m?(x.flags|=2,m):d):(x.flags|=2,m)):(x.flags|=1048576,m)}function a(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,m,d,w){return m===null||m.tag!==6?(m=Jl(d,x.mode,w),m.return=x,m):(m=n(m,d),m.return=x,m)}function h(x,m,d,w){var N=d.type;return N===mn?c(x,m,d.props.children,w,d.key):m!==null&&(m.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===kr&&zf(N)===m.type)?(w=n(m,d.props),w.ref=Jn(x,m,d),w.return=x,w):(w=Pa(d.type,d.key,d.props,null,x.mode,w),w.ref=Jn(x,m,d),w.return=x,w)}function u(x,m,d,w){return m===null||m.tag!==4||m.stateNode.containerInfo!==d.containerInfo||m.stateNode.implementation!==d.implementation?(m=th(d,x.mode,w),m.return=x,m):(m=n(m,d.children||[]),m.return=x,m)}function c(x,m,d,w,N){return m===null||m.tag!==7?(m=Zr(d,x.mode,w,N),m.return=x,m):(m=n(m,d),m.return=x,m)}function f(x,m,d){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Jl(""+m,x.mode,d),m.return=x,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Wo:return d=Pa(m.type,m.key,m.props,null,x.mode,d),d.ref=Jn(x,null,m),d.return=x,d;case dn:return m=th(m,x.mode,d),m.return=x,m;case kr:var w=m._init;return f(x,w(m._payload),d)}if(no(m)||Qn(m))return m=Zr(m,x.mode,d,null),m.return=x,m;sa(x,m)}return null}function p(x,m,d,w){var N=m!==null?m.key:null;if(typeof d=="string"&&d!==""||typeof d=="number")return N!==null?null:l(x,m,""+d,w);if(typeof d=="object"&&d!==null){switch(d.$$typeof){case Wo:return d.key===N?h(x,m,d,w):null;case dn:return d.key===N?u(x,m,d,w):null;case kr:return N=d._init,p(x,m,N(d._payload),w)}if(no(d)||Qn(d))return N!==null?null:c(x,m,d,w,null);sa(x,d)}return null}function g(x,m,d,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(d)||null,l(m,x,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Wo:return x=x.get(w.key===null?d:w.key)||null,h(m,x,w,N);case dn:return x=x.get(w.key===null?d:w.key)||null,u(m,x,w,N);case kr:var S=w._init;return g(x,m,d,S(w._payload),N)}if(no(w)||Qn(w))return x=x.get(d)||null,c(m,x,w,N,null);sa(m,w)}return null}function y(x,m,d,w){for(var N=null,S=null,k=m,O=m=0,E=null;k!==null&&O<d.length;O++){k.index>O?(E=k,k=null):E=k.sibling;var M=p(x,k,d[O],w);if(M===null){k===null&&(k=E);break}t&&k&&M.alternate===null&&e(x,k),m=o(M,m,O),S===null?N=M:S.sibling=M,S=M,k=E}if(O===d.length)return s(x,k),Ge&&Gr(x,O),N;if(k===null){for(;O<d.length;O++)k=f(x,d[O],w),k!==null&&(m=o(k,m,O),S===null?N=k:S.sibling=k,S=k);return Ge&&Gr(x,O),N}for(k=r(x,k);O<d.length;O++)E=g(k,x,O,d[O],w),E!==null&&(t&&E.alternate!==null&&k.delete(E.key===null?O:E.key),m=o(E,m,O),S===null?N=E:S.sibling=E,S=E);return t&&k.forEach(function(R){return e(x,R)}),Ge&&Gr(x,O),N}function v(x,m,d,w){var N=Qn(d);if(typeof N!="function")throw Error(X(150));if(d=N.call(d),d==null)throw Error(X(151));for(var S=N=null,k=m,O=m=0,E=null,M=d.next();k!==null&&!M.done;O++,M=d.next()){k.index>O?(E=k,k=null):E=k.sibling;var R=p(x,k,M.value,w);if(R===null){k===null&&(k=E);break}t&&k&&R.alternate===null&&e(x,k),m=o(R,m,O),S===null?N=R:S.sibling=R,S=R,k=E}if(M.done)return s(x,k),Ge&&Gr(x,O),N;if(k===null){for(;!M.done;O++,M=d.next())M=f(x,M.value,w),M!==null&&(m=o(M,m,O),S===null?N=M:S.sibling=M,S=M);return Ge&&Gr(x,O),N}for(k=r(x,k);!M.done;O++,M=d.next())M=g(k,x,O,M.value,w),M!==null&&(t&&M.alternate!==null&&k.delete(M.key===null?O:M.key),m=o(M,m,O),S===null?N=M:S.sibling=M,S=M);return t&&k.forEach(function(D){return e(x,D)}),Ge&&Gr(x,O),N}function z(x,m,d,w){if(typeof d=="object"&&d!==null&&d.type===mn&&d.key===null&&(d=d.props.children),typeof d=="object"&&d!==null){switch(d.$$typeof){case Wo:t:{for(var N=d.key,S=m;S!==null;){if(S.key===N){if(N=d.type,N===mn){if(S.tag===7){s(x,S.sibling),m=n(S,d.props.children),m.return=x,x=m;break t}}else if(S.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===kr&&zf(N)===S.type){s(x,S.sibling),m=n(S,d.props),m.ref=Jn(x,S,d),m.return=x,x=m;break t}s(x,S);break}else e(x,S);S=S.sibling}d.type===mn?(m=Zr(d.props.children,x.mode,w,d.key),m.return=x,x=m):(w=Pa(d.type,d.key,d.props,null,x.mode,w),w.ref=Jn(x,m,d),w.return=x,x=w)}return a(x);case dn:t:{for(S=d.key;m!==null;){if(m.key===S)if(m.tag===4&&m.stateNode.containerInfo===d.containerInfo&&m.stateNode.implementation===d.implementation){s(x,m.sibling),m=n(m,d.children||[]),m.return=x,x=m;break t}else{s(x,m);break}else e(x,m);m=m.sibling}m=th(d,x.mode,w),m.return=x,x=m}return a(x);case kr:return S=d._init,z(x,m,S(d._payload),w)}if(no(d))return y(x,m,d,w);if(Qn(d))return v(x,m,d,w);sa(x,d)}return typeof d=="string"&&d!==""||typeof d=="number"?(d=""+d,m!==null&&m.tag===6?(s(x,m.sibling),m=n(m,d),m.return=x,x=m):(s(x,m),m=Jl(d,x.mode,w),m.return=x,x=m),a(x)):s(x,m)}return z}var Rn=dp(!0),mp=dp(!1),jo={},ar=jr(jo),Co=jr(jo),To=jr(jo);function Xr(t){if(t===jo)throw Error(X(174));return t}function tc(t,e){switch(_e(To,e),_e(Co,t),_e(ar,jo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:yh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=yh(e,t)}Re(ar),_e(ar,e)}function On(){Re(ar),Re(Co),Re(To)}function vp(t){Xr(To.current);var e=Xr(ar.current),s=yh(e,t.type);e!==s&&(_e(Co,t),_e(ar,s))}function ec(t){Co.current===t&&(Re(ar),Re(Co))}var Qe=jr(0);function Ha(t){for(var e=t;e!==null;){if(e.tag===13){var s=e.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ql=[];function ic(){for(var t=0;t<ql.length;t++)ql[t]._workInProgressVersionPrimary=null;ql.length=0}var za=wr.ReactCurrentDispatcher,Ql=wr.ReactCurrentBatchConfig,en=0,Ye=null,ni=null,xi=null,Wa=!1,vo=!1,bo=0,S0=0;function _i(){throw Error(X(321))}function sc(t,e){if(e===null)return!1;for(var s=0;s<e.length&&s<t.length;s++)if(!Bs(t[s],e[s]))return!1;return!0}function rc(t,e,s,r,n,o){if(en=o,Ye=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,za.current=t===null||t.memoizedState===null?_0:L0,t=s(r,n),vo){o=0;do{if(vo=!1,bo=0,25<=o)throw Error(X(301));o+=1,xi=ni=null,e.updateQueue=null,za.current=V0,t=s(r,n)}while(vo)}if(za.current=qa,e=ni!==null&&ni.next!==null,en=0,xi=ni=Ye=null,Wa=!1,e)throw Error(X(300));return t}function nc(){var t=bo!==0;return bo=0,t}function ir(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?Ye.memoizedState=xi=t:xi=xi.next=t,xi}function Vs(){if(ni===null){var t=Ye.alternate;t=t!==null?t.memoizedState:null}else t=ni.next;var e=xi===null?Ye.memoizedState:xi.next;if(e!==null)xi=e,ni=t;else{if(t===null)throw Error(X(310));ni=t,t={memoizedState:ni.memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},xi===null?Ye.memoizedState=xi=t:xi=xi.next=t}return xi}function Eo(t,e){return typeof e=="function"?e(t):e}function Yl(t){var e=Vs(),s=e.queue;if(s===null)throw Error(X(311));s.lastRenderedReducer=t;var r=ni,n=r.baseQueue,o=s.pending;if(o!==null){if(n!==null){var a=n.next;n.next=o.next,o.next=a}r.baseQueue=n=o,s.pending=null}if(n!==null){o=n.next,r=r.baseState;var l=a=null,h=null,u=o;do{var c=u.lane;if((en&c)===c)h!==null&&(h=h.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};h===null?(l=h=f,a=r):h=h.next=f,Ye.lanes|=c,sn|=c}u=u.next}while(u!==null&&u!==o);h===null?a=r:h.next=l,Bs(r,e.memoizedState)||(as=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=h,s.lastRenderedState=r}if(t=s.interleaved,t!==null){n=t;do o=n.lane,Ye.lanes|=o,sn|=o,n=n.next;while(n!==t)}else n===null&&(s.lanes=0);return[e.memoizedState,s.dispatch]}function Xl(t){var e=Vs(),s=e.queue;if(s===null)throw Error(X(311));s.lastRenderedReducer=t;var r=s.dispatch,n=s.pending,o=e.memoizedState;if(n!==null){s.pending=null;var a=n=n.next;do o=t(o,a.action),a=a.next;while(a!==n);Bs(o,e.memoizedState)||(as=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),s.lastRenderedState=o}return[o,r]}function yp(){}function xp(t,e){var s=Ye,r=Vs(),n=e(),o=!Bs(r.memoizedState,n);if(o&&(r.memoizedState=n,as=!0),r=r.queue,oc(zp.bind(null,s,r,t),[t]),r.getSnapshot!==e||o||xi!==null&&xi.memoizedState.tag&1){if(s.flags|=2048,Do(9,wp.bind(null,s,r,n,e),void 0,null),wi===null)throw Error(X(349));en&30||gp(s,e,n)}return n}function gp(t,e,s){t.flags|=16384,t={getSnapshot:e,value:s},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.stores=[t]):(s=e.stores,s===null?e.stores=[t]:s.push(t))}function wp(t,e,s,r){e.value=s,e.getSnapshot=r,Np(e)&&Sp(t)}function zp(t,e,s){return s(function(){Np(e)&&Sp(t)})}function Np(t){var e=t.getSnapshot;t=t.value;try{var s=e();return!Bs(t,s)}catch{return!0}}function Sp(t){var e=xr(t,1);e!==null&&Us(e,t,1,-1)}function Nf(t){var e=ir();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:t},e.queue=t,t=t.dispatch=P0.bind(null,Ye,t),[e.memoizedState,t]}function Do(t,e,s,r){return t={tag:t,create:e,destroy:s,deps:r,next:null},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.lastEffect=t.next=t):(s=e.lastEffect,s===null?e.lastEffect=t.next=t:(r=s.next,s.next=t,t.next=r,e.lastEffect=t)),t}function kp(){return Vs().memoizedState}function Na(t,e,s,r){var n=ir();Ye.flags|=t,n.memoizedState=Do(1|e,s,void 0,r===void 0?null:r)}function ml(t,e,s,r){var n=Vs();r=r===void 0?null:r;var o=void 0;if(ni!==null){var a=ni.memoizedState;if(o=a.destroy,r!==null&&sc(r,a.deps)){n.memoizedState=Do(e,s,o,r);return}}Ye.flags|=t,n.memoizedState=Do(1|e,s,o,r)}function Sf(t,e){return Na(8390656,8,t,e)}function oc(t,e){return ml(2048,8,t,e)}function Mp(t,e){return ml(4,2,t,e)}function Pp(t,e){return ml(4,4,t,e)}function _p(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Lp(t,e,s){return s=s!=null?s.concat([t]):null,ml(4,4,_p.bind(null,e,t),s)}function ac(){}function Vp(t,e){var s=Vs();e=e===void 0?null:e;var r=s.memoizedState;return r!==null&&e!==null&&sc(e,r[1])?r[0]:(s.memoizedState=[t,e],t)}function Ip(t,e){var s=Vs();e=e===void 0?null:e;var r=s.memoizedState;return r!==null&&e!==null&&sc(e,r[1])?r[0]:(t=t(),s.memoizedState=[t,e],t)}function Cp(t,e,s){return en&21?(Bs(s,e)||(s=E1(),Ye.lanes|=s,sn|=s,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,as=!0),t.memoizedState=s)}function k0(t,e){var s=xe;xe=s!==0&&4>s?s:4,t(!0);var r=Ql.transition;Ql.transition={};try{t(!1),e()}finally{xe=s,Ql.transition=r}}function Tp(){return Vs().memoizedState}function M0(t,e,s){var r=Ar(t);if(s={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null},bp(t))Ep(e,s);else if(s=up(t,e,s,r),s!==null){var n=Qi();Us(s,t,r,n),Dp(s,e,r)}}function P0(t,e,s){var r=Ar(t),n={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null};if(bp(t))Ep(e,n);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,l=o(a,s);if(n.hasEagerState=!0,n.eagerState=l,Bs(l,a)){var h=e.interleaved;h===null?(n.next=n,Zu(e)):(n.next=h.next,h.next=n),e.interleaved=n;return}}catch{}finally{}s=up(t,e,n,r),s!==null&&(n=Qi(),Us(s,t,r,n),Dp(s,e,r))}}function bp(t){var e=t.alternate;return t===Ye||e!==null&&e===Ye}function Ep(t,e){vo=Wa=!0;var s=t.pending;s===null?e.next=e:(e.next=s.next,s.next=e),t.pending=e}function Dp(t,e,s){if(s&4194240){var r=e.lanes;r&=t.pendingLanes,s|=r,e.lanes=s,Ru(t,s)}}var qa={readContext:Ls,useCallback:_i,useContext:_i,useEffect:_i,useImperativeHandle:_i,useInsertionEffect:_i,useLayoutEffect:_i,useMemo:_i,useReducer:_i,useRef:_i,useState:_i,useDebugValue:_i,useDeferredValue:_i,useTransition:_i,useMutableSource:_i,useSyncExternalStore:_i,useId:_i,unstable_isNewReconciler:!1},_0={readContext:Ls,useCallback:function(t,e){return ir().memoizedState=[t,e===void 0?null:e],t},useContext:Ls,useEffect:Sf,useImperativeHandle:function(t,e,s){return s=s!=null?s.concat([t]):null,Na(4194308,4,_p.bind(null,e,t),s)},useLayoutEffect:function(t,e){return Na(4194308,4,t,e)},useInsertionEffect:function(t,e){return Na(4,2,t,e)},useMemo:function(t,e){var s=ir();return e=e===void 0?null:e,t=t(),s.memoizedState=[t,e],t},useReducer:function(t,e,s){var r=ir();return e=s!==void 0?s(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=M0.bind(null,Ye,t),[r.memoizedState,t]},useRef:function(t){var e=ir();return t={current:t},e.memoizedState=t},useState:Nf,useDebugValue:ac,useDeferredValue:function(t){return ir().memoizedState=t},useTransition:function(){var t=Nf(!1),e=t[0];return t=k0.bind(null,t[1]),ir().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,s){var r=Ye,n=ir();if(Ge){if(s===void 0)throw Error(X(407));s=s()}else{if(s=e(),wi===null)throw Error(X(349));en&30||gp(r,e,s)}n.memoizedState=s;var o={value:s,getSnapshot:e};return n.queue=o,Sf(zp.bind(null,r,o,t),[t]),r.flags|=2048,Do(9,wp.bind(null,r,o,s,e),void 0,null),s},useId:function(){var t=ir(),e=wi.identifierPrefix;if(Ge){var s=dr,r=pr;s=(r&~(1<<32-Os(r)-1)).toString(32)+s,e=":"+e+"R"+s,s=bo++,0<s&&(e+="H"+s.toString(32)),e+=":"}else s=S0++,e=":"+e+"r"+s.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},L0={readContext:Ls,useCallback:Vp,useContext:Ls,useEffect:oc,useImperativeHandle:Lp,useInsertionEffect:Mp,useLayoutEffect:Pp,useMemo:Ip,useReducer:Yl,useRef:kp,useState:function(){return Yl(Eo)},useDebugValue:ac,useDeferredValue:function(t){var e=Vs();return Cp(e,ni.memoizedState,t)},useTransition:function(){var t=Yl(Eo)[0],e=Vs().memoizedState;return[t,e]},useMutableSource:yp,useSyncExternalStore:xp,useId:Tp,unstable_isNewReconciler:!1},V0={readContext:Ls,useCallback:Vp,useContext:Ls,useEffect:oc,useImperativeHandle:Lp,useInsertionEffect:Mp,useLayoutEffect:Pp,useMemo:Ip,useReducer:Xl,useRef:kp,useState:function(){return Xl(Eo)},useDebugValue:ac,useDeferredValue:function(t){var e=Vs();return ni===null?e.memoizedState=t:Cp(e,ni.memoizedState,t)},useTransition:function(){var t=Xl(Eo)[0],e=Vs().memoizedState;return[t,e]},useMutableSource:yp,useSyncExternalStore:xp,useId:Tp,unstable_isNewReconciler:!1};function Un(t,e){try{var s="",r=e;do s+=sm(r),r=r.return;while(r);var n=s}catch(o){n=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:n,digest:null}}function Kl(t,e,s){return{value:t,source:null,stack:s??null,digest:e??null}}function Uh(t,e){try{console.error(e.value)}catch(s){setTimeout(function(){throw s})}}var I0=typeof WeakMap=="function"?WeakMap:Map;function Ap(t,e,s){s=mr(-1,s),s.tag=3,s.payload={element:null};var r=e.value;return s.callback=function(){Ya||(Ya=!0,Xh=r),Uh(t,e)},s}function Fp(t,e,s){s=mr(-1,s),s.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var n=e.value;s.payload=function(){return r(n)},s.callback=function(){Uh(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(s.callback=function(){Uh(t,e),typeof r!="function"&&(Dr===null?Dr=new Set([this]):Dr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),s}function kf(t,e,s){var r=t.pingCache;if(r===null){r=t.pingCache=new I0;var n=new Set;r.set(e,n)}else n=r.get(e),n===void 0&&(n=new Set,r.set(e,n));n.has(s)||(n.add(s),t=G0.bind(null,t,e,s),e.then(t,t))}function Mf(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Pf(t,e,s,r,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===e?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(e=mr(-1,1),e.tag=2,Er(s,e,1))),s.lanes|=1),t)}var C0=wr.ReactCurrentOwner,as=!1;function Wi(t,e,s,r){e.child=t===null?mp(e,null,s,r):Rn(e,t.child,s,r)}function _f(t,e,s,r,n){s=s.render;var o=e.ref;return Cn(e,n),r=rc(t,e,s,r,o,n),s=nc(),t!==null&&!as?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,gr(t,e,n)):(Ge&&s&&Wu(e),e.flags|=1,Wi(t,e,r,n),e.child)}function Lf(t,e,s,r,n){if(t===null){var o=s.type;return typeof o=="function"&&!mc(o)&&o.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(e.tag=15,e.type=o,Rp(t,e,o,r,n)):(t=Pa(s.type,null,r,e,e.mode,n),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&n)){var a=o.memoizedProps;if(s=s.compare,s=s!==null?s:_o,s(a,r)&&t.ref===e.ref)return gr(t,e,n)}return e.flags|=1,t=Fr(o,r),t.ref=e.ref,t.return=e,e.child=t}function Rp(t,e,s,r,n){if(t!==null){var o=t.memoizedProps;if(_o(o,r)&&t.ref===e.ref)if(as=!1,e.pendingProps=r=o,(t.lanes&n)!==0)t.flags&131072&&(as=!0);else return e.lanes=t.lanes,gr(t,e,n)}return Bh(t,e,s,r,n)}function Op(t,e,s){var r=e.pendingProps,n=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_e(Mn,fs),fs|=s;else{if(!(s&1073741824))return t=o!==null?o.baseLanes|s:s,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_e(Mn,fs),fs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:s,_e(Mn,fs),fs|=r}else o!==null?(r=o.baseLanes|s,e.memoizedState=null):r=s,_e(Mn,fs),fs|=r;return Wi(t,e,n,s),e.child}function Up(t,e){var s=e.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(e.flags|=512,e.flags|=2097152)}function Bh(t,e,s,r,n){var o=hs(s)?Jr:Ii.current;return o=An(e,o),Cn(e,n),s=rc(t,e,s,r,o,n),r=nc(),t!==null&&!as?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,gr(t,e,n)):(Ge&&r&&Wu(e),e.flags|=1,Wi(t,e,s,n),e.child)}function Vf(t,e,s,r,n){if(hs(s)){var o=!0;Oa(e)}else o=!1;if(Cn(e,n),e.stateNode===null)Sa(t,e),pp(e,s,r),Oh(e,s,r,n),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var h=a.context,u=s.contextType;typeof u=="object"&&u!==null?u=Ls(u):(u=hs(s)?Jr:Ii.current,u=An(e,u));var c=s.getDerivedStateFromProps,f=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||h!==u)&&wf(e,a,r,u),Mr=!1;var p=e.memoizedState;a.state=p,Ga(e,r,a,n),h=e.memoizedState,l!==r||p!==h||ls.current||Mr?(typeof c=="function"&&(Rh(e,s,c,r),h=e.memoizedState),(l=Mr||gf(e,s,l,r,p,h,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=h),a.props=r,a.state=h,a.context=u,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,cp(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:As(e.type,l),a.props=u,f=e.pendingProps,p=a.context,h=s.contextType,typeof h=="object"&&h!==null?h=Ls(h):(h=hs(s)?Jr:Ii.current,h=An(e,h));var g=s.getDerivedStateFromProps;(c=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||p!==h)&&wf(e,a,r,h),Mr=!1,p=e.memoizedState,a.state=p,Ga(e,r,a,n);var y=e.memoizedState;l!==f||p!==y||ls.current||Mr?(typeof g=="function"&&(Rh(e,s,g,r),y=e.memoizedState),(u=Mr||gf(e,s,u,r,p,y,h)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,y,h),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,y,h)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),a.props=r,a.state=y,a.context=h,r=u):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return jh(t,e,s,r,o,n)}function jh(t,e,s,r,n,o){Up(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return n&&df(e,s,!1),gr(t,e,o);r=e.stateNode,C0.current=e;var l=a&&typeof s.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Rn(e,t.child,null,o),e.child=Rn(e,null,l,o)):Wi(t,e,l,o),e.memoizedState=r.state,n&&df(e,s,!0),e.child}function Bp(t){var e=t.stateNode;e.pendingContext?pf(t,e.pendingContext,e.pendingContext!==e.context):e.context&&pf(t,e.context,!1),tc(t,e.containerInfo)}function If(t,e,s,r,n){return Fn(),Qu(n),e.flags|=256,Wi(t,e,s,r),e.child}var $h={dehydrated:null,treeContext:null,retryLane:0};function Gh(t){return{baseLanes:t,cachePool:null,transitions:null}}function jp(t,e,s){var r=e.pendingProps,n=Qe.current,o=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(n&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),_e(Qe,n&1),t===null)return Ah(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=xl(a,r,0,null),t=Zr(t,r,s,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Gh(s),e.memoizedState=$h,t):lc(e,a));if(n=t.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return T0(t,e,a,r,l,n,s);if(o){o=r.fallback,a=e.mode,n=t.child,l=n.sibling;var h={mode:"hidden",children:r.children};return!(a&1)&&e.child!==n?(r=e.child,r.childLanes=0,r.pendingProps=h,e.deletions=null):(r=Fr(n,h),r.subtreeFlags=n.subtreeFlags&14680064),l!==null?o=Fr(l,o):(o=Zr(o,a,s,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=t.child.memoizedState,a=a===null?Gh(s):{baseLanes:a.baseLanes|s,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~s,e.memoizedState=$h,r}return o=t.child,t=o.sibling,r=Fr(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=s),r.return=e,r.sibling=null,t!==null&&(s=e.deletions,s===null?(e.deletions=[t],e.flags|=16):s.push(t)),e.child=r,e.memoizedState=null,r}function lc(t,e){return e=xl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ra(t,e,s,r){return r!==null&&Qu(r),Rn(e,t.child,null,s),t=lc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function T0(t,e,s,r,n,o,a){if(s)return e.flags&256?(e.flags&=-257,r=Kl(Error(X(422))),ra(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,n=e.mode,r=xl({mode:"visible",children:r.children},n,0,null),o=Zr(o,n,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Rn(e,t.child,null,a),e.child.memoizedState=Gh(a),e.memoizedState=$h,o);if(!(e.mode&1))return ra(t,e,a,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(X(419)),r=Kl(o,r,void 0),ra(t,e,a,r)}if(l=(a&t.childLanes)!==0,as||l){if(r=wi,r!==null){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|a)?0:n,n!==0&&n!==o.retryLane&&(o.retryLane=n,xr(t,n),Us(r,t,n,-1))}return dc(),r=Kl(Error(X(421))),ra(t,e,a,r)}return n.data==="$?"?(e.flags|=128,e.child=t.child,e=H0.bind(null,t),n._reactRetry=e,null):(t=o.treeContext,ps=br(n.nextSibling),ds=e,Ge=!0,Rs=null,t!==null&&(Ss[ks++]=pr,Ss[ks++]=dr,Ss[ks++]=tn,pr=t.id,dr=t.overflow,tn=e),e=lc(e,r.children),e.flags|=4096,e)}function Cf(t,e,s){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Fh(t.return,e,s)}function Zl(t,e,s,r,n){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:s,tailMode:n}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=s,o.tailMode=n)}function $p(t,e,s){var r=e.pendingProps,n=r.revealOrder,o=r.tail;if(Wi(t,e,r.children,s),r=Qe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)t:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Cf(t,s,e);else if(t.tag===19)Cf(t,s,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;t.sibling===null;){if(t.return===null||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(_e(Qe,r),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(s=e.child,n=null;s!==null;)t=s.alternate,t!==null&&Ha(t)===null&&(n=s),s=s.sibling;s=n,s===null?(n=e.child,e.child=null):(n=s.sibling,s.sibling=null),Zl(e,!1,n,s,o);break;case"backwards":for(s=null,n=e.child,e.child=null;n!==null;){if(t=n.alternate,t!==null&&Ha(t)===null){e.child=n;break}t=n.sibling,n.sibling=s,s=n,n=t}Zl(e,!0,s,null,o);break;case"together":Zl(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function gr(t,e,s){if(t!==null&&(e.dependencies=t.dependencies),sn|=e.lanes,!(s&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(X(153));if(e.child!==null){for(t=e.child,s=Fr(t,t.pendingProps),e.child=s,s.return=e;t.sibling!==null;)t=t.sibling,s=s.sibling=Fr(t,t.pendingProps),s.return=e;s.sibling=null}return e.child}function b0(t,e,s){switch(e.tag){case 3:Bp(e),Fn();break;case 5:vp(e);break;case 1:hs(e.type)&&Oa(e);break;case 4:tc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,n=e.memoizedProps.value;_e(ja,r._currentValue),r._currentValue=n;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_e(Qe,Qe.current&1),e.flags|=128,null):s&e.child.childLanes?jp(t,e,s):(_e(Qe,Qe.current&1),t=gr(t,e,s),t!==null?t.sibling:null);_e(Qe,Qe.current&1);break;case 19:if(r=(s&e.childLanes)!==0,t.flags&128){if(r)return $p(t,e,s);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),_e(Qe,Qe.current),r)break;return null;case 22:case 23:return e.lanes=0,Op(t,e,s)}return gr(t,e,s)}var Gp,Hh,Hp,Wp;Gp=function(t,e){for(var s=e.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Hh=function(){};Hp=function(t,e,s,r){var n=t.memoizedProps;if(n!==r){t=e.stateNode,Xr(ar.current);var o=null;switch(s){case"input":n=ph(t,n),r=ph(t,r),o=[];break;case"select":n=Xe({},n,{value:void 0}),r=Xe({},r,{value:void 0}),o=[];break;case"textarea":n=vh(t,n),r=vh(t,r),o=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Fa)}xh(s,r);var a;s=null;for(u in n)if(!r.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var l=n[u];for(a in l)l.hasOwnProperty(a)&&(s||(s={}),s[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(wo.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var h=r[u];if(l=n!=null?n[u]:void 0,r.hasOwnProperty(u)&&h!==l&&(h!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||h&&h.hasOwnProperty(a)||(s||(s={}),s[a]="");for(a in h)h.hasOwnProperty(a)&&l[a]!==h[a]&&(s||(s={}),s[a]=h[a])}else s||(o||(o=[]),o.push(u,s)),s=h;else u==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,l=l?l.__html:void 0,h!=null&&l!==h&&(o=o||[]).push(u,h)):u==="children"?typeof h!="string"&&typeof h!="number"||(o=o||[]).push(u,""+h):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(wo.hasOwnProperty(u)?(h!=null&&u==="onScroll"&&Fe("scroll",t),o||l===h||(o=[])):(o=o||[]).push(u,h))}s&&(o=o||[]).push("style",s);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};Wp=function(t,e,s,r){s!==r&&(e.flags|=4)};function to(t,e){if(!Ge)switch(t.tailMode){case"hidden":e=t.tail;for(var s=null;e!==null;)e.alternate!==null&&(s=e),e=e.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Li(t){var e=t.alternate!==null&&t.alternate.child===t.child,s=0,r=0;if(e)for(var n=t.child;n!==null;)s|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)s|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=r,t.childLanes=s,e}function E0(t,e,s){var r=e.pendingProps;switch(qu(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Li(e),null;case 1:return hs(e.type)&&Ra(),Li(e),null;case 3:return r=e.stateNode,On(),Re(ls),Re(Ii),ic(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ia(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Rs!==null&&(Jh(Rs),Rs=null))),Hh(t,e),Li(e),null;case 5:ec(e);var n=Xr(To.current);if(s=e.type,t!==null&&e.stateNode!=null)Hp(t,e,s,r,n),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(X(166));return Li(e),null}if(t=Xr(ar.current),ia(e)){r=e.stateNode,s=e.type;var o=e.memoizedProps;switch(r[nr]=e,r[Io]=o,t=(e.mode&1)!==0,s){case"dialog":Fe("cancel",r),Fe("close",r);break;case"iframe":case"object":case"embed":Fe("load",r);break;case"video":case"audio":for(n=0;n<ao.length;n++)Fe(ao[n],r);break;case"source":Fe("error",r);break;case"img":case"image":case"link":Fe("error",r),Fe("load",r);break;case"details":Fe("toggle",r);break;case"input":Oc(r,o),Fe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Fe("invalid",r);break;case"textarea":Bc(r,o),Fe("invalid",r)}xh(s,o),n=null;for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&ea(r.textContent,l,t),n=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&ea(r.textContent,l,t),n=["children",""+l]):wo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Fe("scroll",r)}switch(s){case"input":qo(r),Uc(r,o,!0);break;case"textarea":qo(r),jc(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Fa)}r=n,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=g1(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(s,{is:r.is}):(t=a.createElement(s),s==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,s),t[nr]=e,t[Io]=r,Gp(t,e,!1,!1),e.stateNode=t;t:{switch(a=gh(s,r),s){case"dialog":Fe("cancel",t),Fe("close",t),n=r;break;case"iframe":case"object":case"embed":Fe("load",t),n=r;break;case"video":case"audio":for(n=0;n<ao.length;n++)Fe(ao[n],t);n=r;break;case"source":Fe("error",t),n=r;break;case"img":case"image":case"link":Fe("error",t),Fe("load",t),n=r;break;case"details":Fe("toggle",t),n=r;break;case"input":Oc(t,r),n=ph(t,r),Fe("invalid",t);break;case"option":n=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},n=Xe({},r,{value:void 0}),Fe("invalid",t);break;case"textarea":Bc(t,r),n=vh(t,r),Fe("invalid",t);break;default:n=r}xh(s,n),l=n;for(o in l)if(l.hasOwnProperty(o)){var h=l[o];o==="style"?N1(t,h):o==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&w1(t,h)):o==="children"?typeof h=="string"?(s!=="textarea"||h!=="")&&zo(t,h):typeof h=="number"&&zo(t,""+h):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(wo.hasOwnProperty(o)?h!=null&&o==="onScroll"&&Fe("scroll",t):h!=null&&Tu(t,o,h,a))}switch(s){case"input":qo(t),Uc(t,r,!1);break;case"textarea":qo(t),jc(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Rr(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?_n(t,!!r.multiple,o,!1):r.defaultValue!=null&&_n(t,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=Fa)}switch(s){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Li(e),null;case 6:if(t&&e.stateNode!=null)Wp(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(X(166));if(s=Xr(To.current),Xr(ar.current),ia(e)){if(r=e.stateNode,s=e.memoizedProps,r[nr]=e,(o=r.nodeValue!==s)&&(t=ds,t!==null))switch(t.tag){case 3:ea(r.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ea(r.nodeValue,s,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(s.nodeType===9?s:s.ownerDocument).createTextNode(r),r[nr]=e,e.stateNode=r}return Li(e),null;case 13:if(Re(Qe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ge&&ps!==null&&e.mode&1&&!(e.flags&128))hp(),Fn(),e.flags|=98560,o=!1;else if(o=ia(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(X(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(X(317));o[nr]=e}else Fn(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Li(e),o=!1}else Rs!==null&&(Jh(Rs),Rs=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=s,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Qe.current&1?li===0&&(li=3):dc())),e.updateQueue!==null&&(e.flags|=4),Li(e),null);case 4:return On(),Hh(t,e),t===null&&Lo(e.stateNode.containerInfo),Li(e),null;case 10:return Ku(e.type._context),Li(e),null;case 17:return hs(e.type)&&Ra(),Li(e),null;case 19:if(Re(Qe),o=e.memoizedState,o===null)return Li(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)to(o,!1);else{if(li!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ha(t),a!==null){for(e.flags|=128,to(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=s,s=e.child;s!==null;)o=s,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return _e(Qe,Qe.current&1|2),e.child}t=t.sibling}o.tail!==null&&ti()>Bn&&(e.flags|=128,r=!0,to(o,!1),e.lanes=4194304)}else{if(!r)if(t=Ha(a),t!==null){if(e.flags|=128,r=!0,s=t.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),to(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Ge)return Li(e),null}else 2*ti()-o.renderingStartTime>Bn&&s!==1073741824&&(e.flags|=128,r=!0,to(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(s=o.last,s!==null?s.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ti(),e.sibling=null,s=Qe.current,_e(Qe,r?s&1|2:s&1),e):(Li(e),null);case 22:case 23:return pc(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?fs&1073741824&&(Li(e),e.subtreeFlags&6&&(e.flags|=8192)):Li(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function D0(t,e){switch(qu(e),e.tag){case 1:return hs(e.type)&&Ra(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return On(),Re(ls),Re(Ii),ic(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ec(e),null;case 13:if(Re(Qe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(X(340));Fn()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Re(Qe),null;case 4:return On(),null;case 10:return Ku(e.type._context),null;case 22:case 23:return pc(),null;case 24:return null;default:return null}}var na=!1,Vi=!1,A0=typeof WeakSet=="function"?WeakSet:Set,ct=null;function kn(t,e){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(r){Ze(t,e,r)}else s.current=null}function Wh(t,e,s){try{s()}catch(r){Ze(t,e,r)}}var Tf=!1;function F0(t,e){if(Vh=Ea,t=X1(),Hu(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else t:{s=(s=t.ownerDocument)&&s.defaultView||window;var r=s.getSelection&&s.getSelection();if(r&&r.rangeCount!==0){s=r.anchorNode;var n=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{s.nodeType,o.nodeType}catch{s=null;break t}var a=0,l=-1,h=-1,u=0,c=0,f=t,p=null;e:for(;;){for(var g;f!==s||n!==0&&f.nodeType!==3||(l=a+n),f!==o||r!==0&&f.nodeType!==3||(h=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===t)break e;if(p===s&&++u===n&&(l=a),p===o&&++c===r&&(h=a),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}s=l===-1||h===-1?null:{start:l,end:h}}else s=null}s=s||{start:0,end:0}}else s=null;for(Ih={focusedElem:t,selectionRange:s},Ea=!1,ct=e;ct!==null;)if(e=ct,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ct=t;else for(;ct!==null;){e=ct;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,z=y.memoizedState,x=e.stateNode,m=x.getSnapshotBeforeUpdate(e.elementType===e.type?v:As(e.type,v),z);x.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var d=e.stateNode.containerInfo;d.nodeType===1?d.textContent="":d.nodeType===9&&d.documentElement&&d.removeChild(d.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(w){Ze(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ct=t;break}ct=e.return}return y=Tf,Tf=!1,y}function yo(t,e,s){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&t)===t){var o=n.destroy;n.destroy=void 0,o!==void 0&&Wh(e,s,o)}n=n.next}while(n!==r)}}function vl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var s=e=e.next;do{if((s.tag&t)===t){var r=s.create;s.destroy=r()}s=s.next}while(s!==e)}}function qh(t){var e=t.ref;if(e!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof e=="function"?e(t):e.current=t}}function qp(t){var e=t.alternate;e!==null&&(t.alternate=null,qp(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[nr],delete e[Io],delete e[bh],delete e[g0],delete e[w0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Qp(t){return t.tag===5||t.tag===3||t.tag===4}function bf(t){t:for(;;){for(;t.sibling===null;){if(t.return===null||Qp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue t;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Qh(t,e,s){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?s.nodeType===8?s.parentNode.insertBefore(t,e):s.insertBefore(t,e):(s.nodeType===8?(e=s.parentNode,e.insertBefore(t,s)):(e=s,e.appendChild(t)),s=s._reactRootContainer,s!=null||e.onclick!==null||(e.onclick=Fa));else if(r!==4&&(t=t.child,t!==null))for(Qh(t,e,s),t=t.sibling;t!==null;)Qh(t,e,s),t=t.sibling}function Yh(t,e,s){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?s.insertBefore(t,e):s.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Yh(t,e,s),t=t.sibling;t!==null;)Yh(t,e,s),t=t.sibling}var zi=null,Fs=!1;function zr(t,e,s){for(s=s.child;s!==null;)Yp(t,e,s),s=s.sibling}function Yp(t,e,s){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(ll,s)}catch{}switch(s.tag){case 5:Vi||kn(s,e);case 6:var r=zi,n=Fs;zi=null,zr(t,e,s),zi=r,Fs=n,zi!==null&&(Fs?(t=zi,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):zi.removeChild(s.stateNode));break;case 18:zi!==null&&(Fs?(t=zi,s=s.stateNode,t.nodeType===8?Hl(t.parentNode,s):t.nodeType===1&&Hl(t,s),Mo(t)):Hl(zi,s.stateNode));break;case 4:r=zi,n=Fs,zi=s.stateNode.containerInfo,Fs=!0,zr(t,e,s),zi=r,Fs=n;break;case 0:case 11:case 14:case 15:if(!Vi&&(r=s.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var o=n,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Wh(s,e,a),n=n.next}while(n!==r)}zr(t,e,s);break;case 1:if(!Vi&&(kn(s,e),r=s.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=s.memoizedProps,r.state=s.memoizedState,r.componentWillUnmount()}catch(l){Ze(s,e,l)}zr(t,e,s);break;case 21:zr(t,e,s);break;case 22:s.mode&1?(Vi=(r=Vi)||s.memoizedState!==null,zr(t,e,s),Vi=r):zr(t,e,s);break;default:zr(t,e,s)}}function Ef(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new A0),e.forEach(function(r){var n=W0.bind(null,t,r);s.has(r)||(s.add(r),r.then(n,n))})}}function Ds(t,e){var s=e.deletions;if(s!==null)for(var r=0;r<s.length;r++){var n=s[r];try{var o=t,a=e,l=a;t:for(;l!==null;){switch(l.tag){case 5:zi=l.stateNode,Fs=!1;break t;case 3:zi=l.stateNode.containerInfo,Fs=!0;break t;case 4:zi=l.stateNode.containerInfo,Fs=!0;break t}l=l.return}if(zi===null)throw Error(X(160));Yp(o,a,n),zi=null,Fs=!1;var h=n.alternate;h!==null&&(h.return=null),n.return=null}catch(u){Ze(n,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Xp(e,t),e=e.sibling}function Xp(t,e){var s=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ds(e,t),Zs(t),r&4){try{yo(3,t,t.return),vl(3,t)}catch(v){Ze(t,t.return,v)}try{yo(5,t,t.return)}catch(v){Ze(t,t.return,v)}}break;case 1:Ds(e,t),Zs(t),r&512&&s!==null&&kn(s,s.return);break;case 5:if(Ds(e,t),Zs(t),r&512&&s!==null&&kn(s,s.return),t.flags&32){var n=t.stateNode;try{zo(n,"")}catch(v){Ze(t,t.return,v)}}if(r&4&&(n=t.stateNode,n!=null)){var o=t.memoizedProps,a=s!==null?s.memoizedProps:o,l=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&y1(n,o),gh(l,a);var u=gh(l,o);for(a=0;a<h.length;a+=2){var c=h[a],f=h[a+1];c==="style"?N1(n,f):c==="dangerouslySetInnerHTML"?w1(n,f):c==="children"?zo(n,f):Tu(n,c,f,u)}switch(l){case"input":dh(n,o);break;case"textarea":x1(n,o);break;case"select":var p=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?_n(n,!!o.multiple,g,!1):p!==!!o.multiple&&(o.defaultValue!=null?_n(n,!!o.multiple,o.defaultValue,!0):_n(n,!!o.multiple,o.multiple?[]:"",!1))}n[Io]=o}catch(v){Ze(t,t.return,v)}}break;case 6:if(Ds(e,t),Zs(t),r&4){if(t.stateNode===null)throw Error(X(162));n=t.stateNode,o=t.memoizedProps;try{n.nodeValue=o}catch(v){Ze(t,t.return,v)}}break;case 3:if(Ds(e,t),Zs(t),r&4&&s!==null&&s.memoizedState.isDehydrated)try{Mo(e.containerInfo)}catch(v){Ze(t,t.return,v)}break;case 4:Ds(e,t),Zs(t);break;case 13:Ds(e,t),Zs(t),n=t.child,n.flags&8192&&(o=n.memoizedState!==null,n.stateNode.isHidden=o,!o||n.alternate!==null&&n.alternate.memoizedState!==null||(cc=ti())),r&4&&Ef(t);break;case 22:if(c=s!==null&&s.memoizedState!==null,t.mode&1?(Vi=(u=Vi)||c,Ds(e,t),Vi=u):Ds(e,t),Zs(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(ct=t,c=t.child;c!==null;){for(f=ct=c;ct!==null;){switch(p=ct,g=p.child,p.tag){case 0:case 11:case 14:case 15:yo(4,p,p.return);break;case 1:kn(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,s=p.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){Ze(r,s,v)}}break;case 5:kn(p,p.return);break;case 22:if(p.memoizedState!==null){Af(f);continue}}g!==null?(g.return=p,ct=g):Af(f)}c=c.sibling}t:for(c=null,f=t;;){if(f.tag===5){if(c===null){c=f;try{n=f.stateNode,u?(o=n.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,h=f.memoizedProps.style,a=h!=null&&h.hasOwnProperty("display")?h.display:null,l.style.display=z1("display",a))}catch(v){Ze(t,t.return,v)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){Ze(t,t.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break t;for(;f.sibling===null;){if(f.return===null||f.return===t)break t;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ds(e,t),Zs(t),r&4&&Ef(t);break;case 21:break;default:Ds(e,t),Zs(t)}}function Zs(t){var e=t.flags;if(e&2){try{t:{for(var s=t.return;s!==null;){if(Qp(s)){var r=s;break t}s=s.return}throw Error(X(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(zo(n,""),r.flags&=-33);var o=bf(t);Yh(t,o,n);break;case 3:case 4:var a=r.stateNode.containerInfo,l=bf(t);Qh(t,l,a);break;default:throw Error(X(161))}}catch(h){Ze(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function R0(t,e,s){ct=t,Kp(t)}function Kp(t,e,s){for(var r=(t.mode&1)!==0;ct!==null;){var n=ct,o=n.child;if(n.tag===22&&r){var a=n.memoizedState!==null||na;if(!a){var l=n.alternate,h=l!==null&&l.memoizedState!==null||Vi;l=na;var u=Vi;if(na=a,(Vi=h)&&!u)for(ct=n;ct!==null;)a=ct,h=a.child,a.tag===22&&a.memoizedState!==null?Ff(n):h!==null?(h.return=a,ct=h):Ff(n);for(;o!==null;)ct=o,Kp(o),o=o.sibling;ct=n,na=l,Vi=u}Df(t)}else n.subtreeFlags&8772&&o!==null?(o.return=n,ct=o):Df(t)}}function Df(t){for(;ct!==null;){var e=ct;if(e.flags&8772){var s=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vi||vl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Vi)if(s===null)r.componentDidMount();else{var n=e.elementType===e.type?s.memoizedProps:As(e.type,s.memoizedProps);r.componentDidUpdate(n,s.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&xf(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(s=null,e.child!==null)switch(e.child.tag){case 5:s=e.child.stateNode;break;case 1:s=e.child.stateNode}xf(e,a,s)}break;case 5:var l=e.stateNode;if(s===null&&e.flags&4){s=l;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&s.focus();break;case"img":h.src&&(s.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Mo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}Vi||e.flags&512&&qh(e)}catch(p){Ze(e,e.return,p)}}if(e===t){ct=null;break}if(s=e.sibling,s!==null){s.return=e.return,ct=s;break}ct=e.return}}function Af(t){for(;ct!==null;){var e=ct;if(e===t){ct=null;break}var s=e.sibling;if(s!==null){s.return=e.return,ct=s;break}ct=e.return}}function Ff(t){for(;ct!==null;){var e=ct;try{switch(e.tag){case 0:case 11:case 15:var s=e.return;try{vl(4,e)}catch(h){Ze(e,s,h)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var n=e.return;try{r.componentDidMount()}catch(h){Ze(e,n,h)}}var o=e.return;try{qh(e)}catch(h){Ze(e,o,h)}break;case 5:var a=e.return;try{qh(e)}catch(h){Ze(e,a,h)}}}catch(h){Ze(e,e.return,h)}if(e===t){ct=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ct=l;break}ct=e.return}}var O0=Math.ceil,Qa=wr.ReactCurrentDispatcher,hc=wr.ReactCurrentOwner,_s=wr.ReactCurrentBatchConfig,se=0,wi=null,ii=null,ki=0,fs=0,Mn=jr(0),li=0,Ao=null,sn=0,yl=0,uc=0,xo=null,os=null,cc=0,Bn=1/0,ur=null,Ya=!1,Xh=null,Dr=null,oa=!1,Vr=null,Xa=0,go=0,Kh=null,ka=-1,Ma=0;function Qi(){return se&6?ti():ka!==-1?ka:ka=ti()}function Ar(t){return t.mode&1?se&2&&ki!==0?ki&-ki:N0.transition!==null?(Ma===0&&(Ma=E1()),Ma):(t=xe,t!==0||(t=window.event,t=t===void 0?16:B1(t.type)),t):1}function Us(t,e,s,r){if(50<go)throw go=0,Kh=null,Error(X(185));Oo(t,s,r),(!(se&2)||t!==wi)&&(t===wi&&(!(se&2)&&(yl|=s),li===4&&_r(t,ki)),us(t,r),s===1&&se===0&&!(e.mode&1)&&(Bn=ti()+500,pl&&$r()))}function us(t,e){var s=t.callbackNode;Nm(t,e);var r=ba(t,t===wi?ki:0);if(r===0)s!==null&&Hc(s),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(s!=null&&Hc(s),e===1)t.tag===0?z0(Rf.bind(null,t)):op(Rf.bind(null,t)),y0(function(){!(se&6)&&$r()}),s=null;else{switch(D1(r)){case 1:s=Fu;break;case 4:s=T1;break;case 16:s=Ta;break;case 536870912:s=b1;break;default:s=Ta}s=nd(s,Zp.bind(null,t))}t.callbackPriority=e,t.callbackNode=s}}function Zp(t,e){if(ka=-1,Ma=0,se&6)throw Error(X(327));var s=t.callbackNode;if(Tn()&&t.callbackNode!==s)return null;var r=ba(t,t===wi?ki:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ka(t,r);else{e=r;var n=se;se|=2;var o=td();(wi!==t||ki!==e)&&(ur=null,Bn=ti()+500,Kr(t,e));do try{j0();break}catch(l){Jp(t,l)}while(1);Xu(),Qa.current=o,se=n,ii!==null?e=0:(wi=null,ki=0,e=li)}if(e!==0){if(e===2&&(n=kh(t),n!==0&&(r=n,e=Zh(t,n))),e===1)throw s=Ao,Kr(t,0),_r(t,r),us(t,ti()),s;if(e===6)_r(t,r);else{if(n=t.current.alternate,!(r&30)&&!U0(n)&&(e=Ka(t,r),e===2&&(o=kh(t),o!==0&&(r=o,e=Zh(t,o))),e===1))throw s=Ao,Kr(t,0),_r(t,r),us(t,ti()),s;switch(t.finishedWork=n,t.finishedLanes=r,e){case 0:case 1:throw Error(X(345));case 2:Hr(t,os,ur);break;case 3:if(_r(t,r),(r&130023424)===r&&(e=cc+500-ti(),10<e)){if(ba(t,0)!==0)break;if(n=t.suspendedLanes,(n&r)!==r){Qi(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=Th(Hr.bind(null,t,os,ur),e);break}Hr(t,os,ur);break;case 4:if(_r(t,r),(r&4194240)===r)break;for(e=t.eventTimes,n=-1;0<r;){var a=31-Os(r);o=1<<a,a=e[a],a>n&&(n=a),r&=~o}if(r=n,r=ti()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*O0(r/1960))-r,10<r){t.timeoutHandle=Th(Hr.bind(null,t,os,ur),r);break}Hr(t,os,ur);break;case 5:Hr(t,os,ur);break;default:throw Error(X(329))}}}return us(t,ti()),t.callbackNode===s?Zp.bind(null,t):null}function Zh(t,e){var s=xo;return t.current.memoizedState.isDehydrated&&(Kr(t,e).flags|=256),t=Ka(t,e),t!==2&&(e=os,os=s,e!==null&&Jh(e)),t}function Jh(t){os===null?os=t:os.push.apply(os,t)}function U0(t){for(var e=t;;){if(e.flags&16384){var s=e.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var r=0;r<s.length;r++){var n=s[r],o=n.getSnapshot;n=n.value;try{if(!Bs(o(),n))return!1}catch{return!1}}}if(s=e.child,e.subtreeFlags&16384&&s!==null)s.return=e,e=s;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _r(t,e){for(e&=~uc,e&=~yl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var s=31-Os(e),r=1<<s;t[s]=-1,e&=~r}}function Rf(t){if(se&6)throw Error(X(327));Tn();var e=ba(t,0);if(!(e&1))return us(t,ti()),null;var s=Ka(t,e);if(t.tag!==0&&s===2){var r=kh(t);r!==0&&(e=r,s=Zh(t,r))}if(s===1)throw s=Ao,Kr(t,0),_r(t,e),us(t,ti()),s;if(s===6)throw Error(X(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Hr(t,os,ur),us(t,ti()),null}function fc(t,e){var s=se;se|=1;try{return t(e)}finally{se=s,se===0&&(Bn=ti()+500,pl&&$r())}}function rn(t){Vr!==null&&Vr.tag===0&&!(se&6)&&Tn();var e=se;se|=1;var s=_s.transition,r=xe;try{if(_s.transition=null,xe=1,t)return t()}finally{xe=r,_s.transition=s,se=e,!(se&6)&&$r()}}function pc(){fs=Mn.current,Re(Mn)}function Kr(t,e){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,v0(s)),ii!==null)for(s=ii.return;s!==null;){var r=s;switch(qu(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ra();break;case 3:On(),Re(ls),Re(Ii),ic();break;case 5:ec(r);break;case 4:On();break;case 13:Re(Qe);break;case 19:Re(Qe);break;case 10:Ku(r.type._context);break;case 22:case 23:pc()}s=s.return}if(wi=t,ii=t=Fr(t.current,null),ki=fs=e,li=0,Ao=null,uc=yl=sn=0,os=xo=null,Yr!==null){for(e=0;e<Yr.length;e++)if(s=Yr[e],r=s.interleaved,r!==null){s.interleaved=null;var n=r.next,o=s.pending;if(o!==null){var a=o.next;o.next=n,r.next=a}s.pending=r}Yr=null}return t}function Jp(t,e){do{var s=ii;try{if(Xu(),za.current=qa,Wa){for(var r=Ye.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}Wa=!1}if(en=0,xi=ni=Ye=null,vo=!1,bo=0,hc.current=null,s===null||s.return===null){li=1,Ao=e,ii=null;break}t:{var o=t,a=s.return,l=s,h=e;if(e=ki,l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var u=h,c=l,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=Mf(a);if(g!==null){g.flags&=-257,Pf(g,a,l,o,e),g.mode&1&&kf(o,u,e),e=g,h=u;var y=e.updateQueue;if(y===null){var v=new Set;v.add(h),e.updateQueue=v}else y.add(h);break t}else{if(!(e&1)){kf(o,u,e),dc();break t}h=Error(X(426))}}else if(Ge&&l.mode&1){var z=Mf(a);if(z!==null){!(z.flags&65536)&&(z.flags|=256),Pf(z,a,l,o,e),Qu(Un(h,l));break t}}o=h=Un(h,l),li!==4&&(li=2),xo===null?xo=[o]:xo.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var x=Ap(o,h,e);yf(o,x);break t;case 1:l=h;var m=o.type,d=o.stateNode;if(!(o.flags&128)&&(typeof m.getDerivedStateFromError=="function"||d!==null&&typeof d.componentDidCatch=="function"&&(Dr===null||!Dr.has(d)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=Fp(o,l,e);yf(o,w);break t}}o=o.return}while(o!==null)}id(s)}catch(N){e=N,ii===s&&s!==null&&(ii=s=s.return);continue}break}while(1)}function td(){var t=Qa.current;return Qa.current=qa,t===null?qa:t}function dc(){(li===0||li===3||li===2)&&(li=4),wi===null||!(sn&268435455)&&!(yl&268435455)||_r(wi,ki)}function Ka(t,e){var s=se;se|=2;var r=td();(wi!==t||ki!==e)&&(ur=null,Kr(t,e));do try{B0();break}catch(n){Jp(t,n)}while(1);if(Xu(),se=s,Qa.current=r,ii!==null)throw Error(X(261));return wi=null,ki=0,li}function B0(){for(;ii!==null;)ed(ii)}function j0(){for(;ii!==null&&!pm();)ed(ii)}function ed(t){var e=rd(t.alternate,t,fs);t.memoizedProps=t.pendingProps,e===null?id(t):ii=e,hc.current=null}function id(t){var e=t;do{var s=e.alternate;if(t=e.return,e.flags&32768){if(s=D0(s,e),s!==null){s.flags&=32767,ii=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{li=6,ii=null;return}}else if(s=E0(s,e,fs),s!==null){ii=s;return}if(e=e.sibling,e!==null){ii=e;return}ii=e=t}while(e!==null);li===0&&(li=5)}function Hr(t,e,s){var r=xe,n=_s.transition;try{_s.transition=null,xe=1,$0(t,e,s,r)}finally{_s.transition=n,xe=r}return null}function $0(t,e,s,r){do Tn();while(Vr!==null);if(se&6)throw Error(X(327));s=t.finishedWork;var n=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(X(177));t.callbackNode=null,t.callbackPriority=0;var o=s.lanes|s.childLanes;if(Sm(t,o),t===wi&&(ii=wi=null,ki=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||oa||(oa=!0,nd(Ta,function(){return Tn(),null})),o=(s.flags&15990)!==0,s.subtreeFlags&15990||o){o=_s.transition,_s.transition=null;var a=xe;xe=1;var l=se;se|=4,hc.current=null,F0(t,s),Xp(s,t),h0(Ih),Ea=!!Vh,Ih=Vh=null,t.current=s,R0(s),dm(),se=l,xe=a,_s.transition=o}else t.current=s;if(oa&&(oa=!1,Vr=t,Xa=n),o=t.pendingLanes,o===0&&(Dr=null),ym(s.stateNode),us(t,ti()),e!==null)for(r=t.onRecoverableError,s=0;s<e.length;s++)n=e[s],r(n.value,{componentStack:n.stack,digest:n.digest});if(Ya)throw Ya=!1,t=Xh,Xh=null,t;return Xa&1&&t.tag!==0&&Tn(),o=t.pendingLanes,o&1?t===Kh?go++:(go=0,Kh=t):go=0,$r(),null}function Tn(){if(Vr!==null){var t=D1(Xa),e=_s.transition,s=xe;try{if(_s.transition=null,xe=16>t?16:t,Vr===null)var r=!1;else{if(t=Vr,Vr=null,Xa=0,se&6)throw Error(X(331));var n=se;for(se|=4,ct=t.current;ct!==null;){var o=ct,a=o.child;if(ct.flags&16){var l=o.deletions;if(l!==null){for(var h=0;h<l.length;h++){var u=l[h];for(ct=u;ct!==null;){var c=ct;switch(c.tag){case 0:case 11:case 15:yo(8,c,o)}var f=c.child;if(f!==null)f.return=c,ct=f;else for(;ct!==null;){c=ct;var p=c.sibling,g=c.return;if(qp(c),c===u){ct=null;break}if(p!==null){p.return=g,ct=p;break}ct=g}}}var y=o.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var z=v.sibling;v.sibling=null,v=z}while(v!==null)}}ct=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,ct=a;else t:for(;ct!==null;){if(o=ct,o.flags&2048)switch(o.tag){case 0:case 11:case 15:yo(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,ct=x;break t}ct=o.return}}var m=t.current;for(ct=m;ct!==null;){a=ct;var d=a.child;if(a.subtreeFlags&2064&&d!==null)d.return=a,ct=d;else t:for(a=m;ct!==null;){if(l=ct,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:vl(9,l)}}catch(N){Ze(l,l.return,N)}if(l===a){ct=null;break t}var w=l.sibling;if(w!==null){w.return=l.return,ct=w;break t}ct=l.return}}if(se=n,$r(),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(ll,t)}catch{}r=!0}return r}finally{xe=s,_s.transition=e}}return!1}function Of(t,e,s){e=Un(s,e),e=Ap(t,e,1),t=Er(t,e,1),e=Qi(),t!==null&&(Oo(t,1,e),us(t,e))}function Ze(t,e,s){if(t.tag===3)Of(t,t,s);else for(;e!==null;){if(e.tag===3){Of(e,t,s);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Dr===null||!Dr.has(r))){t=Un(s,t),t=Fp(e,t,1),e=Er(e,t,1),t=Qi(),e!==null&&(Oo(e,1,t),us(e,t));break}}e=e.return}}function G0(t,e,s){var r=t.pingCache;r!==null&&r.delete(e),e=Qi(),t.pingedLanes|=t.suspendedLanes&s,wi===t&&(ki&s)===s&&(li===4||li===3&&(ki&130023424)===ki&&500>ti()-cc?Kr(t,0):uc|=s),us(t,e)}function sd(t,e){e===0&&(t.mode&1?(e=Xo,Xo<<=1,!(Xo&130023424)&&(Xo=4194304)):e=1);var s=Qi();t=xr(t,e),t!==null&&(Oo(t,e,s),us(t,s))}function H0(t){var e=t.memoizedState,s=0;e!==null&&(s=e.retryLane),sd(t,s)}function W0(t,e){var s=0;switch(t.tag){case 13:var r=t.stateNode,n=t.memoizedState;n!==null&&(s=n.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(e),sd(t,s)}var rd;rd=function(t,e,s){if(t!==null)if(t.memoizedProps!==e.pendingProps||ls.current)as=!0;else{if(!(t.lanes&s)&&!(e.flags&128))return as=!1,b0(t,e,s);as=!!(t.flags&131072)}else as=!1,Ge&&e.flags&1048576&&ap(e,Ba,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Sa(t,e),t=e.pendingProps;var n=An(e,Ii.current);Cn(e,s),n=rc(null,e,r,t,n,s);var o=nc();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hs(r)?(o=!0,Oa(e)):o=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Ju(e),n.updater=dl,e.stateNode=n,n._reactInternals=e,Oh(e,r,t,s),e=jh(null,e,r,!0,o,s)):(e.tag=0,Ge&&o&&Wu(e),Wi(null,e,n,s),e=e.child),e;case 16:r=e.elementType;t:{switch(Sa(t,e),t=e.pendingProps,n=r._init,r=n(r._payload),e.type=r,n=e.tag=Q0(r),t=As(r,t),n){case 0:e=Bh(null,e,r,t,s);break t;case 1:e=Vf(null,e,r,t,s);break t;case 11:e=_f(null,e,r,t,s);break t;case 14:e=Lf(null,e,r,As(r.type,t),s);break t}throw Error(X(306,r,""))}return e;case 0:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:As(r,n),Bh(t,e,r,n,s);case 1:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:As(r,n),Vf(t,e,r,n,s);case 3:t:{if(Bp(e),t===null)throw Error(X(387));r=e.pendingProps,o=e.memoizedState,n=o.element,cp(t,e),Ga(e,r,null,s);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){n=Un(Error(X(423)),e),e=If(t,e,r,s,n);break t}else if(r!==n){n=Un(Error(X(424)),e),e=If(t,e,r,s,n);break t}else for(ps=br(e.stateNode.containerInfo.firstChild),ds=e,Ge=!0,Rs=null,s=mp(e,null,r,s),e.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Fn(),r===n){e=gr(t,e,s);break t}Wi(t,e,r,s)}e=e.child}return e;case 5:return vp(e),t===null&&Ah(e),r=e.type,n=e.pendingProps,o=t!==null?t.memoizedProps:null,a=n.children,Ch(r,n)?a=null:o!==null&&Ch(r,o)&&(e.flags|=32),Up(t,e),Wi(t,e,a,s),e.child;case 6:return t===null&&Ah(e),null;case 13:return jp(t,e,s);case 4:return tc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Rn(e,null,r,s):Wi(t,e,r,s),e.child;case 11:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:As(r,n),_f(t,e,r,n,s);case 7:return Wi(t,e,e.pendingProps,s),e.child;case 8:return Wi(t,e,e.pendingProps.children,s),e.child;case 12:return Wi(t,e,e.pendingProps.children,s),e.child;case 10:t:{if(r=e.type._context,n=e.pendingProps,o=e.memoizedProps,a=n.value,_e(ja,r._currentValue),r._currentValue=a,o!==null)if(Bs(o.value,a)){if(o.children===n.children&&!ls.current){e=gr(t,e,s);break t}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){a=o.child;for(var h=l.firstContext;h!==null;){if(h.context===r){if(o.tag===1){h=mr(-1,s&-s),h.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?h.next=h:(h.next=c.next,c.next=h),u.pending=h}}o.lanes|=s,h=o.alternate,h!==null&&(h.lanes|=s),Fh(o.return,s,e),l.lanes|=s;break}h=h.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(X(341));a.lanes|=s,l=a.alternate,l!==null&&(l.lanes|=s),Fh(a,s,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Wi(t,e,n.children,s),e=e.child}return e;case 9:return n=e.type,r=e.pendingProps.children,Cn(e,s),n=Ls(n),r=r(n),e.flags|=1,Wi(t,e,r,s),e.child;case 14:return r=e.type,n=As(r,e.pendingProps),n=As(r.type,n),Lf(t,e,r,n,s);case 15:return Rp(t,e,e.type,e.pendingProps,s);case 17:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:As(r,n),Sa(t,e),e.tag=1,hs(r)?(t=!0,Oa(e)):t=!1,Cn(e,s),pp(e,r,n),Oh(e,r,n,s),jh(null,e,r,!0,t,s);case 19:return $p(t,e,s);case 22:return Op(t,e,s)}throw Error(X(156,e.tag))};function nd(t,e){return C1(t,e)}function q0(t,e,s,r){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ms(t,e,s,r){return new q0(t,e,s,r)}function mc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Q0(t){if(typeof t=="function")return mc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Eu)return 11;if(t===Du)return 14}return 2}function Fr(t,e){var s=t.alternate;return s===null?(s=Ms(t.tag,e,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=e,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,e=t.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function Pa(t,e,s,r,n,o){var a=2;if(r=t,typeof t=="function")mc(t)&&(a=1);else if(typeof t=="string")a=5;else t:switch(t){case mn:return Zr(s.children,n,o,e);case bu:a=8,n|=8;break;case hh:return t=Ms(12,s,e,n|2),t.elementType=hh,t.lanes=o,t;case uh:return t=Ms(13,s,e,n),t.elementType=uh,t.lanes=o,t;case ch:return t=Ms(19,s,e,n),t.elementType=ch,t.lanes=o,t;case d1:return xl(s,n,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case f1:a=10;break t;case p1:a=9;break t;case Eu:a=11;break t;case Du:a=14;break t;case kr:a=16,r=null;break t}throw Error(X(130,t==null?t:typeof t,""))}return e=Ms(a,s,e,n),e.elementType=t,e.type=r,e.lanes=o,e}function Zr(t,e,s,r){return t=Ms(7,t,r,e),t.lanes=s,t}function xl(t,e,s,r){return t=Ms(22,t,r,e),t.elementType=d1,t.lanes=s,t.stateNode={isHidden:!1},t}function Jl(t,e,s){return t=Ms(6,t,null,e),t.lanes=s,t}function th(t,e,s){return e=Ms(4,t.children!==null?t.children:[],t.key,e),e.lanes=s,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Y0(t,e,s,r,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=El(0),this.expirationTimes=El(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=El(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function vc(t,e,s,r,n,o,a,l,h){return t=new Y0(t,e,s,l,h),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ms(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ju(o),t}function X0(t,e,s){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dn,key:r==null?null:""+r,children:t,containerInfo:e,implementation:s}}function od(t){if(!t)return Or;t=t._reactInternals;t:{if(on(t)!==t||t.tag!==1)throw Error(X(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(hs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(e!==null);throw Error(X(171))}if(t.tag===1){var s=t.type;if(hs(s))return np(t,s,e)}return e}function ad(t,e,s,r,n,o,a,l,h){return t=vc(s,r,!0,t,n,o,a,l,h),t.context=od(null),s=t.current,r=Qi(),n=Ar(s),o=mr(r,n),o.callback=e??null,Er(s,o,n),t.current.lanes=n,Oo(t,n,r),us(t,r),t}function gl(t,e,s,r){var n=e.current,o=Qi(),a=Ar(n);return s=od(s),e.context===null?e.context=s:e.pendingContext=s,e=mr(o,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Er(n,e,a),t!==null&&(Us(t,n,a,o),wa(t,n,a)),a}function Za(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Uf(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<e?s:e}}function yc(t,e){Uf(t,e),(t=t.alternate)&&Uf(t,e)}function K0(){return null}var ld=typeof reportError=="function"?reportError:function(t){console.error(t)};function xc(t){this._internalRoot=t}wl.prototype.render=xc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(X(409));gl(t,e,null,null)};wl.prototype.unmount=xc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;rn(function(){gl(null,t,null,null)}),e[yr]=null}};function wl(t){this._internalRoot=t}wl.prototype.unstable_scheduleHydration=function(t){if(t){var e=R1();t={blockedOn:null,target:t,priority:e};for(var s=0;s<Pr.length&&e!==0&&e<Pr[s].priority;s++);Pr.splice(s,0,t),s===0&&U1(t)}};function gc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function zl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Bf(){}function Z0(t,e,s,r,n){if(n){if(typeof r=="function"){var o=r;r=function(){var u=Za(a);o.call(u)}}var a=ad(e,r,t,0,null,!1,!1,"",Bf);return t._reactRootContainer=a,t[yr]=a.current,Lo(t.nodeType===8?t.parentNode:t),rn(),a}for(;n=t.lastChild;)t.removeChild(n);if(typeof r=="function"){var l=r;r=function(){var u=Za(h);l.call(u)}}var h=vc(t,0,!1,null,null,!1,!1,"",Bf);return t._reactRootContainer=h,t[yr]=h.current,Lo(t.nodeType===8?t.parentNode:t),rn(function(){gl(e,h,s,r)}),h}function Nl(t,e,s,r,n){var o=s._reactRootContainer;if(o){var a=o;if(typeof n=="function"){var l=n;n=function(){var h=Za(a);l.call(h)}}gl(e,a,t,n)}else a=Z0(s,e,t,n,r);return Za(a)}A1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var s=oo(e.pendingLanes);s!==0&&(Ru(e,s|1),us(e,ti()),!(se&6)&&(Bn=ti()+500,$r()))}break;case 13:rn(function(){var r=xr(t,1);if(r!==null){var n=Qi();Us(r,t,1,n)}}),yc(t,1)}};Ou=function(t){if(t.tag===13){var e=xr(t,134217728);if(e!==null){var s=Qi();Us(e,t,134217728,s)}yc(t,134217728)}};F1=function(t){if(t.tag===13){var e=Ar(t),s=xr(t,e);if(s!==null){var r=Qi();Us(s,t,e,r)}yc(t,e)}};R1=function(){return xe};O1=function(t,e){var s=xe;try{return xe=t,e()}finally{xe=s}};zh=function(t,e,s){switch(e){case"input":if(dh(t,s),e=s.name,s.type==="radio"&&e!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<s.length;e++){var r=s[e];if(r!==t&&r.form===t.form){var n=fl(r);if(!n)throw Error(X(90));v1(r),dh(r,n)}}}break;case"textarea":x1(t,s);break;case"select":e=s.value,e!=null&&_n(t,!!s.multiple,e,!1)}};M1=fc;P1=rn;var J0={usingClientEntryPoint:!1,Events:[Bo,gn,fl,S1,k1,fc]},eo={findFiberByHostInstance:Qr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},t2={bundleType:eo.bundleType,version:eo.version,rendererPackageName:eo.rendererPackageName,rendererConfig:eo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=V1(t),t===null?null:t.stateNode},findFiberByHostInstance:eo.findFiberByHostInstance||K0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var aa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!aa.isDisabled&&aa.supportsFiber)try{ll=aa.inject(t2),or=aa}catch{}}vs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J0;vs.createPortal=function(t,e){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gc(e))throw Error(X(200));return X0(t,e,null,s)};vs.createRoot=function(t,e){if(!gc(t))throw Error(X(299));var s=!1,r="",n=ld;return e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=vc(t,1,!1,null,null,s,!1,r,n),t[yr]=e.current,Lo(t.nodeType===8?t.parentNode:t),new xc(e)};vs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(X(188)):(t=Object.keys(t).join(","),Error(X(268,t)));return t=V1(e),t=t===null?null:t.stateNode,t};vs.flushSync=function(t){return rn(t)};vs.hydrate=function(t,e,s){if(!zl(e))throw Error(X(200));return Nl(null,t,e,!0,s)};vs.hydrateRoot=function(t,e,s){if(!gc(t))throw Error(X(405));var r=s!=null&&s.hydratedSources||null,n=!1,o="",a=ld;if(s!=null&&(s.unstable_strictMode===!0&&(n=!0),s.identifierPrefix!==void 0&&(o=s.identifierPrefix),s.onRecoverableError!==void 0&&(a=s.onRecoverableError)),e=ad(e,null,t,1,s??null,n,!1,o,a),t[yr]=e.current,Lo(t),r)for(t=0;t<r.length;t++)s=r[t],n=s._getVersion,n=n(s._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[s,n]:e.mutableSourceEagerHydrationData.push(s,n);return new wl(e)};vs.render=function(t,e,s){if(!zl(e))throw Error(X(200));return Nl(null,t,e,!1,s)};vs.unmountComponentAtNode=function(t){if(!zl(t))throw Error(X(40));return t._reactRootContainer?(rn(function(){Nl(null,null,t,!1,function(){t._reactRootContainer=null,t[yr]=null})}),!0):!1};vs.unstable_batchedUpdates=fc;vs.unstable_renderSubtreeIntoContainer=function(t,e,s,r){if(!zl(s))throw Error(X(200));if(t==null||t._reactInternals===void 0)throw Error(X(38));return Nl(t,e,s,!1,r)};vs.version="18.2.0-next-9e3b772b8-20220608";function hd(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hd)}catch(t){console.error(t)}}hd(),a1.exports=vs;var e2=a1.exports,jf=e2;ah.createRoot=jf.createRoot,ah.hydrateRoot=jf.hydrateRoot;var i2=Object.defineProperty,s2=(t,e,s)=>e in t?i2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,oi=(t,e,s)=>(s2(t,typeof e!="symbol"?e+"":e,s),s),_a=1e-6,Yi=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function ud(){var t=new Yi(9);return Yi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function r2(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function fr(){var t=new Yi(16);return Yi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function rr(t){var e=new Yi(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function n2(t,e,s,r,n,o,a,l,h,u,c,f,p,g,y,v){var z=new Yi(16);return z[0]=t,z[1]=e,z[2]=s,z[3]=r,z[4]=n,z[5]=o,z[6]=a,z[7]=l,z[8]=h,z[9]=u,z[10]=c,z[11]=f,z[12]=p,z[13]=g,z[14]=y,z[15]=v,z}function tu(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o2(t,e){if(t===e){var s=e[1],r=e[2],n=e[3],o=e[6],a=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=s,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=n,t[13]=a,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Ke(t,e){var s=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],h=e[6],u=e[7],c=e[8],f=e[9],p=e[10],g=e[11],y=e[12],v=e[13],z=e[14],x=e[15],m=s*l-r*a,d=s*h-n*a,w=s*u-o*a,N=r*h-n*l,S=r*u-o*l,k=n*u-o*h,O=c*v-f*y,E=c*z-p*y,M=c*x-g*y,R=f*z-p*v,D=f*x-g*v,A=p*x-g*z,P=m*A-d*D+w*R+N*M-S*E+k*O;return P?(P=1/P,t[0]=(l*A-h*D+u*R)*P,t[1]=(n*D-r*A-o*R)*P,t[2]=(v*k-z*S+x*N)*P,t[3]=(p*S-f*k-g*N)*P,t[4]=(h*M-a*A-u*E)*P,t[5]=(s*A-n*M+o*E)*P,t[6]=(z*w-y*k-x*d)*P,t[7]=(c*k-p*w+g*d)*P,t[8]=(a*D-l*M+u*O)*P,t[9]=(r*M-s*D-o*O)*P,t[10]=(y*S-v*w+x*m)*P,t[11]=(f*w-c*S-g*m)*P,t[12]=(l*E-a*R-h*O)*P,t[13]=(s*R-r*E+n*O)*P,t[14]=(v*d-y*N-z*m)*P,t[15]=(c*N-f*d+p*m)*P,t):null}function Ja(t,e,s){var r=e[0],n=e[1],o=e[2],a=e[3],l=e[4],h=e[5],u=e[6],c=e[7],f=e[8],p=e[9],g=e[10],y=e[11],v=e[12],z=e[13],x=e[14],m=e[15],d=s[0],w=s[1],N=s[2],S=s[3];return t[0]=d*r+w*l+N*f+S*v,t[1]=d*n+w*h+N*p+S*z,t[2]=d*o+w*u+N*g+S*x,t[3]=d*a+w*c+N*y+S*m,d=s[4],w=s[5],N=s[6],S=s[7],t[4]=d*r+w*l+N*f+S*v,t[5]=d*n+w*h+N*p+S*z,t[6]=d*o+w*u+N*g+S*x,t[7]=d*a+w*c+N*y+S*m,d=s[8],w=s[9],N=s[10],S=s[11],t[8]=d*r+w*l+N*f+S*v,t[9]=d*n+w*h+N*p+S*z,t[10]=d*o+w*u+N*g+S*x,t[11]=d*a+w*c+N*y+S*m,d=s[12],w=s[13],N=s[14],S=s[15],t[12]=d*r+w*l+N*f+S*v,t[13]=d*n+w*h+N*p+S*z,t[14]=d*o+w*u+N*g+S*x,t[15]=d*a+w*c+N*y+S*m,t}function Pn(t,e,s){var r=s[0],n=s[1],o=s[2],a,l,h,u,c,f,p,g,y,v,z,x;return e===t?(t[12]=e[0]*r+e[4]*n+e[8]*o+e[12],t[13]=e[1]*r+e[5]*n+e[9]*o+e[13],t[14]=e[2]*r+e[6]*n+e[10]*o+e[14],t[15]=e[3]*r+e[7]*n+e[11]*o+e[15]):(a=e[0],l=e[1],h=e[2],u=e[3],c=e[4],f=e[5],p=e[6],g=e[7],y=e[8],v=e[9],z=e[10],x=e[11],t[0]=a,t[1]=l,t[2]=h,t[3]=u,t[4]=c,t[5]=f,t[6]=p,t[7]=g,t[8]=y,t[9]=v,t[10]=z,t[11]=x,t[12]=a*r+c*n+y*o+e[12],t[13]=l*r+f*n+v*o+e[13],t[14]=h*r+p*n+z*o+e[14],t[15]=u*r+g*n+x*o+e[15]),t}function a2(t,e,s){var r=s[0],n=s[1],o=s[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function cd(t,e,s){var r=Math.sin(s),n=Math.cos(s),o=e[4],a=e[5],l=e[6],h=e[7],u=e[8],c=e[9],f=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+u*r,t[5]=a*n+c*r,t[6]=l*n+f*r,t[7]=h*n+p*r,t[8]=u*n-o*r,t[9]=c*n-a*r,t[10]=f*n-l*r,t[11]=p*n-h*r,t}function fd(t,e,s){var r=Math.sin(s),n=Math.cos(s),o=e[0],a=e[1],l=e[2],h=e[3],u=e[8],c=e[9],f=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-u*r,t[1]=a*n-c*r,t[2]=l*n-f*r,t[3]=h*n-p*r,t[8]=o*r+u*n,t[9]=a*r+c*n,t[10]=l*r+f*n,t[11]=h*r+p*n,t}function pd(t,e,s){var r=Math.sin(s),n=Math.cos(s),o=e[0],a=e[1],l=e[2],h=e[3],u=e[4],c=e[5],f=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+u*r,t[1]=a*n+c*r,t[2]=l*n+f*r,t[3]=h*n+p*r,t[4]=u*n-o*r,t[5]=c*n-a*r,t[6]=f*n-l*r,t[7]=p*n-h*r,t}function l2(t,e,s){var r=e[0],n=e[1],o=e[2],a=e[3],l=r+r,h=n+n,u=o+o,c=r*l,f=r*h,p=r*u,g=n*h,y=n*u,v=o*u,z=a*l,x=a*h,m=a*u;return t[0]=1-(g+v),t[1]=f+m,t[2]=p-x,t[3]=0,t[4]=f-m,t[5]=1-(c+v),t[6]=y+z,t[7]=0,t[8]=p+x,t[9]=y-z,t[10]=1-(c+g),t[11]=0,t[12]=s[0],t[13]=s[1],t[14]=s[2],t[15]=1,t}function h2(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function u2(t,e){var s=e[0],r=e[1],n=e[2],o=e[4],a=e[5],l=e[6],h=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(s,r,n),t[1]=Math.hypot(o,a,l),t[2]=Math.hypot(h,u,c),t}function c2(t,e,s,r){var n=e[0],o=e[1],a=e[2],l=e[3],h=n+n,u=o+o,c=a+a,f=n*h,p=n*u,g=n*c,y=o*u,v=o*c,z=a*c,x=l*h,m=l*u,d=l*c,w=r[0],N=r[1],S=r[2];return t[0]=(1-(y+z))*w,t[1]=(p+d)*w,t[2]=(g-m)*w,t[3]=0,t[4]=(p-d)*N,t[5]=(1-(f+z))*N,t[6]=(v+x)*N,t[7]=0,t[8]=(g+m)*S,t[9]=(v-x)*S,t[10]=(1-(f+y))*S,t[11]=0,t[12]=s[0],t[13]=s[1],t[14]=s[2],t[15]=1,t}function f2(t,e){var s=e[0],r=e[1],n=e[2],o=e[3],a=s+s,l=r+r,h=n+n,u=s*a,c=r*a,f=r*l,p=n*a,g=n*l,y=n*h,v=o*a,z=o*l,x=o*h;return t[0]=1-f-y,t[1]=c+x,t[2]=p-z,t[3]=0,t[4]=c-x,t[5]=1-u-y,t[6]=g+v,t[7]=0,t[8]=p+z,t[9]=g-v,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function p2(t,e,s,r,n){var o=1/Math.tan(e/2),a;return t[0]=o/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0?(a=1/(r-n),t[10]=(n+r)*a,t[14]=2*n*r*a):(t[10]=-1,t[14]=-2*r),t}var d2=p2;function dd(t,e,s,r){var n,o,a,l,h,u,c,f,p,g,y=e[0],v=e[1],z=e[2],x=r[0],m=r[1],d=r[2],w=s[0],N=s[1],S=s[2];return Math.abs(y-w)<_a&&Math.abs(v-N)<_a&&Math.abs(z-S)<_a?tu(t):(c=y-w,f=v-N,p=z-S,g=1/Math.hypot(c,f,p),c*=g,f*=g,p*=g,n=m*p-d*f,o=d*c-x*p,a=x*f-m*c,g=Math.hypot(n,o,a),g?(g=1/g,n*=g,o*=g,a*=g):(n=0,o=0,a=0),l=f*a-p*o,h=p*n-c*a,u=c*o-f*n,g=Math.hypot(l,h,u),g?(g=1/g,l*=g,h*=g,u*=g):(l=0,h=0,u=0),t[0]=n,t[1]=l,t[2]=c,t[3]=0,t[4]=o,t[5]=h,t[6]=f,t[7]=0,t[8]=a,t[9]=u,t[10]=p,t[11]=0,t[12]=-(n*y+o*v+a*z),t[13]=-(l*y+h*v+u*z),t[14]=-(c*y+f*v+p*z),t[15]=1,t)}function Ur(){var t=new Yi(3);return Yi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function m2(t){var e=t[0],s=t[1],r=t[2];return Math.hypot(e,s,r)}function Fo(t,e,s){var r=new Yi(3);return r[0]=t,r[1]=e,r[2]=s,r}function v2(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function y2(t,e){var s=e[0],r=e[1],n=e[2],o=s*s+r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function wc(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function bn(t,e,s){var r=e[0],n=e[1],o=e[2],a=s[0],l=s[1],h=s[2];return t[0]=n*h-o*l,t[1]=o*a-r*h,t[2]=r*l-n*a,t}var x2=m2;(function(){var t=Ur();return function(e,s,r,n,o,a){var l,h;for(s||(s=3),r||(r=0),n?h=Math.min(n*s+r,e.length):h=e.length,l=r;l<h;l+=s)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],o(t,t,a),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}})();function md(){var t=new Yi(4);return Yi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function g2(t){var e=new Yi(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function gi(t,e,s,r){var n=new Yi(4);return n[0]=t,n[1]=e,n[2]=s,n[3]=r,n}function vd(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t[3]=e[3]+s[3],t}function yd(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t[2]=e[2]-s[2],t[3]=e[3]-s[3],t}function w2(t,e,s){return t[0]=e[0]*s[0],t[1]=e[1]*s[1],t[2]=e[2]*s[2],t[3]=e[3]*s[3],t}function z2(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t}function N2(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Sr(t,e){var s=e[0],r=e[1],n=e[2],o=e[3],a=s*s+r*r+n*n+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=s*a,t[1]=r*a,t[2]=n*a,t[3]=o*a,t}function Ps(t,e,s){var r=e[0],n=e[1],o=e[2],a=e[3];return t[0]=s[0]*r+s[4]*n+s[8]*o+s[12]*a,t[1]=s[1]*r+s[5]*n+s[9]*o+s[13]*a,t[2]=s[2]*r+s[6]*n+s[10]*o+s[14]*a,t[3]=s[3]*r+s[7]*n+s[11]*o+s[15]*a,t}(function(){var t=md();return function(e,s,r,n,o,a){var l,h;for(s||(s=4),r||(r=0),n?h=Math.min(n*s+r,e.length):h=e.length,l=r;l<h;l+=s)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],o(t,t,a),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}})();function tl(){var t=new Yi(4);return Yi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function S2(t,e,s){s=s*.5;var r=Math.sin(s);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(s),t}function k2(t,e,s){var r=e[0],n=e[1],o=e[2],a=e[3],l=s[0],h=s[1],u=s[2],c=s[3];return t[0]=r*c+a*l+n*u-o*h,t[1]=n*c+a*h+o*l-r*u,t[2]=o*c+a*u+r*h-n*l,t[3]=a*c-r*l-n*h-o*u,t}function M2(t,e,s){s*=.5;var r=e[0],n=e[1],o=e[2],a=e[3],l=Math.sin(s),h=Math.cos(s);return t[0]=r*h+a*l,t[1]=n*h+o*l,t[2]=o*h-n*l,t[3]=a*h-r*l,t}function P2(t,e,s){s*=.5;var r=e[0],n=e[1],o=e[2],a=e[3],l=Math.sin(s),h=Math.cos(s);return t[0]=r*h-o*l,t[1]=n*h+a*l,t[2]=o*h+r*l,t[3]=a*h-n*l,t}function _2(t,e,s){s*=.5;var r=e[0],n=e[1],o=e[2],a=e[3],l=Math.sin(s),h=Math.cos(s);return t[0]=r*h+n*l,t[1]=n*h-r*l,t[2]=o*h+a*l,t[3]=a*h-o*l,t}function eh(t,e,s,r){var n=e[0],o=e[1],a=e[2],l=e[3],h=s[0],u=s[1],c=s[2],f=s[3],p,g,y,v,z;return g=n*h+o*u+a*c+l*f,g<0&&(g=-g,h=-h,u=-u,c=-c,f=-f),1-g>_a?(p=Math.acos(g),y=Math.sin(p),v=Math.sin((1-r)*p)/y,z=Math.sin(r*p)/y):(v=1-r,z=r),t[0]=v*n+z*h,t[1]=v*o+z*u,t[2]=v*a+z*c,t[3]=v*l+z*f,t}function Nr(t,e){var s=e[0],r=e[1],n=e[2],o=e[3],a=s*s+r*r+n*n+o*o,l=a?1/a:0;return t[0]=-s*l,t[1]=-r*l,t[2]=-n*l,t[3]=o*l,t}function xd(t,e){var s=e[0]+e[4]+e[8],r;if(s>0)r=Math.sqrt(s+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[n*3+n]&&(n=2);var o=(n+1)%3,a=(n+2)%3;r=Math.sqrt(e[n*3+n]-e[o*3+o]-e[a*3+a]+1),t[n]=.5*r,r=.5/r,t[3]=(e[o*3+a]-e[a*3+o])*r,t[o]=(e[o*3+n]+e[n*3+o])*r,t[a]=(e[a*3+n]+e[n*3+a])*r}return t}var la=g2,L2=gi,gd=Sr;(function(){var t=Ur(),e=Fo(1,0,0),s=Fo(0,1,0);return function(r,n,o){var a=wc(n,o);return a<-.999999?(bn(t,e,n),x2(t)<1e-6&&bn(t,s,n),y2(t,t),S2(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(bn(t,n,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,gd(r,r))}})();(function(){var t=tl(),e=tl();return function(s,r,n,o,a,l){return eh(t,r,a,l),eh(e,n,o,l),eh(s,t,e,2*l*(1-l)),s}})();(function(){var t=ud();return function(e,s,r,n){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-s[0],t[5]=-s[1],t[8]=-s[2],gd(e,xd(e,t))}})();const La=class zs{constructor(){oi(this,"_coord"),oi(this,"scale",e=>{const s=new zs;return z2(s._coord,this._coord,e),s}),oi(this,"dot",e=>wc(this.vec3(),e.vec3())),oi(this,"crossProduct",e=>{const s=Ur();return bn(s,this.vec3(),e.vec3()),zs.fromVec3(s)}),oi(this,"add",e=>{const s=new zs;return vd(s._coord,this._coord,e._coord),s}),oi(this,"multiply",e=>{const s=new zs;return w2(s._coord,this._coord,e._coord),s}),this._coord=gi(0,0,0,0)}static get bufferSize(){return 4*4}static fromValues(e,s,r){const n=new zs;return n._coord=gi(e,s,r,0),n}static fromVec4(e){const s=new zs,r=e[3]!==0?e[3]:1;return s._coord=gi(e[0]/r,e[1]/r,e[2]/r,0),s}static fromVec3(e){const s=new zs;return s._coord=gi(e[0],e[1],e[2],0),s}static fromPoints(e,s){const r=new zs;return yd(r._coord,e.vec4(),s.vec4()),r}static fromPoint(e){const s=new zs;return s._coord=[...e.triplet,0],s}toString(){return`Vector(${this.x}, ${this.y}, ${this.z})`}map(e){const s=new zs;return e.isFrame()?Ps(s._coord,this._coord,e.inverseMatrix):Ps(s._coord,this._coord,e.directMatrix),s}unMap(e){const s=new zs;return e.isFrame()?Ps(s._coord,this._coord,e.directMatrix):Ps(s._coord,this._coord,e.inverseMatrix),s}relative(e){return this.map(e)}absolute(e){return this.unMap(e)}isUnitVector(){return!1}get x(){return this._coord[0]}get y(){return this._coord[1]}get z(){return this._coord[2]}get triplet(){return[this.x,this.y,this.z]}get coordinates(){return[...this._coord.values()]}buffer(){return new Float32Array(this.coordinates)}get length(){const e=this._coord[0],s=this._coord[1],r=this._coord[2];return Math.sqrt(e*e+s*s+r*r)}get lengthSquare(){const e=this._coord[0],s=this._coord[1],r=this._coord[2];return e*e+s*s+r*r}vec3(){return Fo(this.x,this.y,this.z)}vec4(){return gi(this.x,this.y,this.z,0)}};oi(La,"crossProduct",(t,e)=>{const s=Ur();return bn(s,t.vec3(),e.vec3()),La.fromVec3(s)}),oi(La,"dot",(t,e)=>wc(t.vec3(),e.vec3()));let Ht=La;class ot{constructor(){oi(this,"_coord"),this._coord=gi(0,0,0,1)}static get bufferSize(){return 4*4}static origin(){return new ot}static fromValues(e,s,r,n=1){const o=new ot;return o._coord=gi(e/n,s/n,r/n,1),o}static fromVector(e){const s=new ot;return s._coord=gi(e.x,e.y,e.z,1),s}static fromVec4(e){const s=new ot,r=e[3]!==0?e[3]:1;return s._coord=gi(e[0]/r,e[1]/r,e[2]/r,1),s}static fromVec3(e){const s=new ot;return s._coord=gi(e[0],e[1],e[2],1),s}toString(){return`Point(${this.x}, ${this.y}, ${this.z})`}map(e){const s=new ot;return e.isFrame()?Ps(s._coord,this._coord,e.inverseMatrix):Ps(s._coord,this._coord,e.directMatrix),s}unMap(e){const s=new ot;return e.isFrame()?Ps(s._coord,this._coord,e.directMatrix):Ps(s._coord,this._coord,e.inverseMatrix),s}relative(e){return this.map(e)}absolute(e){return this.unMap(e)}static relative(e,s){return e.map(s)}static absolute(e,s){return e.unMap(s)}subtract(e){const s=md();return yd(s,this._coord,e._coord),Ht.fromVec4(s)}scale(e){const s=Ur();return v2(s,this.vec3(),e),ot.fromVec3(s)}add(e){const s=new ot;return vd(s._coord,this._coord,e.vec4()),s}isPoint(){return!0}get x(){return this._coord[0]}get y(){return this._coord[1]}get z(){return this._coord[2]}get coordinates(){return[...this._coord.values()]}get triplet(){return[this.x,this.y,this.z]}buffer(){return new Float32Array(this.coordinates)}vec3(){return Fo(this.x,this.y,this.z)}vec4(){return gi(this.x,this.y,this.z,1)}}const eu=class tr{constructor(){oi(this,"_coord"),this._coord=gi(1,1,1,0)}static get bufferSize(){return 4*4}static fromVector(e){const s=new tr;return s._coord=gi(e.x,e.y,e.z,0),Sr(s._coord,s._coord),s}static fromPoints(e,s){const r=new tr;return r._coord=gi(e.x-s.x,e.y-s.y,e.z-s.z,0),Sr(r._coord,r._coord),r}fromPoint(e){return tr.fromValues(...e.triplet)}static fromValues(e,s,r){const n=gi(e,s,r,0);return Sr(n,n),tr.fromVec4(n)}static fromVec4(e){const s=new tr,r=e[3]!==0?e[3]:1;return s._coord=gi(e[0]/r,e[1]/r,e[2]/r,0),Sr(s._coord,s._coord),s}static fromVec3(e){const s=new tr;return s._coord=gi(e[0],e[1],e[2],0),Sr(s._coord,s._coord),s}toString(){return`UnitVector(${this.x}, ${this.y}, ${this.z})`}map(e){const s=new tr;return e.isFrame()?Ps(s._coord,this._coord,e.inverseMatrix):Ps(s._coord,this._coord,e.directMatrix),Sr(s._coord,s._coord),s}unMap(e){const s=new tr;return e.isFrame()?Ps(s._coord,this._coord,e.directMatrix):Ps(s._coord,this._coord,e.inverseMatrix),Sr(s._coord,s._coord),s}relative(e){return this.map(e)}absolute(e){return this.unMap(e)}invert(){const e=new tr;return N2(e._coord,this._coord),e}scale(e){return Ht.fromValues(this.x*e,this.y*e,this.z*e)}add(e){return Ht.fromValues(this.x+e.x,this.y+e.y,this.z+e.z)}isUnitVector(){return!0}get x(){return this._coord[0]}get y(){return this._coord[1]}get z(){return this._coord[2]}get length(){return 1}get coordinates(){return[...this._coord.values()]}get triplet(){return[this.x,this.y,this.z]}crossProduct(e){return Ht.fromVec3(this.triplet).crossProduct(e)}buffer(){return new Float32Array(this.coordinates)}vec3(){return Fo(this.x,this.y,this.z)}};oi(eu,"crossProduct",(t,e)=>{const s=Ur();return bn(s,t.vec3(),e.vec3()),eu.fromVec3(s)});let gt=eu;const $f=t=>t.isUnitVector();class Vt{constructor(){oi(this,"_direct"),oi(this,"_inverse"),oi(this,"_isIdentity",!0),this._direct=fr(),this._inverse=fr(),Ke(this._inverse,this._direct)}static get bufferSize(){return 16*4}static world(){return new Vt}static identity(){return new Vt}static fromRotation(e){const s=new Vt;return f2(s._direct,e.quat),Ke(s._inverse,s._direct),s._isIdentity=!1,s}static fromMat4(e){const s=new Vt,r=fr();return Ke(r,e),s._direct=rr(e),s._inverse=rr(r),s._isIdentity=!1,s}static lookAt(e,s,r){const n=new Vt;return dd(n._direct,e.vec3(),s.vec3(),r.vec3()),Ke(n._inverse,n._direct),n._isIdentity=!1,n}static perspective(e,s,r,n){const o=new Vt;return d2(o._direct,e,s,r,n),Ke(o._inverse,o._direct),o._isIdentity=!1,o}static invert(e){const s=new Vt;return s._direct=rr(e._inverse),s._inverse=rr(e._direct),s._isIdentity=!1,s}static translation(e,s,r){const n=new Vt;return Pn(n._direct,n._direct,[e,s,r]),Ke(n._inverse,n._direct),n._isIdentity=!1,n}static move(e){const s=new Vt;return Pn(s._direct,s._direct,e.vec3()),Ke(s._inverse,s._direct),s._isIdentity=!1,s}static rotationX(e){const s=new Vt;return cd(s._direct,s._direct,e),Ke(s._inverse,s._direct),s._isIdentity=!1,s}static rotationY(e){const s=new Vt;return fd(s._direct,s._direct,e),Ke(s._inverse,s._direct),s._isIdentity=!1,s}static rotationZ(e){const s=new Vt;return pd(s._direct,s._direct,e),Ke(s._inverse,s._direct),s._isIdentity=!1,s}static scale(e,s,r){const n=new Vt;return a2(n._direct,n._direct,[e,s,r]),Ke(n._inverse,n._direct),n._isIdentity=!1,n}static rotoTranslation(e,s){const r=new Vt;return l2(r._direct,e.quat,s.vec3()),Ke(r._inverse,r._direct),r._isIdentity=!1,r}static fromRotationTranslationScale(e,s,r){const n=new Vt;return c2(n._direct,e.quat,s.vec3(),r.vec3()),Ke(n._inverse,n._direct),n._isIdentity=!1,n}isFrame(){return!1}get values(){return this._direct.values()}get inverseValues(){return this._inverse.values()}buffer(){return new Float32Array(this._direct.values())}inverseBuffer(){return new Float32Array(this._inverse.values())}apply(e){return e.map(this)}compose(e){const s=new Vt,{_direct:r,_inverse:n}=this,{_direct:o,_inverse:a}=e;return Ja(s._direct,o,r),Ja(s._inverse,n,a),s._isIdentity=!1,s}transpose(){const e=new Vt;return o2(e._direct,this._direct),Ke(e._inverse,e._direct),e._isIdentity=!1,e}translation(e,s,r){const n=Vt.translation(e,s,r);return this.compose(n)}rotationX(e){const s=Vt.rotationX(e);return this.compose(s)}rotationY(e){const s=Vt.rotationY(e);return this.compose(s)}rotationZ(e){const s=Vt.rotationZ(e);return this.compose(s)}scale(e,s,r){const n=Vt.scale(e,s,r);return this.compose(n)}invert(){const e=new Vt;return e._direct=rr(this._inverse),e._inverse=rr(this._direct),e._isIdentity=this._isIdentity,e}get directMatrix(){return this._direct}get inverseMatrix(){return this._inverse}get isIdentity(){return this._isIdentity}get scaleVector(){const e=Ur();return u2(e,this._direct),Ht.fromValues(e[0],e[1],e[2])}get positionVector(){const e=Ur();return h2(e,this._direct),Ht.fromValues(e[0],e[1],e[2])}}const iu=class er{constructor(){oi(this,"_direct"),oi(this,"_inverse"),this._direct=fr(),this._inverse=fr(),tu(this._direct),tu(this._inverse)}static bufferSize(){return 16*4}static world(){return new er}static translation(e){const s=new er,r=fr();return Pn(r,r,e.vec3()),s._direct=r,Ke(s._inverse,s._direct),s}static rotationX(e,s){const r=new er,n=fr();return Pn(n,n,e.vec3()),cd(n,n,s),r._direct=n,Ke(r._inverse,r._direct),r}static rotationY(e,s){const r=new er,n=fr();return Pn(n,n,e.vec3()),fd(n,n,s),r._direct=n,Ke(r._inverse,r._direct),r}static rotationZ(e,s){const r=new er,n=fr();return Pn(n,n,e.vec3()),pd(n,n,s),r._direct=n,Ke(r._inverse,r._direct),r}static lookAt(e,s,r){const n=new er;return dd(n._inverse,e.vec3(),s.vec3(),r.vec3()),Ke(n._direct,n._inverse),n}isFrame(){return!0}toString(){return`Frame(${this.origin}, ${this.i}, ${this.j}, ${this.k})`}map(e){return this.compose(e)}unMap(e){return this.compose(e.invert())}compose(e){const s=new er,{_direct:r}=this,{_direct:n}=e;return Ja(s._direct,n,r),Ke(s._inverse,s._direct),s}toTransform(){return Vt.fromMat4(this._inverse)}invert(){const e=new er;return e._direct=rr(this._inverse),e._inverse=rr(this._direct),e}get directMatrix(){return rr(this._direct)}get inverseMatrix(){return rr(this._inverse)}get i(){return gt.fromValues(this._direct[0],this._direct[1],this._direct[2])}get j(){return gt.fromValues(this._direct[4],this._direct[5],this._direct[6])}get k(){return gt.fromValues(this._direct[8],this._direct[9],this._direct[10])}get o(){return ot.fromValues(this._direct[12],this._direct[13],this._direct[14],this._direct[15])}get origin(){return ot.fromValues(this._inverse[12],this._inverse[13],this._inverse[14],this._inverse[15])}relative(e){if(e&&V2(e)){const s=new er;return Ja(s._direct,e.inverseMatrix,this.directMatrix),Ke(s._inverse,s._direct),s}return e.relative(this)}absolute(e){return e.compose(this)}};oi(iu,"from2Vectors",(t,e,s)=>{const r=new iu,n=$f(e)?e:gt.fromVector(e),o=gt.crossProduct(n,$f(s)?s:gt.fromVector(s)),a=[...gt.crossProduct(o,n).coordinates,...o.coordinates,...n.coordinates,...t.coordinates];return r._direct=n2(...a),Ke(r._inverse,r._direct),r});let su=iu;const V2=t=>t&&t.isFrame!==void 0?t.isFrame():!1;let En=class Hi{constructor(){oi(this,"_direct"),oi(this,"_inverse"),this._direct=tl(),this._inverse=tl()}static identity(){return new Hi}static fromValues(e,s,r,n){const o=new Hi;return o._direct=L2(e,s,r,n),Nr(o._inverse,o._direct),o}static fromAngles(e,s,r){return Hi.rotationX(e).rotateY(s).rotateZ(r)}static fromQuat(e){const s=new Hi;return s._direct=la(e),Nr(s._inverse,s._direct),s}static fromArray(e){const s=new Hi;return s._direct=la(e),Nr(s._inverse,s._direct),s}static fromTransform(e){const s=ud();r2(s,e.directMatrix);const r=new Hi;return r._direct=xd(r._direct,s),Nr(r._inverse,r._direct),r}static rotationX(e){const s=new Hi;return M2(s._direct,s._direct,e),Nr(s._inverse,s._direct),s}static rotationY(e){const s=new Hi;return P2(s._direct,s._direct,e),Nr(s._inverse,s._direct),s}static rotationZ(e){const s=new Hi;return _2(s._direct,s._direct,e),Nr(s._inverse,s._direct),s}rotateX(e){return this.compose(Hi.rotationX(e))}rotateY(e){return this.compose(Hi.rotationY(e))}rotateZ(e){return this.compose(Hi.rotationZ(e))}inverse(){const e=new Hi;return e._direct=la(this._inverse),e._inverse=la(this._direct),e}compose(e){const s=new Hi;return k2(s._direct,this._direct,e._direct),Nr(s._inverse,s._direct),s}get quat(){return this._direct}};const sr=t=>t/180*Math.PI;var I2=Object.defineProperty,C2=(t,e,s)=>e in t?I2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,jt=(t,e,s)=>(C2(t,typeof e!="symbol"?e+"":e,s),s);const Gf=()=>{let t=0,e=performance.now(),s=0;const r=[];return{getFPS:()=>r.reduce((n,o)=>n+o,0)/r.length,measureFPS:()=>{const n=performance.now();return t=n-e,t<=1?r[s]:(s=(s+1)%10,r[s]=1e3/t,e=n,t)},getLastTimeSpan:()=>t}},T2=async({device:t},e)=>{const s=t.createShaderModule({code:e});return(await s.getCompilationInfo()).messages.forEach(r=>{let n=r.message;r.lineNum&&(n=`Line ${r.lineNum}:${r.linePos} - "${e.substr(r.offset,r.length+40)}"
`+r.message),console.error("WGSL error: ",n)}),s},b2=t=>{const e=3*Vt.bufferSize+8+4*(2*Ht.bufferSize)+4*(Ht.bufferSize+ot.bufferSize),s=4,r=s*(2*Ht.bufferSize)+s*(Ht.bufferSize+ot.bufferSize)+4*4+2*4,n=t.device.createBuffer({label:"TransBuffer",size:e+e%16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),o=t.device.createBuffer({label:"LightBuffer",size:r+r%16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),a=[{binding:0,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}],l=t.device.createBindGroupLayout({label:"transformations",entries:a}),h=[{binding:0,resource:{buffer:n}},{binding:1,resource:{buffer:o}}],u=t.device.createBindGroup({label:"SceneData",layout:l,entries:h});return[l,u,[n,o]]},E2=t=>{const e=2*Vt.bufferSize,s=t.device.createBuffer({label:"TransBuffer",size:e+e%16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),r=[{binding:0,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}],n=t.device.createBindGroupLayout({label:"modelTransf",entries:r}),o=[{binding:0,resource:{buffer:s}}],a=t.device.createBindGroup({label:"SceneData",layout:n,entries:o});return[n,a,[s]]},D2=t=>{const e=t.device.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),s=t.device.createBuffer({size:4*4,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),r=[{binding:0,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}],n=t.device.createBindGroupLayout({label:"color",entries:r}),o=[{binding:0,resource:{buffer:e}},{binding:1,resource:{buffer:s}}],a=t.device.createBindGroup({label:"color",layout:n,entries:o});return[n,a,[e,s]]},A2=(t,e,s)=>{const{device:r}=t,n={addressModeU:"repeat",addressModeV:"repeat",magFilter:"linear",minFilter:"linear",mipmapFilter:"linear",maxAnisotropy:1},o=r.createSampler(n),a={addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",magFilter:"linear",minFilter:"linear",mipmapFilter:"linear",maxAnisotropy:1},l=r.createSampler(a),h=e.map(g=>g.view),u=[...h.map((g,y)=>({binding:y,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}})),{binding:4,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}}];s&&u.push({binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}},{binding:6,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}});const c=t.device.createBindGroupLayout({label:"texture",entries:u}),f=[...h.map((g,y)=>({binding:y,resource:g})),{binding:4,resource:o}];s&&f.push({binding:5,resource:s.view},{binding:6,resource:l});const p=t.device.createBindGroup({label:"texture",layout:c,entries:f});return[c,p]},F2=(t,e,s)=>{const{device:r}=t,[n,o,a]=b2(t),[l,h,u]=D2(t),[c,f,p]=E2(t),g=e.length>0||s!==void 0,[y,v]=g?A2(t,e,s):[void 0,void 0],z=y?[n,l,c,y]:[n,l,c],x={sceneGroup:o,colorGroup:h,modelGroup:f,texturesGroup:v},m={sceneBuffers:a,colorBuffers:u,modelBuffers:p};return[r.createPipelineLayout({bindGroupLayouts:z}),x,m]},ih=(t,e,s,r)=>{const{device:n,format:o}=t,a=s.map(l=>{const[h,u,c]=F2(t,l.materials,r),f={label:l.label,layout:h,multisample:{count:1},vertex:{module:e,entryPoint:l.vertexShader,buffers:[l.bufferLayout]},fragment:{module:e,entryPoint:l.fragmentShader,targets:[{format:o,blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"}}}]},primitive:{topology:l.primitives,cullMode:l.cullMode},depthStencil:{depthWriteEnabled:l.fragmentShader!=="fragmentEnvironmentShader",depthCompare:l.fragmentShader==="fragmentEnvironmentShader"?"always":"less",format:"depth24plus"}},p=n.createRenderPipeline(f),g={...f,label:`${l.label}-alt`,primitive:{topology:l.primitives==="line-list"?l.primitives:"line-strip",cullMode:"none"}},y=n.createRenderPipeline(g);return[l.id,{id:l.id,type:l.label,pipeline:p,altPipeline:y,geoRenderable:l,uniformBuffers:c,bindGroups:u}]});return new Map(a)},R2=(t,e)=>{let s="none",r=[0,0],n=[0,0],o=[0,0];t.addEventListener("contextmenu",a=>{a.preventDefault()}),t.addEventListener("wheel",a=>{a.ctrlKey?e.tilt(a.deltaY):e.zoom(a.deltaY)}),t.addEventListener("pointerdown",a=>{t.setPointerCapture(a.pointerId),r=[a.offsetX,a.offsetY],n=[0,0],o=r,s=`${a.ctrlKey?"ctrl-":""}mouse-${a.button}`,e.move(s,{origin:r,direction:n},o)}),t.addEventListener("pointermove",a=>{if(s==="none")return;const l=[a.offsetX,a.offsetY];n=[l[0]-o[0],l[1]-o[1]],o=l,e.move(s,{origin:r,direction:n},o)}),t.addEventListener("pointerup",a=>{t.releasePointerCapture(a.pointerId);const l=[a.offsetX,a.offsetY];n=[l[0]-r[0],l[1]-r[1]],n[0]<=.9&&n[1]<=.9&&e.click("none",l),e.move("none",{origin:r,direction:n},l),s="none"})},O2=(t,e,s=GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST)=>{const r=t.createBuffer({size:e.byteLength,usage:s,mappedAtCreation:!0});return new Float32Array(r.getMappedRange()).set(e),r.unmap(),r},Hf=(t,e,s)=>{const{canvas:r}=t,n=Y2(window.getComputedStyle(r).backgroundColor);return{colorAttachments:[{view:e,clearValue:n,loadOp:"clear",storeOp:"store"}],depthStencilAttachment:{view:s,depthClearValue:1,depthStoreOp:"store",depthLoadOp:"clear"}}},U2=async t=>{const e=await navigator.gpu.requestAdapter({powerPreference:"high-performance"});if(!e)throw new Error("WebGPU:adapter is NOT available!");const s=await e.requestDevice();if(!s)throw new Error("WebGPU:device is NOT available!");const r=t.getContext("webgpu");if(!r)throw new Error("WebGPU:context from instantiated Canvas not available!");const n=navigator.gpu.getPreferredCanvasFormat();return r.configure({device:s,format:n,usage:GPUTextureUsage.RENDER_ATTACHMENT,alphaMode:"opaque"}),console.info("WegGPU: maxBindGroups:",s.limits.maxBindGroups),{context:r,device:s,canvas:t,format:n}},B2=t=>typeof t=="string",j2=(t,[e,s],r)=>({view:r&&r.view?r.view(t.view):Vt.lookAt(ot.fromValues(-5,-5,-5),ot.fromValues(0,0,0),gt.fromValues(0,0,1)),projection:r&&r.projection?r.projection(t.projection):Vt.perspective(Math.PI/5,e/s,.1,100)}),$2=t=>t!=null,G2=`const MAX_DIR_LIGHTS: u32 = 4;
const MAX_POINT_LIGHTS: u32 = 4;
const PI = 3.1415926535897932384626433832795;

struct DirectionalLight {
  dir: vec4<f32>,
  col: vec4<f32>,
};

struct PointLight {
  pos: vec4<f32>,  // Position of the light
  col: vec4<f32>,  // Color of the light
};

struct SceneData {
  view: mat4x4<f32>,
  invertView: mat4x4<f32>,
  projection: mat4x4<f32>,
};

struct ModelData {
  model: mat4x4<f32>,
  modelInverseTranspose: mat4x4<f32>,
};

struct SceneLights {
  dirLights: array<DirectionalLight, MAX_DIR_LIGHTS>,
  pointLights: array<PointLight, MAX_POINT_LIGHTS>,
  ambient: vec4<f32>,
  numDirLights: u32,
  numPointLights: u32,
};

struct ObjectData {
  model: mat4x4<f32>,
};

struct TextFragment {
  @builtin(position) position: vec4<f32>,
  @location(0) texCoord: vec2<f32>,
  @location(1) normal: vec3<f32>,
  @location(2) tangent: vec3<f32>,
  @location(3) pos: vec3<f32>,
  @location(4) eye: vec3<f32>,
  @location(5) viewZ: f32,
  // @location(5) worldTangent: vec3<f32>,
};

struct ColorFragment {
  @builtin(position) position: vec4<f32>,
  @location(0) normal: vec3<f32>,
  @location(1) tangent: vec3<f32>,
  @location(2) pos: vec3<f32>,
  @location(3) eye: vec3<f32>,
  @location(4) viewZ: f32,
};

struct ColorLineFragment {
  @builtin(position) position: vec4<f32>,
  @location(0) viewZ: f32,
  @location(1) targetZ: f32,
  @location(2) color: vec4<f32>,
};

struct ColorData {
    color: vec4<f32>,
};

struct MaterialProperties {
    alpha: f32,
    bumpIntensity: f32,
    bumpPrecision: f32, // Precision for bump mapping
};



@group(0) @binding(0) var<uniform> sceneData: SceneData;
@group(0) @binding(1) var<uniform> sceneLights: SceneLights;
@group(1) @binding(0) var<uniform> myColor: ColorData;
@group(1) @binding(1) var<uniform> materialProperties: MaterialProperties;
@group(2) @binding(0) var<uniform> myModel: ModelData;
@group(3) @binding(0) var myTexture0: texture_2d<f32>;
@group(3) @binding(1) var myTexture1: texture_2d<f32>;
@group(3) @binding(2) var myTexture2: texture_2d<f32>;
@group(3) @binding(3) var myTexture3: texture_2d<f32>;
@group(3) @binding(4) var mySampler: sampler;
@group(3) @binding(5) var environmentTexture: texture_2d<f32>;
@group(3) @binding(6) var environmentSampler: sampler;

/**
  * Computes the diffuse color for a given point in the scene.
  *
  * @param eye The position of the camera.
  * @param pos The position of the point in the scene.
  * @param normal The normal of the point in the scene.
  * @param sceneLights The lights in the scene.
  * @return The diffuse color for the point.
  */
fn computeDiffuseColor(
    eye: vec3<f32>,
    pos: vec3<f32>,
    normal: vec3<f32>,
    sceneLights: SceneLights) -> vec3<f32> {
  var diffuse: vec3<f32> = sceneLights.ambient.rgb;
  for (var i: u32 = 0; i < sceneLights.numDirLights; i = i + 1) {
    if (sceneLights.dirLights[i].col.a == 0.0) {
      continue;
    }
    let lightDir: vec3<f32> = -normalize(sceneLights.dirLights[i].dir.xyz); //
    let lightColor: vec3<f32> = sceneLights.dirLights[i].col.rgb;
    var NdotL: f32 = max(dot(normal, lightDir), 0);
    let diffuseColor = NdotL * lightColor * sceneLights.dirLights[i].col.a; // Multiply by intensity

    diffuse = diffuse + diffuseColor;
  }
  for (var i: u32 = 0; i < sceneLights.numPointLights; i = i + 1) {
    if (sceneLights.pointLights[i].col.a == 0.0) {
        continue;
    }
    let dir = sceneLights.pointLights[i].pos.xyz - pos;
    let dist = length(dir);
    let attenuationRadius: f32 = 50.0; // Fixed attenuation radius
    let attenuation = 1.0 - clamp(pow( dist / attenuationRadius, 2.0), 0.0, 1.0 );

    let lightDir: vec3<f32> = normalize(dir);
    let lightColor: vec3<f32> = sceneLights.pointLights[i].col.rgb;
    var NdotL: f32 = max(dot(normal, lightDir), 0.0);
    let diffuseColor = NdotL * lightColor * sceneLights.pointLights[i].col.a; // Multiply by intensity

    diffuse = diffuse + diffuseColor * attenuation;
  }
  return clamp(diffuse, vec3<f32>(0, 0, 0), vec3<f32>(1.0, 1.0, 1.0));
}

/**
  * Computes the diffuse color for a given point in the scene.
  *
  * @param eye The position of the camera.
  * @param pos The position of the point in the scene.
  * @param normal The normal of the point in the scene.
  * @param sceneLights The lights in the scene.
  * @return The diffuse color for the point.
  */
fn computeSpecularColor(
    eye: vec3<f32>,
    pos: vec3<f32>,
    normal: vec3<f32>,
    sceneLights: SceneLights,
    surfaceColor: vec4<f32>
    ) -> vec3<f32> {
  var shininess: f32 = 12.0; // 92.0;
  var specular: vec3<f32> = vec3<f32>(0, 0, 0);
  let V = normalize(eye - pos); // Moved outside the loop
  for (var i: u32 = 0; i < sceneLights.numPointLights; i = i + 1) {
    if (sceneLights.pointLights[i].col.a == 0.0) {
      continue;
    }
    let intensity = sceneLights.pointLights[i].col.a; // Renamed 'power' to 'intensity' for clarity
    let dir = sceneLights.pointLights[i].pos.xyz - pos;
    let dist = length(dir);
    let attenuationRadius: f32 = 50.0; // Consistent with diffuse
    let attenuation = 1.0 - clamp(pow( dist / attenuationRadius, 2.0), 0.0, 1.0 );

    let lightDir: vec3<f32> = normalize(dir);
    let lightColor: vec3<f32> = sceneLights.pointLights[i].col.rgb;

    // Specular
    let R = normalize(reflect(-lightDir, normal));
    let specularIntensity = pow(max(dot(V, R), 0.0), shininess);
    let specularColor = specularIntensity * lightColor * intensity; // Multiply by intensity

    specular = specular + specularColor * attenuation;
  }

  return clamp(specular, vec3<f32>(0, 0, 0), vec3<f32>(1.0, 1.0, 1.0));
}


/**
  * Computes the distance from a point to a segment.
  *
  * @param point The point.
  * @param segmentStart The start of the segment.
  * @param segmentEnd The end of the segment.
  * @return The distance from the point to the segment.
  */
fn computeDistanceToSegment( point: vec3<f32>, segmentStart: vec3<f32>, segmentEnd: vec3<f32> ) -> f32 {
  let segment = segmentEnd - segmentStart;
  let segmentLength = length(segment);
  let segmentDirection = segment / segmentLength;
  let pointToStart = point - segmentStart;
  let projection = dot(pointToStart, segmentDirection);
  if (projection < 0.0) {
    return length(pointToStart);
  }
  if (projection > segmentLength) {
    return length(point - segmentEnd);
  }
  return length(pointToStart - projection * segmentDirection);
}

/**
 * Computes an attenuation factor based on the distance from the camera.
 * The attenuation is 1.0 for distances less than 50 units, and then
 * linearly decreases for distances between 50 and 850 units.
 *
 * @param d The distance from the camera.
 * @return The attenuation factor (0.0 to 1.0).
 */
fn computeDistanceToCameraAttenuation( d: f32 ) -> f32 {
  if ( d< 50 ) {
    return 1.0;
  }
  return 1 - clamp((d-49)/800 , 0.0, 1.0);
}

/**
 * Samples the environment texture using spherical projection.
 * Converts a 3D world direction vector to equirectangular texture coordinates
 * and samples the environment texture at infinite distance.
 *
 * @param worldDirection The 3D direction vector in world space
 * @return The environment color at the given direction
 */
fn sampleEnvironment(worldDirection: vec3<f32>) -> vec4<f32> {
  let dir = normalize(worldDirection);
  
  // Convert to spherical coordinates
  let phi = atan2(dir.z, dir.x);
  let theta = acos(dir.y);
  
  // Convert to equirectangular UV coordinates
  let u = (phi + PI) / (2.0 * PI);
  let v = theta / PI;
  
  return textureSample(environmentTexture, environmentSampler, vec2<f32>(u, v));
}

/**
 * Computes a normal perturbation vector for a grid-like bump effect.
 * This function simulates a grid pattern by perturbing the normal based on
 * the texture coordinates and predefined thickness and tilt values.
 *
 * @param stepU The step size for the U texture coordinate.
 * @param stepV The step size for the V texture coordinate.
 * @param tc The 2D texture coordinates (UV).
 * @param T The tangent vector of the surface.
 * @param B The bitangent vector of the surface.
 * @return The normal perturbation vector in tangent space.
 */
fn bumpGrid(stepU: f32, stepV: f32, tc: vec2<f32>, T: vec3<f32>, B: vec3<f32>  ) -> vec3<f32> {
  var ND = vec3<f32>(0,0,0);
  let tileDimU: f32 = 100.0 / stepU;
  let tileDimV: f32 = 100.0 / stepV;
  let normalTilt = 0.2;
  let tickness: f32 = 0.1;
  let uGrid =  (tc[0]*100 + tickness) % tileDimU;
  let vGrid =  (tc[1]*100 + tickness) % tileDimV;

  if ( uGrid < tickness ) {
    ND =  B * normalTilt;
  }
  else if ( uGrid < tickness * 2 ) {
    ND =  B * normalTilt * -1;
  }
  if ( vGrid < tickness ) {
    ND =  ND + T * normalTilt;
  }
  else if ( vGrid < tickness * 2 ) {
    ND =  ND + T * normalTilt * -1;
  }
  return ND;
}

/**
 * Computes a normal perturbation vector for a wave-like bump effect.
 * This function generates a wave pattern based on sine functions applied
 * to the texture coordinates, with configurable amplitude, frequency, and phase.
 *
 * @param tc The 2D texture coordinates (UV).
 * @param T The tangent vector of the surface.
 * @param B The bitangent vector of the surface.
 * @return The normal perturbation vector in tangent space.
 */
fn bumpWave(tc: vec2<f32>, T: vec3<f32>, B: vec3<f32>  ) -> vec3<f32> {
  // Constants for wave calculations
  let waveAmplitude1: f32 = 0.15;
  let waveFrequency1: f32 = PI * 90.0;
  let wavePhase1: f32 = 0.5;

  let waveAmplitude2: f32 = 0.05;
  let waveFrequency2: f32 = PI * 40.0;
  let wavePhase2: f32 = 1.0;

  let time: f32 = 0.0;

  // Calculate two sets of waves using both U and V texture coordinates
  let wave1U = waveAmplitude1 * sin(tc.x * waveFrequency1 + time + wavePhase1);
  let wave1V = waveAmplitude1 * cos(tc.y * waveFrequency1 + time + wavePhase1);

  let wave2U = waveAmplitude2 * sin(tc.x * waveFrequency2 + time + wavePhase2);
  let wave2V = waveAmplitude2 * cos((tc.y+tc.x) * waveFrequency2 + time + wavePhase2);

  // Combine the wave components to get the overall wave vector in the tangent space
  // let waveVector = vec2<f32>(wave1U + wave2U, wave1V + wave2V);

  return T * (wave1U + wave2U);

  // const step = PI * 10;
  // let delta = (
  //   sin(tc[0] * step)
  //   // (sin(tc[1] * 314) * 0.1)
  // ) * 0.3; // + sin(tc[1]*220.0) * 0.5;
  // return T * delta;
}

// ----------------------------------------------------------------------------------------------- Texture Shaders

@vertex
fn vertexTextureShader(
    @location(0) vertexPosition: vec3<f32>,
    @location(1) vertexNormal: vec3<f32>,
    @location(2) vertexTangent: vec3<f32>,
    @location(3) vertexTexCoord: vec2<f32>) -> TextFragment {
  var output: TextFragment;
  var vertex = myModel.model * vec4<f32>(vertexPosition, 1.0);
  var positionInViewSpace = sceneData.view * vertex;

  output.position = sceneData.projection * sceneData.view * vertex;
  output.texCoord = vec2<f32>(vertexTexCoord);
  output.normal = normalize((myModel.modelInverseTranspose * vec4<f32>(vertexNormal, 0.0)).xyz);
  output.tangent = normalize((myModel.modelInverseTranspose * vec4<f32>(vertexTangent, 0.0)).xyz);
  output.pos = vertex.xyz;
  output.eye = sceneData.invertView[3].xyz;
  output.viewZ = -positionInViewSpace.z;
  // output.worldTangent = normalize((modelMatrix * vec4(input.tangent, 0.0)).xyz);

  return output;
}

@fragment
fn fragmentTextureShader(in: TextFragment) -> @location(0) vec4<f32> {
  var N = normalize(in.normal);
  let T = normalize(in.tangent);
  let B = normalize(cross(N, T));
  var texColor: vec4<f32> = textureSample(myTexture0, mySampler, in.texCoord);
  let att: f32 = computeDistanceToCameraAttenuation(in.viewZ);

  // Normal mapping happen here
  // let ND = bumpGrid(6, in.texCoord, T, B);
  // let ND = bumpGrid(36, 18, in.texCoord, T, B);
  // N = normalize(N + ND);

  let diffuse: vec3<f32> = computeDiffuseColor( in.eye, in.pos, N, sceneLights );
  let specular: vec3<f32> = computeSpecularColor( in.eye, in.pos, N, sceneLights, texColor );

  let textMix = vec4<f32>(1.0 - materialProperties.alpha);
  let finalColor = mix(texColor, myColor.color, textMix); // mixed the two colors based on alpha.
  return clamp(
    vec4<f32>((finalColor.rgb * diffuse + specular) * att, max(finalColor.a, texColor.a)),
    vec4<f32>(0, 0, 0, 0.0), vec4<f32>(1.0, 1.0, 1.0, 1.0)
  );
}

@fragment
fn fragmentTextureBumpShader(in: TextFragment) -> @location(0) vec4<f32> {
  let texColor: vec4<f32> = textureSample(myTexture0, mySampler, in.texCoord);

  // Sample the bump map (just 1 channel since is a grayscale image)
  let heightCenter = textureSample(myTexture1, mySampler, in.texCoord).r;

  // Calculate the gradient of the height field
  let gradPrecision: f32 = materialProperties.bumpPrecision;
  let textDim = textureDimensions(myTexture1, 0);
  let texelSize = vec2<f32>(1.0 / f32(textDim.x), 1.0/ f32(textDim.y) ); // Assuming mip level 0
  let texelStartX = vec2<f32>(texelSize.x * gradPrecision, 0.0);
  let texelStartY = vec2<f32>(0.0, texelSize.y * gradPrecision);
  let heightLeft = textureSample(myTexture1, mySampler, in.texCoord - texelStartX);
  let heightRight = textureSample(myTexture1, mySampler, in.texCoord + texelStartX);
  let heightUp = textureSample(myTexture1, mySampler, in.texCoord + texelStartY);
  let heightDown = textureSample(myTexture1, mySampler, in.texCoord - texelStartY);

  let heightLeftVal = heightLeft.r + heightLeft.g + heightLeft.b;
  let heightRightVal = heightRight.r + heightRight.g + heightRight.b;
  let heightUpVal = heightUp.r + heightUp.g + heightUp.b;
  let heightDownVal = heightDown.r + heightDown.g + heightDown.b;


  // Gradient components
  let dU = (heightRightVal - heightLeftVal) / (  gradPrecision * gradPrecision * texelSize.x);
  let dV = (heightUpVal - heightDownVal) / ( gradPrecision * gradPrecision * texelSize.y) ;

  let gradientVector = vec3<f32>(dU* materialProperties.bumpIntensity, dV * materialProperties.bumpIntensity, 0.0);
  let N = normalize(in.normal);
  let T = normalize(in.tangent);
  let B = cross(N, T);
  let tangentSpaceNormal = vec3<f32>(gradientVector.x, gradientVector.y, 1.0);
  let newNormal = normalize(T * tangentSpaceNormal.x + B * tangentSpaceNormal.y + N * tangentSpaceNormal.z);
  let diffuse: vec3<f32> = computeDiffuseColor( in.eye, in.pos, newNormal, sceneLights );
  let specular: vec3<f32> = computeSpecularColor( in.eye, in.pos, newNormal, sceneLights, texColor );

  let att: f32 = computeDistanceToCameraAttenuation(in.viewZ);

  let textMix = vec4<f32>(1.0 - materialProperties.alpha);
  let finalColor = mix(texColor, myColor.color, textMix); // mixed the two colors based on alpha.
  return clamp(
    vec4<f32>((finalColor.rgb * diffuse + specular) * att, max(finalColor.a, texColor.a)),
    vec4<f32>(0, 0, 0, 0.0), vec4<f32>(1.0, 1.0, 1.0, 1.0)
  );
}


// ----------------------------------------------------------------------------------------------- Environment Shaders

struct EnvironmentFragment {
  @builtin(position) position: vec4<f32>,
  @location(0) worldDirection: vec3<f32>,
};

@vertex
fn vertexEnvironmentShader(
    @location(0) vertexPosition: vec3<f32>) -> EnvironmentFragment {
  var output: EnvironmentFragment;
  
  // Render fullscreen quad at far plane but inside NDC
  output.position = vec4<f32>(vertexPosition.xy, 0.999999, 1.0);
  
  // Convert clip space position to world direction
  // Inverse projection to get view space direction
  let invProj = vec4<f32>(vertexPosition.xy, 1.0, 1.0);
  let viewDir = vec4<f32>(invProj.xy / vec2<f32>(sceneData.projection[0][0], sceneData.projection[1][1]), -1.0, 0.0);
  
  // Transform to world space using inverse view matrix
  output.worldDirection = (sceneData.invertView * viewDir).xyz;
  
  return output;
}

@fragment
fn fragmentEnvironmentShader(in: EnvironmentFragment) -> @location(0) vec4<f32> {
  return sampleEnvironment(normalize(in.worldDirection));
}

// ----------------------------------------------------------------------------------------------- Color Shaders

@vertex
fn vertexColorShader(
    @location(0) vertexPosition: vec3<f32>,
    @location(1) vertexNormal: vec3<f32>,
    @location(2) vertexTangent: vec3<f32>,
    ) -> ColorFragment {
  var output: ColorFragment;
  var vertex = myModel.model * vec4<f32>(vertexPosition, 1.0);
  var positionInViewSpace = sceneData.view * vertex;
  var bias = 0.002 * positionInViewSpace.z;

  var biasedPositionInViewSpace = positionInViewSpace - vec4<f32>(0.0, 0.0, bias, 0.0);

  output.normal = normalize((myModel.modelInverseTranspose * vec4<f32>(vertexNormal, 0.0)).xyz);
  output.tangent = normalize((myModel.modelInverseTranspose * vec4<f32>(vertexTangent, 0.0)).xyz);
  output.position = sceneData.projection * sceneData.view * vertex;
  output.pos = vertex.xyz;
  output.eye = sceneData.invertView[3].xyz;
  output.viewZ = -biasedPositionInViewSpace.z;

  return output;
}

@fragment
fn fragmentColorShader(in: ColorFragment) -> @location(0) vec4<f32> {
  var N = normalize(in.normal);
  let T = normalize(in.tangent);
  let B = normalize(cross(N, T));

  let att: f32 =  computeDistanceToCameraAttenuation(in.viewZ);

  // Compute a normal delta based on a 10x10 grid
  // let ND = bumpGrid(6, in.texCoord, T, B);
  // N = normalize(N + ND);

  let diffuse: vec3<f32> = computeDiffuseColor( in.eye, in.pos, N, sceneLights );
  let specular: vec3<f32> = computeSpecularColor( in.eye, in.pos, N, sceneLights, myColor.color );

  return clamp(
    vec4<f32>((myColor.color.rgb * diffuse.rgb + specular) * att, myColor.color.a),
    vec4<f32>(0, 0, 0, 0.0), vec4<f32>(1.0, 1.0, 1.0, 1.0)
  );

}


@vertex
fn vertexLineShader(
  @location(0) vertexPosition: vec3<f32>,
  @location(1) vertexColor: vec4<f32>
) -> ColorLineFragment {
  var output: ColorLineFragment;
  var vertex = myModel.model * vec4<f32>(vertexPosition, 1.0);

  let eye  = vec4<f32>(sceneData.invertView[3].xyz, 1.0);

  let eyeInViewSpace = sceneData.view * eye;
  let positionInViewSpace = sceneData.view * vertex;
  let bias = 0.002 * positionInViewSpace.z;
  let biasedPositionInViewSpace = positionInViewSpace - vec4<f32>(0.0, 0.0, bias, 0.0);
  output.viewZ = -biasedPositionInViewSpace.z;
  output.targetZ = -eyeInViewSpace.z;
  output.position = sceneData.projection * biasedPositionInViewSpace;
  output.color = vertexColor;

  return output;
}


@fragment
fn fragmentLineShader(in: ColorLineFragment) -> @location(0) vec4<f32> {
  let att: f32 = computeDistanceToCameraAttenuation(in.viewZ);

  return vec4<f32>(in.color.rgb * att, in.color.a * att);
}
`,H2="",W2=t=>{const{canvas:e,context:s,device:r}=t;let[n,o]=[e.width,e.height];return new ResizeObserver(a=>{const{width:l,height:h}=a[0].contentRect;[n,o]=[Math.round(l),Math.round(h)]}).observe(e.parentElement),a=>{var l,h;if(n===e.width&&o===e.height){const f=s.getCurrentTexture(),p=a.colorAttachments;return p[0].view=f.createView({label:"ColorView"}),a}e.width=n,e.height=o,(l=t._colorTexture)==null||l.destroy(),(h=t._depthTexture)==null||h.destroy(),t._depthTexture=r.createTexture({label:"DepthTexture",sampleCount:1,size:[n,o,1],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT}),t._colorTexture=r.createTexture({label:"ColorTexture",size:{width:n,height:o,depthOrArrayLayers:1},sampleCount:1,format:t.format,usage:GPUTextureUsage.RENDER_ATTACHMENT});const u=a.colorAttachments;u[0].view=t._colorTexture.createView({label:"ColorView"});const c=a.depthStencilAttachment;return c.view=t._depthTexture.createView({label:"DepthView"}),a}};class zc{constructor(e,s,r,n){jt(this,"canvas"),jt(this,"context"),jt(this,"device"),jt(this,"format"),jt(this,"_handleOnRender"),jt(this,"_vertexCount",0),jt(this,"_activeRenderLoop",!1),jt(this,"_pipelineMode","default"),jt(this,"_shaderModule"),jt(this,"_pipelines",new Map),jt(this,"_transformations",{projection:Vt.identity(),view:Vt.identity()}),jt(this,"_cameraTransHandler"),jt(this,"_lightsHandler"),jt(this,"_modelHandlers",{}),jt(this,"_fps",Gf()),jt(this,"_rebuildViewTexture"),jt(this,"_colorTexture"),jt(this,"_depthTexture"),jt(this,"_ambientLight",[.3,.3,.3,1]),jt(this,"_dirLights",[{dir:gt.fromValues(0,0,1),col:[.4,.4,.4,0]},{dir:gt.fromValues(1,1,1),col:[.4,.3,.3,0]},{dir:gt.fromValues(1,0,0),col:[.5,.5,.5,0]},{dir:gt.fromValues(-1,-1,-1),col:[.3,.3,.3,0]}]),jt(this,"_pointLights",[{pos:ot.fromValues(-12,12,8),col:[.5,.5,.2,0]},{pos:ot.fromValues(12,12,8),col:[.4,.2,.2,0]},{pos:ot.fromValues(-12,-12,8),col:[.2,.2,.5,0]},{pos:ot.fromValues(12,-12,8),col:[.5,.1,.5,0]}]),jt(this,"_environmentMaterial"),jt(this,"render",()=>{const{device:o}=this;this._vertexCount=0,this._handleOnRender&&this._handleOnRender(this);let a=Hf(this,this._colorTexture.createView(),this._depthTexture.createView());this._rebuildViewTexture&&(a=this._rebuildViewTexture(a));const l=o.createCommandEncoder(),h=l.beginRenderPass(a),u=this._fps.getLastTimeSpan();this.updateLights(u),this.pipelines.filter(({geoRenderable:c})=>c.fragmentShader==="fragmentEnvironmentShader").forEach((c,f)=>{this.renderPipeline(c,f,h,u)}),this.pipelines.filter(({geoRenderable:c})=>c.colors[0][3]===1&&c.fragmentShader!=="fragmentEnvironmentShader").forEach((c,f)=>{this.renderPipeline(c,f,h,u)}),this.pipelines.filter(({geoRenderable:c})=>c.colors[0][3]<1&&c.fragmentShader!=="fragmentEnvironmentShader").forEach((c,f)=>{this.renderPipeline(c,f,h,u)}),h.end(),o.queue.submit([l.finish()])}),this.canvas=e,this.context=s,this.device=r,this.format=n,this._rebuildViewTexture=W2(this),this._colorTexture=r.createTexture({size:{width:e.width,height:e.height,depthOrArrayLayers:1},sampleCount:1,format:this.format,usage:GPUTextureUsage.RENDER_ATTACHMENT}),this._depthTexture=r.createTexture({label:"DepthTexture",sampleCount:1,size:[e.width,e.height,1],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.device.lost.then(()=>{console.log("WebGPU:device lost")})}get vertexCount(){return this._vertexCount}get fps(){return this._fps.getFPS()}get dirLights(){return this._dirLights}get pontLights(){return this._pointLights}get(...e){return e.map(s=>this._pipelines.get(s)).filter($2).map(s=>s.geoRenderable)}setAmbientLight(e){this._ambientLight=e}setLight(e,s,r){switch(e){case"directional":this._dirLights[s]=r;break;case"point":this._pointLights[s]=r;break}}static async build(e){return U2(e).then(({canvas:s,context:r,device:n,format:o})=>new zc(s,r,n,o))}setPipelineMode(e){this._pipelineMode=e}get pipelines(){return[...this._pipelines.values()]}getScene(){return[...this._pipelines.values()].map(({geoRenderable:e})=>e)}async setupShaders(e){if(this._shaderModule)return this;let s;if(B2(e))switch(e){case"standard-3d":s=G2;break;case"standard-2d":default:s=H2;break}else s=e.source;return this._shaderModule=await T2(this,s),this}setScene(e){if(!this._shaderModule)throw new Error("WebGPU:shader module is NOT available!");e.forEach(s=>{s.buildGpuBuffer(this)}),this._pipelines=ih(this,this._shaderModule,e,this._environmentMaterial),Hf(this,this._colorTexture.createView(),this._depthTexture.createView())}addToScene(e){if(!this._shaderModule)throw new Error("WebGPU:shader module is NOT available!");e.forEach(s=>{s.buildGpuBuffer(this)}),ih(this,this._shaderModule,e,this._environmentMaterial).forEach((s,r)=>{this._pipelines.set(r,s)})}removeFromScene(e){return this._pipelines.delete(e)}clearScene(){this._pipelines.clear()}setEnvironmentMaterial(e){if(this._environmentMaterial=e,this._pipelines.size>0&&this._shaderModule){const s=this.getScene();this._pipelines=ih(this,this._shaderModule,s,this._environmentMaterial)}}getEnvironmentMaterial(){return this._environmentMaterial}captureMouseMotion(e){R2(this.canvas,{move:(e==null?void 0:e.move)??((s,r,n)=>{}),click:(e==null?void 0:e.click)??((s,r)=>{}),zoom:(e==null?void 0:e.zoom)??(s=>{}),tilt:(e==null?void 0:e.tilt)??(s=>{})})}sceneIntoBuffer(e){const{device:s}=this,{projection:r,view:n}=this._transformations,o=n.invert();let a=0;s.queue.writeBuffer(e[0],a,n.buffer()),a+=Vt.bufferSize,s.queue.writeBuffer(e[0],a,o.buffer()),a+=Vt.bufferSize,s.queue.writeBuffer(e[0],a,r.buffer()),a+=Vt.bufferSize;let l=0;const h=new Float32Array(this._dirLights.flatMap(({dir:f,col:p})=>[...f.coordinates,...p]));s.queue.writeBuffer(e[1],l,h),l+=h.byteLength;const u=new Float32Array(this._pointLights.flatMap(({pos:f,col:p})=>[...f.coordinates,...p]));s.queue.writeBuffer(e[1],l,u),l+=u.byteLength;const c=new Float32Array(this._ambientLight);s.queue.writeBuffer(e[1],l,c),l+=c.byteLength,s.queue.writeBuffer(e[1],l,new Uint32Array([this._dirLights.length,this._pointLights.length]))}updateLights(e){if(!this._lightsHandler)return;const{dirLights:s,posLights:r}=this._lightsHandler;s&&s(e,this._dirLights),r&&r(e,this._pointLights)}onRender(e){this._handleOnRender=e}renderPipeline(e,s,r,n){const{pipeline:o,altPipeline:a,uniformBuffers:l,bindGroups:h,geoRenderable:u}=e,{device:c}=this;if(s===0&&(this.sceneIntoBuffer(l.sceneBuffers),r.setBindGroup(0,h.sceneGroup)),u.display==="none")return;const f=this._pipelineMode==="default"?o:a;r.setPipeline(f),this._modelHandlers[u.id]&&u.transform(n,this._modelHandlers[u.id]),c.queue.writeBuffer(l.modelBuffers[0],0,u.transformationData),r.setBindGroup(2,h.modelGroup),h.texturesGroup&&r.setBindGroup(3,h.texturesGroup),u.buffers.forEach((p,g)=>{const y=new Float32Array(u.colors[g]);c.queue.writeBuffer(l.colorBuffers[0],0,y),c.queue.writeBuffer(l.colorBuffers[1],0,new Float32Array([u.materialProperties.alpha,u.materialProperties.bumpIntensity,u.materialProperties.bumpPrecision,1])),r.setBindGroup(1,h.colorGroup);const v=u.getVertexCountPerStrip(g);this._vertexCount+=v,r.setVertexBuffer(0,p),r.draw(v)})}renderLoop(){const{width:e,height:s}=this.canvas;this._transformations=j2(this._transformations,[e,s],this._cameraTransHandler),this.render(),this._fps.measureFPS(),this._activeRenderLoop&&requestAnimationFrame(this.renderLoop.bind(this))}beginRenderLoop(e){this._fps=Gf(),this._cameraTransHandler=e==null?void 0:e.camera,this._lightsHandler=e==null?void 0:e.lights,this._modelHandlers=(e==null?void 0:e.models)??{},this._activeRenderLoop=!0,this.renderLoop()}setLightsHandler(e){this._lightsHandler=e}endRenderLoop(){this._activeRenderLoop=!1}}let io=new Map;const q2=async t=>{var e,s;if(!navigator.gpu)return Promise.reject(new Error("WebGPU is not supported in this browser!"));const r=(e=io.get(t.id))==null?void 0:e.gpu;if(r)return Promise.resolve(r);if((s=io.get(t.id))!=null&&s.initializing)return new Promise((o,a)=>{setTimeout(()=>{var l;const h=(l=io.get(t.id))==null?void 0:l.gpu;if(h)return console.warn("WebGPU connection already initialized. Reusing previous connection."),o(h);a(new Error("WebGPU already initialization is taking too long!"))},100)});io.set(t.id,{initializing:!0});const n=await zc.build(t);return io.set(t.id,{initializing:!1,gpu:n}),Promise.resolve(n)},Q2=(t,e,s)=>{const{device:r}=t,n="rgba8unorm",o={label:e,size:[s.width,s.height,1],format:n,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},a=r.createTexture(o);r.queue.copyExternalImageToTexture({source:s},{texture:a},[s.width,s.height]);const l=a.createView({label:`${e}-view`});return{name:e,texture:a,view:l}},Y2=t=>{let e=[];const s=/rgba?\(([^)]+)\)/.exec(t);if(s&&s[1]&&(e=s[1].split(",").map(l=>parseFloat(l.trim()))),e.length<3)throw new Error("Invalid RGB/RGBA format");const r=e[0]/255,n=e[1]/255,o=e[2]/255,a=e.length===4?e[3]:1;return{r,g:n,b:o,a}},X2=async(t,e)=>{const s=new URL(e,window.location.href);return new Promise((r,n)=>{const o=new Image;o.src=s.href,o.onerror=a=>{n(a)},o.onload=()=>{createImageBitmap(o).then(a=>Q2(t,s.pathname,a)).then(a=>r([t,a]))}})},K2=async(t,e)=>Promise.all(e.map(s=>X2(t,s))).then(s=>Promise.resolve([t,s.map(([,r])=>r)])),Js=4;class $o{constructor(e,s,r){jt(this,"_body",null),jt(this,"_id"),jt(this,"_bufferData",null),jt(this,"_vertices",[]),jt(this,"_vertexColors",[]),jt(this,"_vertexNormals",[]),jt(this,"_vertexTangents",[]),jt(this,"_vertexTextureCoords",[]),jt(this,"_stripColors",[]),jt(this,"_vertexByteSize",0),jt(this,"_buffers",[]),jt(this,"_bufferLayout",null),jt(this,"_topology","triangle-list"),jt(this,"_cullMode","back"),jt(this,"_alpha",1),jt(this,"_bumpIntensity",.2),jt(this,"_bumpPrecision",2),jt(this,"_materials",[]),jt(this,"_transformation",{rotation:En.identity(),scale:Ht.fromValues(1,1,1),translation:Ht.fromValues(0,0,0)}),jt(this,"_transformationData"),jt(this,"display","full"),this._id=e,this._topology=s,this._vertexByteSize=3*4,this._stripColors=r.colors??[[0,0,0,0]],this._alpha=r.alpha??1,this._bumpIntensity=r.bumpIntensity??.2,this._bumpPrecision=r.bumpPrecision??2,this._transformationData=new Float32Array(32)}get id(){return this._id}get materialProperties(){return{alpha:this._alpha,bumpIntensity:this._bumpIntensity,bumpPrecision:this._bumpPrecision}}get label(){return this._topology}get translationVector(){return this._transformation.translation??Ht.fromValues(0,0,0)}get orientationRotation(){return this._transformation.rotation??En.identity()}get scaleVector(){return this._transformation.scale??Ht.fromValues(1,1,1)}get hasTextures(){return this._vertexTextureCoords.length>0&&this._materials.length>0}get materials(){return this._materials}get vertexShader(){return this._topology==="triangle-strip"||this._topology==="triangle-list"?this.hasTextures?"vertexTextureShader":"vertexColorShader":"vertexLineShader"}get fragmentShader(){return this._topology==="triangle-strip"||this._topology==="triangle-list"?this._materials.length===2?"fragmentTextureBumpShader":this.hasTextures?"fragmentTextureShader":"fragmentColorShader":"fragmentLineShader"}get colors(){return this._stripColors}get primitives(){return this._topology}get cullMode(){return this._topology==="triangle-strip"||this._topology==="triangle-list"?this._cullMode:"none"}get vertexCount(){return this._vertices.reduce((e,s)=>e+s.length/3,0)}get body(){return this._body}get transformation(){return Vt.fromRotationTranslationScale(this._transformation.rotation??En.identity(),this._transformation.translation??Ht.fromValues(0,0,0),this._transformation.scale??Ht.fromValues(1,1,1))}get transformationData(){const e=this.transformation;return this._transformationData.set([...e.values]),this._transformationData.set([...e.transpose().invert().values],16),this._transformationData}addMaterial(e){return this._materials.push(e),this.materials.length-1}setBody(e){return this._body=e,this}scale(e){return this._transformation.scale=this.scaleVector.multiply(e),this}translate(e){return this._transformation.translation=this.translationVector.add(e),this}rotate(e){return this._transformation.rotation=this.orientationRotation.compose(e),this}rotoTranslate(e,s){const r=this._transformation;return r.rotation=e,r.translation=s,this}transform(e,s){return this._transformation=s(e,this._transformation),this}getVertexCountPerStrip(e){return this._vertices[e].length/3}get vertexByteSize(){return this._vertexByteSize}getByteSizePerStrip(e=0){return this._vertices[e].length*Js+(this._vertexColors.length>0?this._vertexColors[e].length*Js:0)+(this._vertexNormals.length>0?this._vertexNormals[e].length*Js:0)+(this._vertexTangents.length>0?this._vertexTangents[e].length*Js:0)+(this._vertexTextureCoords.length>0?this._vertexTextureCoords[e].length*Js:0)}setCullMode(e){return this._cullMode=e,this}addVertices(e){this._vertices.push(e)}getBufferData(){return this._bufferData!==null?this._bufferData:(this._bufferData=this._vertices.map((e,s)=>{const r=[];for(let n=0,o=0,a=0,l=0;n<e.length;n+=3,o+=4,a+=3,l+=2){const h=[e[n+0],e[n+1],e[n+2]];this._vertexColors.length>s&&(h.push(this._vertexColors[s][o+0]),h.push(this._vertexColors[s][o+1]),h.push(this._vertexColors[s][o+2]),h.push(this._vertexColors[s][o+3])),this._vertexNormals.length>s&&(h.push(this._vertexNormals[s][a+0]),h.push(this._vertexNormals[s][a+1]),h.push(this._vertexNormals[s][a+2])),this._vertexTangents.length>s&&(h.push(this._vertexTangents[s][a+0]),h.push(this._vertexTangents[s][a+1]),h.push(this._vertexTangents[s][a+2])),this._vertexTextureCoords.length>s&&(h.push(this._vertexTextureCoords[s][l+0]),h.push(this._vertexTextureCoords[s][l+1])),r.push(...h)}return new Float32Array(r)}),this._bufferData)}get layouts(){let e=0,s=0;const r=[{shaderLocation:e,offset:0,format:"float32x3"}];return e+=1,s+=3*Js,this._vertexColors.length>0&&(r.push({shaderLocation:e,offset:s,format:"float32x4"}),e+=1,s+=4*Js),this._vertexNormals.length>0&&(r.push({shaderLocation:e,offset:s,format:"float32x3"}),e+=1,s+=3*Js),this._vertexTangents.length>0&&(r.push({shaderLocation:e,offset:s,format:"float32x3"}),e+=1,s+=3*Js),this._vertexTextureCoords.length>0&&(r.push({shaderLocation:e,offset:s,format:"float32x2"}),e+=1,s+=2*Js),r}get buffers(){return this._buffers}get bufferLayout(){if(this._bufferLayout===null)throw new Error("TriangleData: Buffer layout is not available! - Did you call buildGpuBuffer() ?");return this._bufferLayout}buildGpuBuffer(e){this._buffers=this.getBufferData().map(s=>O2(e.device,s)),this._bufferLayout={arrayStride:this.vertexByteSize,attributes:this.layouts}}addColors(e){this._vertexColors.length===0&&(this._vertexByteSize+=4*4),this._vertexColors.push(e)}addNormals(e){var s;this._vertexNormals.length===0&&(this._vertexByteSize+=3*4),(s=this._vertexNormals)==null||s.push(e)}addTangents(e){var s;this._vertexTangents.length===0&&(this._vertexByteSize+=3*4),(s=this._vertexTangents)==null||s.push(e)}addTextures(e){this._vertexTextureCoords.length===0&&(this._vertexByteSize+=2*4),this._vertexTextureCoords.push(e)}}const Wf=(t,e)=>{const s=t[e+0],r=t[e+1],n=t[e+2],o=Ht.fromPoints(r,s),a=Ht.fromPoints(n,s);return gt.crossProduct(o,a)},Z2=(t,e)=>{const s=t[e-2],r=t[e-1],n=t[e-0],o=Ht.fromPoints(r,s),a=Ht.fromPoints(r,n);return gt.crossProduct(a,o)},J2=(t,e)=>{const s=[],r=t==="triangle-list"?3:1;if(t==="triangle-strip"){let n=Wf(e,0);s.push(n),s.push(n);for(let o=2;o<e.length;o+=1)Z2(e,o),s.push(n)}else for(let n=0;n<e.length-2;n+=r){const o=Wf(e,n);s.push(o),s.push(o),s.push(o)}return s},un=(t,e,s)=>{const{w:r,h:n}=e,o=r/2,a=n/2,l=t.origin,h=[],u=[],c=[],f=gt.fromValues(0,0,1),p=gt.fromValues(1,0,0);h.push(ot.fromValues(l.x-o,l.y-a,0)),h.push(ot.fromValues(l.x+o,l.y-a,0)),h.push(ot.fromValues(l.x-o,l.y+a,0)),h.push(ot.fromValues(l.x-o,l.y+a,0)),h.push(ot.fromValues(l.x+o,l.y-a,0)),h.push(ot.fromValues(l.x+o,l.y+a,0)),u.push(f,f,f,f,f,f),c.push(p,p,p,p,p,p);const g=[],{pos:y,size:v}=s,{w:z,h:x}=v,m=z/2,d=x/2;g.push({u:y.u+m,v:y.v-d}),g.push({u:y.u-m,v:y.v-d}),g.push({u:y.u+m,v:y.v+d}),g.push({u:y.u+m,v:y.v+d}),g.push({u:y.u-m,v:y.v-d}),g.push({u:y.u-m,v:y.v+d});const w=h.map(S=>S.absolute(t)),N=u.map(S=>S.absolute(t));return[w,N,c,g]},cn=(t,e)=>{const s=e.transpose().invert();return[t[0].map(r=>r.map(e).triplet).flat(),t[1].map(r=>r.map(s).triplet).flat(),t[2].map(r=>r.map(s).triplet).flat(),t[3].map(r=>[r.u,r.v]).flat()]},qf=(t,e,s,r=.5)=>{const n=r,o=gt.fromValues(0,0,1),a=gt.fromValues(0,0,-1),l=[],h=[],u=s==="up"?0:Math.PI*2,c=s==="up"?Math.PI*2/t:-Math.PI*2/t,f=s==="up"?p=>p<Math.PI*2:p=>p>0;for(let p=u;f(p);p+=c){const g=ot.fromValues(0,0,e),y=ot.fromValues(n*Math.cos(p),n*Math.sin(p),e),v=ot.fromValues(n*Math.cos(p+c),n*Math.sin(p+c),e);h.push(g),h.push(y),h.push(v),s==="up"?l.push(o,o,o):l.push(a,a,a)}return[h,l]},tv=(t,e,s)=>{const r=[],n=[],o=[],a=Math.PI/t,l=ot.fromValues(0,0,e),h=ot.fromValues(0,0,s),u=gt.fromValues(0,0,1);for(let c=0;c<Math.PI*2;c+=a){const f=ot.fromValues(.5*Math.cos(c),.5*Math.sin(c),e),p=gt.fromPoints(f,l);r.push(f),n.push(p),o.push(gt.fromVector(p.crossProduct(u)));const g=ot.fromValues(.5*Math.cos(c+a),.5*Math.sin(c+a),e),y=gt.fromPoints(g,l);r.push(g),n.push(y),o.push(gt.fromVector(y.crossProduct(u)));const v=ot.fromValues(.5*Math.cos(c),.5*Math.sin(c),s),z=gt.fromPoints(v,h);r.push(v),n.push(z),o.push(gt.fromVector(z.crossProduct(u)));const x=ot.fromValues(.5*Math.cos(c),.5*Math.sin(c),s),m=gt.fromPoints(x,h);r.push(x),n.push(m),o.push(gt.fromVector(m.crossProduct(u)));const d=ot.fromValues(.5*Math.cos(c+a),.5*Math.sin(c+a),e),w=gt.fromPoints(d,l);r.push(d),n.push(w),o.push(gt.fromVector(w.crossProduct(u)));const N=ot.fromValues(.5*Math.cos(c+a),.5*Math.sin(c+a),s),S=gt.fromPoints(N,h);r.push(N),n.push(S),o.push(gt.fromVector(S.crossProduct(u)))}return[r,n,o]},sh=t=>{let e=Math.asin(t.z);return[(Math.atan2(t.y,t.x)+Math.PI)/(2*Math.PI),.5-e/Math.PI]},ev=(t,e,s)=>{const r=Math.min(t[0],e[0],s[0]),n=Math.max(t[0],e[0],s[0]);Math.abs(n-r)>.8&&(t[0]<.4&&e[0]<.4?s[0]-=1:t[0]<.4&&s[0]<.4?e[0]-=1:e[0]<.4&&s[0]<.4?t[0]-=1:t[0]>.6&&e[0]>.6?s[0]+=1:t[0]>.6&&s[0]>.6?e[0]+=1:e[0]>.6&&s[0]>.6&&(t[0]+=1))},iv=(t,e)=>{const{id:s,textureCoordinates:r}=e,n=Vt.rotationX(sr(-90)),o=Vt.rotationX(sr(180)),a=Vt.rotationX(sr(90)),l=Vt.rotationZ(sr(-90)).rotationY(sr(90)),h=Vt.rotationZ(sr(90)).rotationY(sr(-90)),u=su.from2Vectors(ot.fromValues(0,0,.5),gt.fromValues(0,0,1),gt.fromValues(1,0,0)),c=u.map(o),f=u.map(n),p=u.map(a),g=u.map(l),y=u.map(h),v={w:.25,h:.25},z=un(u,{w:1,h:1},{pos:{u:.25+.25/2,v:.25/2},size:v}),x=un(c,{w:1,h:1},{pos:{u:.25+.25/2,v:.5+.25/2},size:v}),m=un(f,{w:1,h:1},{pos:{u:.25+.25/2,v:.25+.25/2},size:v}),d=un(p,{w:1,h:1},{pos:{u:.75+.25/2,v:.25+.25/2},size:v}),w=un(g,{w:1,h:1},{pos:{u:0+.25/2,v:.25+.25/2},size:v}),N=un(y,{w:1,h:1},{pos:{u:.5+.25/2,v:.25+.25/2},size:v}),[S,k,O,E]=cn(z,t),M=cn(x,t),R=cn(m,t),D=cn(d,t),A=cn(w,t),P=cn(N,t);S.push(...M[0],...R[0],...D[0],...A[0],...P[0]),k.push(...M[1],...R[1],...D[1],...A[1],...P[1]),O.push(...M[2],...R[2],...D[2],...A[2],...P[2]),E.push(...M[3],...R[3],...D[3],...A[3],...P[3]);const st=new $o(s,"triangle-list",e);return st.addVertices(new Float32Array(S)),st.addNormals(new Float32Array(k)),st.addTangents(new Float32Array(O)),r&&st.addTextures(new Float32Array(E)),st},sv=()=>iv,rv=(t,e)=>{const{steps:s,id:r,textureCoordinates:n}=e,o=t.transpose().invert(),a=[],l=[],h=[],u=[],[c,f]=qf(s,.5,"up"),[p,g]=qf(s,-.5,"down"),[y,v,z]=tv(s,-.5,.5);if(a.push(...c.map(m=>m.map(t))),a.push(...p.map(m=>m.map(t))),a.push(...y.map(m=>m.map(t))),n){let m=0,d=0;const w=c.map(k=>[k.x+.5,k.y+.5]),N=p.map(k=>[k.x+.5,k.y+.5]),S=y.map(k=>{const O=k.z+.5;let E=(Math.atan2(k.y,k.x)+Math.PI)/(2*Math.PI);return E<Math.min(m,d)&&(E+=1),d=m,m=E,[E,O]});u.push(...w),u.push(...N),u.push(...S)}l.push(...f.map(m=>m.map(o))),l.push(...g.map(m=>m.map(o))),l.push(...v.map(m=>m.map(o))),h.push(...c.map(m=>gt.fromValues(1,0,0).map(o))),h.push(...p.map(m=>gt.fromValues(-1,0,0).map(o))),h.push(...z.map(m=>m.map(o)));const x=new $o(r,"triangle-list",e);return x.addVertices(new Float32Array(a.map(m=>m.triplet).flat())),x.addNormals(new Float32Array(l.map(m=>m.triplet).flat())),x.addTangents(new Float32Array(h.map(m=>m.triplet).flat())),n&&x.addTextures(new Float32Array(u.flat())),x},nv=()=>rv,gs=.5257311121191336,ws=.8506508083520399,ov=[gt.fromValues(-gs,0,ws),gt.fromValues(gs,0,ws),gt.fromValues(-gs,0,-ws),gt.fromValues(gs,0,-ws),gt.fromValues(0,ws,gs),gt.fromValues(0,ws,-gs),gt.fromValues(0,-ws,gs),gt.fromValues(0,-ws,-gs),gt.fromValues(ws,gs,0),gt.fromValues(-ws,gs,0),gt.fromValues(ws,-gs,0),gt.fromValues(-ws,-gs,0)],av=[[0,4,1],[0,9,4],[9,5,4],[4,5,8],[4,8,1],[8,10,1],[8,3,10],[5,3,8],[5,2,3],[2,7,3],[7,10,3],[7,6,10],[7,11,6],[11,0,6],[0,1,6],[6,1,10],[9,0,11],[9,11,2],[9,2,5],[7,2,11]];function lv(t,e){return gt.fromVector(t.add(e))}function wd(t,e,s=1){const r=new Map,n=[];function o(a,l){const h=a<l,u=`${h?a:l}-${h?l:a}`,c=r.get(u);if(c)return c;const f=lv(Ht.fromValues(...t[a].triplet),Ht.fromValues(...t[l].triplet));t.push(f);const p=t.length-1;return r.set(u,p),p}for(const[a,l,h]of e){const u=o(a,l),c=o(a,h),f=o(l,h);n.push([a,u,c]),n.push([l,f,u]),n.push([h,c,f]),n.push([u,f,c])}return s===1?[t,n]:wd(t,n,s-1)}const hv=(t,e)=>{const{steps:s,id:r,textureCoordinates:n}=e,o=t.transpose().invert(),a=gt.fromValues(0,0,1),[l,h]=wd(ov,av,s),u=[],c=[],f=[],p=[],g=ot.fromValues(0,0,0);h.forEach(v=>{const z=ot.fromVector(l[v[2]]),x=ot.fromVector(l[v[1]]),m=ot.fromVector(l[v[0]]),d=gt.fromVector(Ht.fromPoints(z,g)),w=gt.fromVector(Ht.fromPoints(x,g)),N=gt.fromVector(Ht.fromPoints(m,g));if(u.push(...z.map(t).triplet),u.push(...x.map(t).triplet),u.push(...m.map(t).triplet),c.push(...d.map(o).triplet),c.push(...w.map(o).triplet),c.push(...N.map(o).triplet),f.push(...gt.fromVector(d.crossProduct(a)).triplet),f.push(...gt.fromVector(w.crossProduct(a)).triplet),f.push(...gt.fromVector(N.crossProduct(a)).triplet),n){const S=sh(d),k=sh(w),O=sh(N);ev(S,k,O),p.push(...S),p.push(...k),p.push(...O)}});const y=new $o(r,"triangle-list",e);return y.addVertices(new Float32Array(u)),y.addNormals(new Float32Array(c)),y.addTangents(new Float32Array(f)),n&&y.addTextures(new Float32Array(p)),y},uv=()=>hv,cv=(t,e)=>{const{steps:s,id:r}=e,n=t.transpose().invert(),o=t.scaleVector,a=Math.min(o.x,o.y)/s,l=Math.floor(o.x/a),h=Math.floor(o.y/a),u=1/l,c=1/h,f=[];for(let p=0;p<l;p++){f.push([]);for(let g=0;g<h+1;g++)f[p].push(ot.fromValues(-.5+u*p,-.5+c*g,0)),f[p].push(ot.fromValues(-.5+u*(p+1),-.5+c*g,0))}return f.map(p=>{const g=J2("triangle-strip",p);return[new Float32Array(p.map(y=>y.map(t).triplet).flat()),new Float32Array(g.map(y=>y.map(n).triplet).flat()),new Float32Array(p.map(y=>gt.fromValues(1,0,0).map(n).triplet).flat()),new Float32Array(p.map(y=>[y.x+.5,y.y+.5]).flat())]}).reduce((p,[g,y,v,z])=>(p.addVertices(g),p.addNormals(y),p.addTangents(v),p.addTextures(z),p),new $o(r,"triangle-strip",e)).setCullMode("none")},fv=()=>cv,pv=(t,e)=>{const{id:s,colors:r,showAxes:n}=e,o=t.scaleVector,a=Math.min(o.x,o.y),l=Math.log10(a),h=Math.max(.6-(l-Math.floor(l)),0),u=Math.min(1,h+.2),c=Math.max(.15,h-.3),f=Math.floor(l)-1,p=Math.floor(l),g=Math.floor(l)-2,y=Math.pow(10,f),v=Math.pow(10,p),z=Math.pow(10,g)*2;console.log("prev tileDim",z,"with total grids",a/z," with alpha",c),console.log("main tileDim",y,"with total grids",a/y," with alpha",h),console.log("next tileDim",v,"with total grids",a/v," with alpha",u);const x=rh(o,y,t,!n),m=rh(o,v,t,!n),d=new $o(s,"line-list",e);if(n){const w=[],N=ot.fromValues(-0,0,0).map(t),S=ot.fromValues(.5,0,0).map(t),k=ot.fromValues(0,-0,0).map(t),O=ot.fromValues(0,.5,0).map(t),E=ot.fromValues(0,0,0).map(t),M=ot.fromValues(0,0,y),R=ot.fromValues(-.5,0,0).map(t),D=ot.fromValues(0,0,0).map(t),A=ot.fromValues(-0,-.5,0).map(t),P=ot.fromValues(0,0,0).map(t);w.push(N,S,k,O,E,M,R,D,A,P);const st=[[1,0,0,1],[1,0,0,1],[0,1,0,1],[0,1,0,1],[.1,.1,1,1],[.1,.1,1,1],(r==null?void 0:r[0])??[.5,.5,.5,1],(r==null?void 0:r[0])??[.5,.5,.5,1],(r==null?void 0:r[0])??[.5,.5,.5,1],(r==null?void 0:r[0])??[.5,.5,.5,1]];d.addVertices(new Float32Array(w.flatMap(zt=>zt.triplet))),d.addColors(new Float32Array(st.flat()))}if(d.addVertices(new Float32Array(m.flatMap(w=>w.triplet))),d.addColors(new Float32Array(nh(m,u,r==null?void 0:r[0]))),d.addVertices(new Float32Array(x.flatMap(w=>w.triplet))),d.addColors(new Float32Array(nh(x,h,r==null?void 0:r[1]))),a/z<100){const w=rh(o,z,t,!n);d.addVertices(new Float32Array(w.flatMap(N=>N.triplet))),d.addColors(new Float32Array(nh(w,c,r==null?void 0:r[2])))}return d},dv=()=>pv,rh=(t,e,s,r=!0)=>{const n=t.x/e,o=t.y/e,a=1/n,l=1/o,h=-.05,u=[];if(r){const c=ot.fromValues(0,-.5,h).map(s),f=ot.fromValues(0,.5,h).map(s);u.push(c,f)}for(let c=1;c<n/2;c++){const f=ot.fromValues(-a*c,-.5,h).map(s),p=ot.fromValues(-a*c,.5,h).map(s);if(u.push(f,p),a*c<.5){const g=ot.fromValues(a*c,-.5,h).map(s),y=ot.fromValues(a*c,.5,h).map(s);u.push(g,y)}}if(r){const c=ot.fromValues(-.5,0,h).map(s),f=ot.fromValues(.5,0,h).map(s);u.push(c,f)}for(let c=1;c<o/2;c++){const f=ot.fromValues(-.5,-l*c,h).map(s),p=ot.fromValues(.5,-l*c,h).map(s);if(u.push(f,p),l*c<.5){const g=ot.fromValues(-.5,l*c,h).map(s),y=ot.fromValues(.5,l*c,h).map(s);u.push(g,y)}}return u};function nh(t,e,s){return t.flatMap(()=>s??[.5,.5,.5,e])}const mv=(t,e=[10,10,10],s=Math.PI/5)=>{let r=ot.fromValues(0,0,0),n=ot.fromValues(...e),o=n.x===0&&n.y===0?gt.fromValues(0,1,0):gt.fromValues(0,0,1),a=[0,0],l=[0,0],h=0,u=0,c=s,f=Ht.fromPoints(n,r).lengthSquare,p=su.lookAt(n,r,o),g=!1;return[{move:(y,v,z)=>{const x=Math.min(t.canvas.width,t.canvas.height),m=Math.max(t.canvas.width,t.canvas.height);let d=Math.log(f)*Math.atan(c)/(m/2),w=c/x*2;switch(y){case"mouse-0":a=[v.direction[0]*d,v.direction[1]*d],g=!0;break;case"mouse-1":l=[-v.direction[0]*w,v.direction[1]*w];break;case"mouse-2":c+=v.direction[1]*w;break;case"none":g=!1;break}},zoom:y=>{const v=Math.log(f+1)/(4e3*Math.atan(c));h=y*v},tilt:y=>{u=y*5e-4,g=!1}},{view:y=>{if(!y||y!=null&&y.isIdentity)return Vt.lookAt(n,r,o);const v=Ht.fromPoints(n,r).scale(1-h);v.length>2&&v.length<500&&(n=r.add(v));const z=Ht.fromPoints(r,n),x=Vt.move(z).apply(p),m=[Math.tan(l[0])*f,Math.tan(l[1])*f],d=Ht.fromValues(m[0],m[1],0).absolute(x),w=x.relative(n);let N=x.relative(o);N=Vt.rotationZ(u).apply(N);const S=Vt.rotationX(-a[1]).compose(Vt.rotationY(-a[0]));n=S.apply(w).absolute(x),o=S.apply(N).absolute(x);const k=Vt.move(d);return r=k.apply(r),n=k.apply(n),p=su.lookAt(n,r,o),g||(a=[a[0]*.95,a[1]*.95],u*=.9,h*=.9,Math.abs(a[0])<.001&&Math.abs(a[1])<.001&&Math.abs(u)<.001&&Math.abs(h)<.001&&(a=[0,0],u=0,h=0)),l=[0,0],f=Ht.fromPoints(n,r).length,p.toTransform()},projection:y=>{const v=t.canvas.width/t.canvas.height,z=Ht.fromPoints(n,r).length,x=Math.max(400,z*.8);return Vt.perspective(c,v,Math.max(.01,z-x),z+x)}}]};const vv=t=>{t.setAmbientLight([.15,.15,.2,.1]),t.setLight("directional",0,{dir:gt.fromValues(0,10,-10),col:[.3,.3,.3,.3]}),t.setLight("directional",1,{dir:gt.fromValues(-10,0,-10),col:[.4,.4,.4,.4]}),t.setLight("point",0,{pos:ot.fromValues(15,15,30),col:[.5,.5,.45,1]}),t.setLight("point",1,{pos:ot.fromValues(-15,-15,30),col:[.3,.3,.7,1]}),t.setLight("point",2,{pos:ot.fromValues(15,-15,30),col:[.7,.1,.2,1]}),t.setLight("point",3,{pos:ot.fromValues(-15,15,30),col:[.5,.6,0,1]})},yv=({onError:t,onConnected:e})=>{const s=Ns.useRef(null),[r,n]=Ns.useState(null),[o,a]=Ns.useState("0"),[l,h]=Ns.useState(0),[u,c]=Ns.useState(!1);return Ns.useEffect(()=>{const f=setTimeout(()=>{r&&!u&&(e(r),c(!0))},10),p=setInterval(()=>{r&&u&&(a(r.fps.toFixed(0)),h(r.vertexCount))},1e3);return()=>{p&&(clearInterval(p),clearTimeout(f))}},[r,u,e]),Ns.useEffect(()=>(q2(s.current).then(f=>f.setupShaders("standard-3d")).then(f=>{if(!f)return;const[p,g]=mv(f,[25,25,15]);f.captureMouseMotion(p),f.setScene([]),vv(f),f.beginRenderLoop({camera:g}),n(f)}).catch(f=>{console.error(f),t(f)}),()=>{r&&(r.endRenderLoop(),n(null))}),[]),ye.jsxs("div",{className:"w-full h-full relative",children:[ye.jsx("canvas",{className:"bg-black text-yellow-400 w-full h-full",ref:s,width:600,height:600}),";",ye.jsxs("div",{className:"absolute top-0 right-0 p-2 text-xs text-gray-400 bg-gray-700/25 w-40 text-left",children:["FPS: ",o]}),ye.jsxs("div",{className:"absolute top-8 right-0 p-2 text-xs text-gray-400 bg-gray-700/25 w-40 text-left",children:["Vtx: ",Math.round(l/1e3),"K"]})]})},ha="border-t-[1px] border-b-[1px] border-t-slate-800 border-b-slate-900",ua="flex flex-row justify-center items-center cursor-pointer m-1 mb-0",oh="btn btn-outline btn-primary w-[48px] p-0",xv=({onSelected:t,onClear:e})=>ye.jsxs("ul",{className:"flex flex-col w-[52px] items-stretch",children:[ye.jsx("li",{className:`h-[45px] ${ha} ${ua}`,children:ye.jsx("button",{className:oh,onClick:()=>t("sphere"),children:ye.jsx("img",{src:"sphere-48.png",alt:"C"})})},"2"),ye.jsx("li",{className:`h-[45px] ${ha} ${ua}`,children:ye.jsx("button",{className:oh,onClick:()=>t("cube"),children:ye.jsx("img",{src:"cube-48.png",alt:"C"})})},"3"),ye.jsx("li",{className:`h-[52px] ${ha} ${ua}`,children:ye.jsx("button",{className:oh,onClick:()=>t("cylinder"),children:ye.jsx("img",{src:"cyl-48.png",alt:"C",width:42})})},"4"),ye.jsx("div",{className:"flex-1"}),ye.jsx("li",{className:`h-[45px] ${ha} ${ua} mb-2`,children:ye.jsx("button",{className:"btn btn-outline btn-accent",onClick:()=>e(),children:""})},"100")]});Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52));Math.sign===void 0&&(Math.sign=function(t){return t<0?-1:t>0?1:+t});Function.prototype.name===void 0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});Object.assign===void 0&&function(){Object.assign=function(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),s=1;s<arguments.length;s++){var r=arguments[s];if(r!=null)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}}();var gv="1.0.9",wv=0,zv=1,Nv=2,Sv=3,kv=0,el=1,lo=2,Mv=0,lr=1,hr=2,Wr=3,ho=4,Pv=5,_v=0,Lv=1,Vv=2,Iv=3,Cv=4,Tv=5,bv=6,Sl=.005,B={sqrt:Math.sqrt,abs:Math.abs,floor:Math.floor,cos:Math.cos,sin:Math.sin,acos:Math.acos,asin:Math.asin,atan2:Math.atan2,round:Math.round,pow:Math.pow,max:Math.max,min:Math.min,random:Math.random,degtorad:.017453292519943295,radtodeg:57.29577951308232,PI:3.141592653589793,TwoPI:6.283185307179586,PI90:1.570796326794896,PI270:4.712388980384689,INF:1/0,EPZ:1e-5,EPZ2:1e-6,lerp:function(t,e,s){return(1-s)*t+s*e},randInt:function(t,e){return t+B.floor(B.random()*(e-t+1))},rand:function(t,e){return t+B.random()*(e-t)},generateUUID:function(){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=new Array(36),s=0,r;return function(){for(var o=0;o<36;o++)o===8||o===13||o===18||o===23?e[o]="-":o===14?e[o]="4":(s<=2&&(s=33554432+Math.random()*16777216|0),r=s&15,s=s>>4,e[o]=t[o===19?r&3|8:r]);return e.join("")}}(),int:function(t){return B.floor(t)},fix:function(t,e){return t.toFixed(e||3,10)},clamp:function(t,e,s){return B.max(e,B.min(s,t))},distance:function(t,e){var s=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return B.sqrt(s*s+r*r+n*n)},acosClamp:function(t){return t>1?0:t<-1?B.PI:B.acos(t)},distanceVector:function(t,e){var s=t.x-e.x,r=t.y-e.y,n=t.z-e.z;return s*s+r*r+n*n},dotVectors:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}};function Ni(t,e){console.error("[OIMO] "+t+": "+e)}function zd(t){this.parent=t,this.infos=new Float32Array(13),this.f=[0,0,0],this.times=[0,0,0,0],this.broadPhase=this.parent.broadPhaseType,this.version=gv,this.fps=0,this.tt=0,this.broadPhaseTime=0,this.narrowPhaseTime=0,this.solvingTime=0,this.totalTime=0,this.updateTime=0,this.MaxBroadPhaseTime=0,this.MaxNarrowPhaseTime=0,this.MaxSolvingTime=0,this.MaxTotalTime=0,this.MaxUpdateTime=0}Object.assign(zd.prototype,{setTime:function(t){this.times[t||0]=performance.now()},resetMax:function(){this.MaxBroadPhaseTime=0,this.MaxNarrowPhaseTime=0,this.MaxSolvingTime=0,this.MaxTotalTime=0,this.MaxUpdateTime=0},calcBroadPhase:function(){this.setTime(2),this.broadPhaseTime=this.times[2]-this.times[1]},calcNarrowPhase:function(){this.setTime(3),this.narrowPhaseTime=this.times[3]-this.times[2]},calcEnd:function(){this.setTime(2),this.solvingTime=this.times[2]-this.times[1],this.totalTime=this.times[2]-this.times[0],this.updateTime=this.totalTime-(this.broadPhaseTime+this.narrowPhaseTime+this.solvingTime),this.tt===100&&this.resetMax(),this.tt>100&&(this.broadPhaseTime>this.MaxBroadPhaseTime&&(this.MaxBroadPhaseTime=this.broadPhaseTime),this.narrowPhaseTime>this.MaxNarrowPhaseTime&&(this.MaxNarrowPhaseTime=this.narrowPhaseTime),this.solvingTime>this.MaxSolvingTime&&(this.MaxSolvingTime=this.solvingTime),this.totalTime>this.MaxTotalTime&&(this.MaxTotalTime=this.totalTime),this.updateTime>this.MaxUpdateTime&&(this.MaxUpdateTime=this.updateTime)),this.upfps(),this.tt++,this.tt>500&&(this.tt=0)},upfps:function(){this.f[1]=Date.now(),this.f[1]-1e3>this.f[0]&&(this.f[0]=this.f[1],this.fps=this.f[2],this.f[2]=0),this.f[2]++},show:function(){var t=["Oimo.js "+this.version+"<br>",this.broadPhase+"<br><br>","FPS: "+this.fps+" fps<br><br>","rigidbody "+this.parent.numRigidBodies+"<br>","contact &nbsp;&nbsp;"+this.parent.numContacts+"<br>","ct-point &nbsp;"+this.parent.numContactPoints+"<br>","paircheck "+this.parent.broadPhase.numPairChecks+"<br>","island &nbsp;&nbsp;&nbsp;"+this.parent.numIslands+"<br><br>","Time in milliseconds<br><br>","broadphase &nbsp;"+B.fix(this.broadPhaseTime)+" | "+B.fix(this.MaxBroadPhaseTime)+"<br>","narrowphase "+B.fix(this.narrowPhaseTime)+" | "+B.fix(this.MaxNarrowPhaseTime)+"<br>","solving &nbsp;&nbsp;&nbsp;&nbsp;"+B.fix(this.solvingTime)+" | "+B.fix(this.MaxSolvingTime)+"<br>","total &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+B.fix(this.totalTime)+" | "+B.fix(this.MaxTotalTime)+"<br>","updating &nbsp;&nbsp;&nbsp;"+B.fix(this.updateTime)+" | "+B.fix(this.MaxUpdateTime)+"<br>"].join(`
`);return t},toArray:function(){return this.infos[0]=this.parent.broadPhase.types,this.infos[1]=this.parent.numRigidBodies,this.infos[2]=this.parent.numContacts,this.infos[3]=this.parent.broadPhase.numPairChecks,this.infos[4]=this.parent.numContactPoints,this.infos[5]=this.parent.numIslands,this.infos[6]=this.broadPhaseTime,this.infos[7]=this.narrowPhaseTime,this.infos[8]=this.solvingTime,this.infos[9]=this.updateTime,this.infos[10]=this.totalTime,this.infos[11]=this.fps,this.infos}});function U(t,e,s){this.x=t||0,this.y=e||0,this.z=s||0}Object.assign(U.prototype,{Vec3:!0,set:function(t,e,s){return this.x=t,this.y=e,this.z=s,this},add:function(t,e){return e!==void 0?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addEqual:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},sub:function(t,e){return e!==void 0?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},subEqual:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},scale:function(t,e){return this.x=t.x*e,this.y=t.y*e,this.z=t.z*e,this},scaleEqual:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},subScaledVector:function(t,e){return this.x-=t.x*e,this.y-=t.y*e,this.z-=t.z*e,this},cross:function(t,e){if(e!==void 0)return this.crossVectors(t,e);var s=this.x,r=this.y,n=this.z;return this.x=r*t.z-n*t.y,this.y=n*t.x-s*t.z,this.z=s*t.y-r*t.x,this},crossVectors:function(t,e){var s=t.x,r=t.y,n=t.z,o=e.x,a=e.y,l=e.z;return this.x=r*l-n*a,this.y=n*o-s*l,this.z=s*a-r*o,this},tangent:function(t){var e=t.x,s=t.y,r=t.z;return this.x=s*e-r*r,this.y=-r*s-e*e,this.z=e*r+s*s,this},invert:function(t){return this.x=-t.x,this.y=-t.y,this.z=-t.z,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},addition:function(){return this.x+this.y+this.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return B.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},applyMatrix3:function(t,e){var s=this.x,r=this.y,n=this.z,o=t.elements;return e?(this.x=o[0]*s+o[1]*r+o[2]*n,this.y=o[3]*s+o[4]*r+o[5]*n,this.z=o[6]*s+o[7]*r+o[8]*n):(this.x=o[0]*s+o[3]*r+o[6]*n,this.y=o[1]*s+o[4]*r+o[7]*n,this.z=o[2]*s+o[5]*r+o[8]*n),this},applyQuaternion:function(t){var e=this.x,s=this.y,r=this.z,n=t.x,o=t.y,a=t.z,l=t.w,h=l*e+o*r-a*s,u=l*s+a*e-n*r,c=l*r+n*s-o*e,f=-n*e-o*s-a*r;return this.x=h*l+f*-n+u*-a-c*-o,this.y=u*l+f*-o+c*-n-h*-a,this.z=c*l+f*-a+h*-o-u*-n,this},testZero:function(){return this.x!==0||this.y!==0||this.z!==0},testDiff:function(t){return!this.equals(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},clone:function(){return new this.constructor(this.x,this.y,this.z)},toString:function(){return"Vec3["+this.x.toFixed(4)+", "+this.y.toFixed(4)+", "+this.z.toFixed(4)+"]"},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divideScalar:function(t){return this.multiplyScalar(1/t)},normalize:function(){return this.divideScalar(this.length())},toArray:function(t,e){e===void 0&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z},fromArray:function(t,e){return e===void 0&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}});function Si(t,e,s,r){this.x=t||0,this.y=e||0,this.z=s||0,this.w=r!==void 0?r:1}Object.assign(Si.prototype,{Quat:!0,set:function(t,e,s,r){return this.x=t,this.y=e,this.z=s,this.w=r,this},addTime:function(t,e){var s=t.x,r=t.y,n=t.z,o=this.w,a=this.x,l=this.y,h=this.z;return e*=.5,this.x+=e*(s*o+r*h-n*l),this.y+=e*(r*o+n*a-s*h),this.z+=e*(n*o+s*l-r*a),this.w+=e*(-s*a-r*l-n*h),this.normalize(),this},multiply:function(t,e){return e!==void 0?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var s=t.x,r=t.y,n=t.z,o=t.w,a=e.x,l=e.y,h=e.z,u=e.w;return this.x=s*u+o*a+r*h-n*l,this.y=r*u+o*l+n*a-s*h,this.z=n*u+o*h+s*l-r*a,this.w=o*u-s*a-r*l-n*h,this},setFromUnitVectors:function(t,e){var s=new U,r=t.dot(e)+1;return r<B.EPS2?(r=0,B.abs(t.x)>B.abs(t.z)?s.set(-t.y,t.x,0):s.set(0,-t.z,t.y)):s.crossVectors(t,e),this._x=s.x,this._y=s.y,this._z=s.z,this._w=r,this.normalize()},arc:function(t,e){var s=t.x,r=t.y,n=t.z,o=e.x,a=e.y,l=e.z,h=s*o+r*a+n*l;if(h==-1)return o=r*s-n*n,a=-n*r-s*s,l=s*n+r*r,h=1/B.sqrt(o*o+a*a+l*l),this.w=0,this.x=o*h,this.y=a*h,this.z=l*h,this;var u=r*l-n*a,c=n*o-s*l,f=s*a-r*o;return this.w=B.sqrt((1+h)*.5),h=.5/this.w,this.x=u*h,this.y=c*h,this.z=f*h,this},normalize:function(){var t=this.length();return t===0?this.set(0,0,0,1):(t=1/t,this.x=this.x*t,this.y=this.y*t,this.z=this.z*t,this.w=this.w*t),this},inverse:function(){return this.conjugate().normalize()},invert:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this.conjugate().normalize(),this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},length:function(){return B.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},clone:function(t){return new Si(this.x,this.y,this.z,this.w)},testDiff:function(t){return!this.equals(t)},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},toString:function(){return"Quat["+this.x.toFixed(4)+", ("+this.y.toFixed(4)+", "+this.z.toFixed(4)+", "+this.w.toFixed(4)+")]"},setFromEuler:function(t,e,s){var r=Math.cos(t*.5),n=Math.cos(e*.5),o=Math.cos(s*.5),a=Math.sin(t*.5),l=Math.sin(e*.5),h=Math.sin(s*.5);return this.x=a*n*o+r*l*h,this.y=r*l*o-a*n*h,this.z=r*n*h+a*l*o,this.w=r*n*o-a*l*h,this},setFromAxis:function(t,e){t.normalize(),e=e*.5;var s=B.sin(e);return this.x=s*t.x,this.y=s*t.y,this.z=s*t.z,this.w=B.cos(e),this},setFromMat33:function(t){var e=t[0]+t[4]+t[8],s;if(e>0)s=B.sqrt(e+1),this.w=.5/s,s=.5/s,this.x=(t[5]-t[7])*s,this.y=(t[6]-t[2])*s,this.z=(t[1]-t[3])*s;else{var r=[],n=0;t[4]>t[0]&&(n=1),t[8]>t[n*3+n]&&(n=2);var o=(n+1)%3,a=(n+2)%3;s=B.sqrt(t[n*3+n]-t[o*3+o]-t[a*3+a]+1),r[n]=.5*fRoot,s=.5/fRoot,this.w=(t[o*3+a]-t[a*3+o])*s,r[o]=(t[o*3+n]+t[n*3+o])*s,r[a]=(t[a*3+n]+t[n*3+a])*s,this.x=r[1],this.y=r[2],this.z=r[3]}return this},toArray:function(t,e){e=e||0,t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w},fromArray:function(t,e){return e=e||0,this.set(t[e],t[e+1],t[e+2],t[e+3]),this}});function ai(t,e,s,r,n,o,a,l,h){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("OIMO.Mat33: the constructor no longer reads arguments. use .set() instead.")}Object.assign(ai.prototype,{Mat33:!0,set:function(t,e,s,r,n,o,a,l,h){var u=this.elements;return u[0]=t,u[1]=e,u[2]=s,u[3]=r,u[4]=n,u[5]=o,u[6]=a,u[7]=l,u[8]=h,this},add:function(t,e){if(e!==void 0)return this.addMatrixs(t,e);var s=this.elements,r=t.elements;return s[0]+=r[0],s[1]+=r[1],s[2]+=r[2],s[3]+=r[3],s[4]+=r[4],s[5]+=r[5],s[6]+=r[6],s[7]+=r[7],s[8]+=r[8],this},addMatrixs:function(t,e){var s=this.elements,r=t.elements,n=e.elements;return s[0]=r[0]+n[0],s[1]=r[1]+n[1],s[2]=r[2]+n[2],s[3]=r[3]+n[3],s[4]=r[4]+n[4],s[5]=r[5]+n[5],s[6]=r[6]+n[6],s[7]=r[7]+n[7],s[8]=r[8]+n[8],this},addEqual:function(t){var e=this.elements,s=t.elements;return e[0]+=s[0],e[1]+=s[1],e[2]+=s[2],e[3]+=s[3],e[4]+=s[4],e[5]+=s[5],e[6]+=s[6],e[7]+=s[7],e[8]+=s[8],this},sub:function(t,e){if(e!==void 0)return this.subMatrixs(t,e);var s=this.elements,r=t.elements;return s[0]-=r[0],s[1]-=r[1],s[2]-=r[2],s[3]-=r[3],s[4]-=r[4],s[5]-=r[5],s[6]-=r[6],s[7]-=r[7],s[8]-=r[8],this},subMatrixs:function(t,e){var s=this.elements,r=t.elements,n=e.elements;return s[0]=r[0]-n[0],s[1]=r[1]-n[1],s[2]=r[2]-n[2],s[3]=r[3]-n[3],s[4]=r[4]-n[4],s[5]=r[5]-n[5],s[6]=r[6]-n[6],s[7]=r[7]-n[7],s[8]=r[8]-n[8],this},subEqual:function(t){var e=this.elements,s=t.elements;return e[0]-=s[0],e[1]-=s[1],e[2]-=s[2],e[3]-=s[3],e[4]-=s[4],e[5]-=s[5],e[6]-=s[6],e[7]-=s[7],e[8]-=s[8],this},scale:function(t,e){var s=this.elements,r=t.elements;return s[0]=r[0]*e,s[1]=r[1]*e,s[2]=r[2]*e,s[3]=r[3]*e,s[4]=r[4]*e,s[5]=r[5]*e,s[6]=r[6]*e,s[7]=r[7]*e,s[8]=r[8]*e,this},scaleEqual:function(t){var e=this.elements;return e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t,e[8]*=t,this},multiplyMatrices:function(t,e,s){s&&(e=e.clone().transpose());var r=this.elements,n=t.elements,o=e.elements,a=n[0],l=n[3],h=n[6],u=n[1],c=n[4],f=n[7],p=n[2],g=n[5],y=n[8],v=o[0],z=o[3],x=o[6],m=o[1],d=o[4],w=o[7],N=o[2],S=o[5],k=o[8];return r[0]=a*v+u*z+p*x,r[1]=a*m+u*d+p*w,r[2]=a*N+u*S+p*k,r[3]=l*v+c*z+g*x,r[4]=l*m+c*d+g*w,r[5]=l*N+c*S+g*k,r[6]=h*v+f*z+y*x,r[7]=h*m+f*d+y*w,r[8]=h*N+f*S+y*k,this},transpose:function(t){if(t!==void 0){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this}var s=this.elements,r=s[1],n=s[2],o=s[5];return s[1]=s[3],s[2]=s[6],s[3]=r,s[5]=s[7],s[6]=n,s[7]=o,this},setQuat:function(t){var e=this.elements,s=t.x,r=t.y,n=t.z,o=t.w,a=s+s,l=r+r,h=n+n,u=s*a,c=s*l,f=s*h,p=r*l,g=r*h,y=n*h,v=o*a,z=o*l,x=o*h;return e[0]=1-(p+y),e[1]=c-x,e[2]=f+z,e[3]=c+x,e[4]=1-(u+y),e[5]=g-v,e[6]=f-z,e[7]=g+v,e[8]=1-(u+p),this},invert:function(t){var e=this.elements,s=t.elements,r=s[0],n=s[3],o=s[6],a=s[1],l=s[4],h=s[7],u=s[2],c=s[5],f=s[8],p=f*l-c*h,g=-f*n+c*o,y=h*n-l*o,v=r*p+a*g+u*y;return v===0?(console.log("can't invert matrix, determinant is 0"),this.identity()):(v=1/v,e[0]=p*v,e[1]=(-f*a+u*h)*v,e[2]=(c*a-u*l)*v,e[3]=g*v,e[4]=(f*r-u*o)*v,e[5]=(-c*r+u*n)*v,e[6]=y*v,e[7]=(-h*r+a*o)*v,e[8]=(l*r-a*n)*v,this)},addOffset:function(t,e){var s=e.x,r=e.y,n=e.z,o=this.elements;o[0]+=t*(r*r+n*n),o[4]+=t*(s*s+n*n),o[8]+=t*(s*s+r*r);var a=t*s*r,l=t*r*n,h=t*n*s;return o[1]-=a,o[3]-=a,o[2]-=l,o[6]-=l,o[5]-=h,o[7]-=h,this},subOffset:function(t,e){var s=e.x,r=e.y,n=e.z,o=this.elements;o[0]-=t*(r*r+n*n),o[4]-=t*(s*s+n*n),o[8]-=t*(s*s+r*r);var a=t*s*r,l=t*r*n,h=t*n*s;return o[1]+=a,o[3]+=a,o[2]+=l,o[6]+=l,o[5]+=h,o[7]+=h,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new ai().fromArray(this.elements)},copy:function(t){for(var e=0;e<9;e++)this.elements[e]=t.elements[e];return this},determinant:function(){var t=this.elements,e=t[0],s=t[1],r=t[2],n=t[3],o=t[4],a=t[5],l=t[6],h=t[7],u=t[8];return e*o*u-e*a*h-s*n*u+s*a*l+r*n*h-r*o*l},fromArray:function(t,e){e===void 0&&(e=0);for(var s=0;s<9;s++)this.elements[s]=t[s+e];return this},toArray:function(t,e){t===void 0&&(t=[]),e===void 0&&(e=0);var s=this.elements;return t[e]=s[0],t[e+1]=s[1],t[e+2]=s[2],t[e+3]=s[3],t[e+4]=s[4],t[e+5]=s[5],t[e+6]=s[6],t[e+7]=s[7],t[e+8]=s[8],t}});function kl(t,e,s,r,n,o){this.elements=new Float32Array(6);var a=this.elements;a[0]=t||0,a[1]=s||0,a[2]=n||0,a[3]=e||0,a[4]=r||0,a[5]=o||0}Object.assign(kl.prototype,{AABB:!0,set:function(t,e,s,r,n,o){var a=this.elements;return a[0]=t,a[3]=e,a[1]=s,a[4]=r,a[2]=n,a[5]=o,this},intersectTest:function(t){var e=this.elements,s=t.elements;return e[0]>s[3]||e[1]>s[4]||e[2]>s[5]||e[3]<s[0]||e[4]<s[1]||e[5]<s[2]},intersectTestTwo:function(t){var e=this.elements,s=t.elements;return e[0]<s[0]||e[1]<s[1]||e[2]<s[2]||e[3]>s[3]||e[4]>s[4]||e[5]>s[5]},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(t,e){var s=e||0,r=t.elements;return this.set(r[0]-s,r[3]+s,r[1]-s,r[4]+s,r[2]-s,r[5]+s),this},fromArray:function(t){return this.elements.set(t),this},combine:function(t,e){var s=t.elements,r=e.elements,n=this.elements;return n[0]=s[0]<r[0]?s[0]:r[0],n[1]=s[1]<r[1]?s[1]:r[1],n[2]=s[2]<r[2]?s[2]:r[2],n[3]=s[3]>r[3]?s[3]:r[3],n[4]=s[4]>r[4]?s[4]:r[4],n[5]=s[5]>r[5]?s[5]:r[5],this},surfaceArea:function(){var t=this.elements,e=t[3]-t[0],s=t[4]-t[1],r=t[5]-t[2];return 2*(e*(s+r)+s*r)},intersectsWithPoint:function(t,e,s){var r=this.elements;return t>=r[0]&&t<=r[3]&&e>=r[1]&&e<=r[4]&&s>=r[2]&&s<=r[5]},setFromPoints:function(t){this.makeEmpty();for(var e=0;e<t.length;e++)this.expandByPoint(t[e])},makeEmpty:function(){this.set(-1/0,-1/0,-1/0,1/0,1/0,1/0)},expandByPoint:function(t){var e=this.elements;this.set(B.min(e[0],t.x),B.min(e[1],t.y),B.min(e[2],t.z),B.max(e[3],t.x),B.max(e[4],t.y),B.max(e[5],t.z))},expandByScalar:function(t){var e=this.elements;e[0]+=-t,e[1]+=-t,e[2]+=-t,e[3]+=t,e[4]+=t,e[5]+=t}});var Ev=0;function Dv(){return Ev++}function js(t){this.type=Mv,this.id=Dv(),this.prev=null,this.next=null,this.proxy=null,this.parent=null,this.contactLink=null,this.numContacts=0,this.position=new U,this.rotation=new ai,this.relativePosition=new U().copy(t.relativePosition),this.relativeRotation=new ai().copy(t.relativeRotation),this.aabb=new kl,this.density=t.density,this.friction=t.friction,this.restitution=t.restitution,this.belongsTo=t.belongsTo,this.collidesWith=t.collidesWith}Object.assign(js.prototype,{Shape:!0,calculateMassInfo:function(t){Ni("Shape","Inheritance error.")},updateProxy:function(){Ni("Shape","Inheritance error.")}});function ru(t,e,s,r){js.call(this,t),this.type=hr,this.width=e,this.height=s,this.depth=r,this.halfWidth=e*.5,this.halfHeight=s*.5,this.halfDepth=r*.5,this.dimentions=new Float32Array(18),this.elements=new Float32Array(24)}ru.prototype=Object.assign(Object.create(js.prototype),{constructor:ru,calculateMassInfo:function(t){var e=this.width*this.height*this.depth*this.density,s=1/12;t.mass=e,t.inertia.set(e*(this.height*this.height+this.depth*this.depth)*s,0,0,0,e*(this.width*this.width+this.depth*this.depth)*s,0,0,0,e*(this.width*this.width+this.height*this.height)*s)},updateProxy:function(){var t=this.rotation.elements,e=this.dimentions;e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e[9]=t[0]*this.halfWidth,e[10]=t[3]*this.halfWidth,e[11]=t[6]*this.halfWidth,e[12]=t[1]*this.halfHeight,e[13]=t[4]*this.halfHeight,e[14]=t[7]*this.halfHeight,e[15]=t[2]*this.halfDepth,e[16]=t[5]*this.halfDepth,e[17]=t[8]*this.halfDepth;var s=e[9],r=e[10],n=e[11],o=e[12],a=e[13],l=e[14],h=e[15],u=e[16],c=e[17],f=this.position.x,p=this.position.y,g=this.position.z,y=this.elements;y[0]=f+s+o+h,y[1]=p+r+a+u,y[2]=g+n+l+c,y[3]=f+s+o-h,y[4]=p+r+a-u,y[5]=g+n+l-c,y[6]=f+s-o+h,y[7]=p+r-a+u,y[8]=g+n-l+c,y[9]=f+s-o-h,y[10]=p+r-a-u,y[11]=g+n-l-c,y[12]=f-s+o+h,y[13]=p-r+a+u,y[14]=g-n+l+c,y[15]=f-s+o-h,y[16]=p-r+a-u,y[17]=g-n+l-c,y[18]=f-s-o+h,y[19]=p-r-a+u,y[20]=g-n-l+c,y[21]=f-s-o-h,y[22]=p-r-a-u,y[23]=g-n-l-c;var v=e[9]<0?-e[9]:e[9],z=e[10]<0?-e[10]:e[10],x=e[11]<0?-e[11]:e[11];v=e[12]<0?v-e[12]:v+e[12],z=e[13]<0?z-e[13]:z+e[13],x=e[14]<0?x-e[14]:x+e[14],v=e[15]<0?v-e[15]:v+e[15],z=e[16]<0?z-e[16]:z+e[16],x=e[17]<0?x-e[17]:x+e[17];var m=Sl;this.aabb.set(this.position.x-v-m,this.position.x+v+m,this.position.y-z-m,this.position.y+z+m,this.position.z-x-m,this.position.z+x+m),this.proxy!=null&&this.proxy.update()}});function nu(t,e){js.call(this,t),this.type=lr,this.radius=e}nu.prototype=Object.assign(Object.create(js.prototype),{constructor:nu,volume:function(){return B.PI*this.radius*1.333333},calculateMassInfo:function(t){var e=this.volume()*this.radius*this.radius*this.density;t.mass=e;var s=e*this.radius*this.radius*.4;t.inertia.set(s,0,0,0,s,0,0,0,s)},updateProxy:function(){var t=Sl;this.aabb.set(this.position.x-this.radius-t,this.position.x+this.radius+t,this.position.y-this.radius-t,this.position.y+this.radius+t,this.position.z-this.radius-t,this.position.z+this.radius+t),this.proxy!=null&&this.proxy.update()}});function ou(t,e,s){js.call(this,t),this.type=Wr,this.radius=e,this.height=s,this.halfHeight=s*.5,this.normalDirection=new U,this.halfDirection=new U}ou.prototype=Object.assign(Object.create(js.prototype),{constructor:ou,calculateMassInfo:function(t){var e=this.radius*this.radius,s=B.PI*e*this.height*this.density,r=(.25*e+.0833*this.height*this.height)*s,n=.5*e;t.mass=s,t.inertia.set(r,0,0,0,n,0,0,0,r)},updateProxy:function(){var t=this.rotation.elements,e,s,r,n,o,a,l,h,u,c,f;o=t[1]*t[1],a=t[4]*t[4],l=t[7]*t[7],this.normalDirection.set(t[1],t[4],t[7]),this.halfDirection.scale(this.normalDirection,this.halfHeight),s=1-o,e=B.sqrt(s*s+o*a+o*l),e>0&&(e=this.radius/e),s*=e,r=1-a,e=B.sqrt(a*o+r*r+a*l),e>0&&(e=this.radius/e),r*=e,n=1-l,e=B.sqrt(l*o+l*a+n*n),e>0&&(e=this.radius/e),n*=e,h=this.halfDirection.x<0?-this.halfDirection.x:this.halfDirection.x,u=this.halfDirection.y<0?-this.halfDirection.y:this.halfDirection.y,c=this.halfDirection.z<0?-this.halfDirection.z:this.halfDirection.z,h=s<0?h-s:h+s,u=r<0?u-r:u+r,c=n<0?c-n:c+n,f=Sl,this.aabb.set(this.position.x-h-f,this.position.x+h+f,this.position.y-u-f,this.position.y+u+f,this.position.z-c-f,this.position.z+c+f),this.proxy!=null&&this.proxy.update()}});function au(t,e){js.call(this,t),this.type=ho,this.normal=new U(0,1,0)}au.prototype=Object.assign(Object.create(js.prototype),{constructor:au,volume:function(){return Number.MAX_VALUE},calculateMassInfo:function(t){t.mass=this.density;var e=1;t.inertia.set(e,0,0,0,e,0,0,0,e)},updateProxy:function(){var t=Sl,e=-B.INF,s=B.INF,r=this.normal;this.aabb.set(r.x===-1?this.position.x-t:e,r.x===1?this.position.x+t:s,r.y===-1?this.position.y-t:e,r.y===1?this.position.y+t:s,r.z===-1?this.position.z-t:e,r.z===1?this.position.z+t:s),this.proxy!=null&&this.proxy.update()}});function Qf(t,e){js.call(this,t),this.type=Pv}Qf.prototype=Object.assign(Object.create(js.prototype),{constructor:Qf,volume:function(){return Number.MAX_VALUE},calculateMassInfo:function(t){var e=0;t.inertia.set(e,0,0,0,e,0,0,0,e)},updateProxy:function(){var t=0;this.aabb.set(this.position.x-t,this.position.x+t,this.position.y-t,this.position.y+t,this.position.z-t,this.position.z+t),this.proxy!=null&&this.proxy.update()}});function Av(){this.relativePosition=new U,this.relativeRotation=new ai,this.friction=.2,this.restitution=.2,this.density=1,this.belongsTo=1,this.collidesWith=4294967295}function ei(t,e){e=e||!1,this.axis=t,this.angle=0,this.lowerLimit=e?0:1,this.upperLimit=0,this.motorSpeed=0,this.maxMotorForce=0,this.frequency=0,this.dampingRatio=0}Object.assign(ei.prototype,{LimitMotor:!0,setLimit:function(t,e){this.lowerLimit=t,this.upperLimit=e},setMotor:function(t,e){this.motorSpeed=t,this.maxMotorForce=e},setSpring:function(t,e){this.frequency=t,this.dampingRatio=e}});function Go(){this.parent=null,this.body1=null,this.body2=null,this.addedToIsland=!1}Object.assign(Go.prototype,{Constraint:!0,preSolve:function(t,e){Ni("Constraint","Inheritance error.")},solve:function(){Ni("Constraint","Inheritance error.")},postSolve:function(){Ni("Constraint","Inheritance error.")}});function Yf(t){this.prev=null,this.next=null,this.body=null,this.joint=t}function cs(t){Go.call(this),this.scale=1,this.invScale=1,this.name="",this.id=NaN,this.type=_v,this.prev=null,this.next=null,this.body1=t.body1,this.body2=t.body2,this.localAnchorPoint1=new U().copy(t.localAnchorPoint1),this.localAnchorPoint2=new U().copy(t.localAnchorPoint2),this.relativeAnchorPoint1=new U,this.relativeAnchorPoint2=new U,this.anchorPoint1=new U,this.anchorPoint2=new U,this.allowCollision=t.allowCollision,this.b1Link=new Yf(this),this.b2Link=new Yf(this)}cs.prototype=Object.assign(Object.create(Go.prototype),{constructor:cs,setId:function(t){this.id=i},setParent:function(t){this.parent=t,this.scale=this.parent.scale,this.invScale=this.parent.invScale,this.id=this.parent.numJoints,this.name||(this.name="J"+this.id)},updateAnchorPoints:function(){this.relativeAnchorPoint1.copy(this.localAnchorPoint1).applyMatrix3(this.body1.rotation,!0),this.relativeAnchorPoint2.copy(this.localAnchorPoint2).applyMatrix3(this.body2.rotation,!0),this.anchorPoint1.add(this.relativeAnchorPoint1,this.body1.position),this.anchorPoint2.add(this.relativeAnchorPoint2,this.body2.position)},attach:function(t){this.b1Link.body=this.body2,this.b2Link.body=this.body1,t?(this.body1.jointLink.push(this.b1Link),this.body2.jointLink.push(this.b2Link)):(this.body1.jointLink!=null?(this.b1Link.next=this.body1.jointLink).prev=this.b1Link:this.b1Link.next=null,this.body1.jointLink=this.b1Link,this.body1.numJoints++,this.body2.jointLink!=null?(this.b2Link.next=this.body2.jointLink).prev=this.b2Link:this.b2Link.next=null,this.body2.jointLink=this.b2Link,this.body2.numJoints++)},detach:function(t){if(t)this.body1.jointLink.splice(this.body1.jointLink.indexOf(this.b1Link),1),this.body2.jointLink.splice(this.body2.jointLink.indexOf(this.b2Link),1);else{var e=this.b1Link.prev,s=this.b1Link.next;e!=null&&(e.next=s),s!=null&&(s.prev=e),this.body1.jointLink==this.b1Link&&(this.body1.jointLink=s),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.body=null,this.body1.numJoints--,e=this.b2Link.prev,s=this.b2Link.next,e!=null&&(e.next=s),s!=null&&(s.prev=e),this.body2.jointLink==this.b2Link&&(this.body2.jointLink=s),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.body=null,this.body2.numJoints--}this.b1Link.body=null,this.b2Link.body=null},awake:function(){this.body1.awake(),this.body2.awake()},preSolve:function(t,e){},solve:function(){},postSolve:function(){},remove:function(){this.dispose()},dispose:function(){this.parent.removeJoint(this)},getPosition:function(){var t=new U().scale(this.anchorPoint1,this.scale),e=new U().scale(this.anchorPoint2,this.scale);return[t,e]}});function Nc(t){this.m1=NaN,this.m2=NaN,this.ii1=null,this.ii2=null,this.dd=null,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.ax1x=NaN,this.ax1y=NaN,this.ax1z=NaN,this.ay1x=NaN,this.ay1y=NaN,this.ay1z=NaN,this.az1x=NaN,this.az1y=NaN,this.az1z=NaN,this.ax2x=NaN,this.ax2y=NaN,this.ax2z=NaN,this.ay2x=NaN,this.ay2y=NaN,this.ay2z=NaN,this.az2x=NaN,this.az2y=NaN,this.az2z=NaN,this.vel=NaN,this.velx=NaN,this.vely=NaN,this.velz=NaN,this.joint=t,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.b1=t.body1,this.b2=t.body2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.impx=0,this.impy=0,this.impz=0}Object.assign(Nc.prototype,{LinearConstraint:!0,preSolve:function(t,e){this.r1x=this.r1.x,this.r1y=this.r1.y,this.r1z=this.r1.z,this.r2x=this.r2.x,this.r2y=this.r2.y,this.r2z=this.r2.z,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass,this.ii1=this.i1.clone(),this.ii2=this.i2.clone();var s=this.ii1.elements,r=this.ii2.elements;this.ax1x=this.r1z*s[1]+-this.r1y*s[2],this.ax1y=this.r1z*s[4]+-this.r1y*s[5],this.ax1z=this.r1z*s[7]+-this.r1y*s[8],this.ay1x=-this.r1z*s[0]+this.r1x*s[2],this.ay1y=-this.r1z*s[3]+this.r1x*s[5],this.ay1z=-this.r1z*s[6]+this.r1x*s[8],this.az1x=this.r1y*s[0]+-this.r1x*s[1],this.az1y=this.r1y*s[3]+-this.r1x*s[4],this.az1z=this.r1y*s[6]+-this.r1x*s[7],this.ax2x=this.r2z*r[1]+-this.r2y*r[2],this.ax2y=this.r2z*r[4]+-this.r2y*r[5],this.ax2z=this.r2z*r[7]+-this.r2y*r[8],this.ay2x=-this.r2z*r[0]+this.r2x*r[2],this.ay2y=-this.r2z*r[3]+this.r2x*r[5],this.ay2z=-this.r2z*r[6]+this.r2x*r[8],this.az2x=this.r2y*r[0]+-this.r2x*r[1],this.az2y=this.r2y*r[3]+-this.r2x*r[4],this.az2z=this.r2y*r[6]+-this.r2x*r[7];var n=this.m1+this.m2,o=new ai().set(n,0,0,0,n,0,0,0,n),a=o.elements;a[0]+=s[4]*this.r1z*this.r1z-(s[7]+s[5])*this.r1y*this.r1z+s[8]*this.r1y*this.r1y,a[1]+=(s[6]*this.r1y+s[5]*this.r1x)*this.r1z-s[3]*this.r1z*this.r1z-s[8]*this.r1x*this.r1y,a[2]+=(s[3]*this.r1y-s[4]*this.r1x)*this.r1z-s[6]*this.r1y*this.r1y+s[7]*this.r1x*this.r1y,a[3]+=(s[2]*this.r1y+s[7]*this.r1x)*this.r1z-s[1]*this.r1z*this.r1z-s[8]*this.r1x*this.r1y,a[4]+=s[0]*this.r1z*this.r1z-(s[6]+s[2])*this.r1x*this.r1z+s[8]*this.r1x*this.r1x,a[5]+=(s[1]*this.r1x-s[0]*this.r1y)*this.r1z-s[7]*this.r1x*this.r1x+s[6]*this.r1x*this.r1y,a[6]+=(s[1]*this.r1y-s[4]*this.r1x)*this.r1z-s[2]*this.r1y*this.r1y+s[5]*this.r1x*this.r1y,a[7]+=(s[3]*this.r1x-s[0]*this.r1y)*this.r1z-s[5]*this.r1x*this.r1x+s[2]*this.r1x*this.r1y,a[8]+=s[0]*this.r1y*this.r1y-(s[3]+s[1])*this.r1x*this.r1y+s[4]*this.r1x*this.r1x,a[0]+=r[4]*this.r2z*this.r2z-(r[7]+r[5])*this.r2y*this.r2z+r[8]*this.r2y*this.r2y,a[1]+=(r[6]*this.r2y+r[5]*this.r2x)*this.r2z-r[3]*this.r2z*this.r2z-r[8]*this.r2x*this.r2y,a[2]+=(r[3]*this.r2y-r[4]*this.r2x)*this.r2z-r[6]*this.r2y*this.r2y+r[7]*this.r2x*this.r2y,a[3]+=(r[2]*this.r2y+r[7]*this.r2x)*this.r2z-r[1]*this.r2z*this.r2z-r[8]*this.r2x*this.r2y,a[4]+=r[0]*this.r2z*this.r2z-(r[6]+r[2])*this.r2x*this.r2z+r[8]*this.r2x*this.r2x,a[5]+=(r[1]*this.r2x-r[0]*this.r2y)*this.r2z-r[7]*this.r2x*this.r2x+r[6]*this.r2x*this.r2y,a[6]+=(r[1]*this.r2y-r[4]*this.r2x)*this.r2z-r[2]*this.r2y*this.r2y+r[5]*this.r2x*this.r2y,a[7]+=(r[3]*this.r2x-r[0]*this.r2y)*this.r2z-r[5]*this.r2x*this.r2x+r[2]*this.r2x*this.r2y,a[8]+=r[0]*this.r2y*this.r2y-(r[3]+r[1])*this.r2x*this.r2y+r[4]*this.r2x*this.r2x;var l=1/(a[0]*(a[4]*a[8]-a[7]*a[5])+a[3]*(a[7]*a[2]-a[1]*a[8])+a[6]*(a[1]*a[5]-a[4]*a[2]));this.dd=new ai().set(a[4]*a[8]-a[5]*a[7],a[2]*a[7]-a[1]*a[8],a[1]*a[5]-a[2]*a[4],a[5]*a[6]-a[3]*a[8],a[0]*a[8]-a[2]*a[6],a[2]*a[3]-a[0]*a[5],a[3]*a[7]-a[4]*a[6],a[1]*a[6]-a[0]*a[7],a[0]*a[4]-a[1]*a[3]).scaleEqual(l),this.velx=this.p2.x-this.p1.x,this.vely=this.p2.y-this.p1.y,this.velz=this.p2.z-this.p1.z;var h=B.sqrt(this.velx*this.velx+this.vely*this.vely+this.velz*this.velz);h>.005?(h=(.005-h)/h*e*.05,this.velx*=h,this.vely*=h,this.velz*=h):(this.velx=0,this.vely=0,this.velz=0),this.impx*=.95,this.impy*=.95,this.impz*=.95,this.l1.x+=this.impx*this.m1,this.l1.y+=this.impy*this.m1,this.l1.z+=this.impz*this.m1,this.a1.x+=this.impx*this.ax1x+this.impy*this.ay1x+this.impz*this.az1x,this.a1.y+=this.impx*this.ax1y+this.impy*this.ay1y+this.impz*this.az1y,this.a1.z+=this.impx*this.ax1z+this.impy*this.ay1z+this.impz*this.az1z,this.l2.x-=this.impx*this.m2,this.l2.y-=this.impy*this.m2,this.l2.z-=this.impz*this.m2,this.a2.x-=this.impx*this.ax2x+this.impy*this.ay2x+this.impz*this.az2x,this.a2.y-=this.impx*this.ax2y+this.impy*this.ay2y+this.impz*this.az2y,this.a2.z-=this.impx*this.ax2z+this.impy*this.ay2z+this.impz*this.az2z},solve:function(){var t=this.dd.elements,e=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y-this.velx,s=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z-this.vely,r=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x-this.velz,n=e*t[0]+s*t[1]+r*t[2],o=e*t[3]+s*t[4]+r*t[5],a=e*t[6]+s*t[7]+r*t[8];this.impx+=n,this.impy+=o,this.impz+=a,this.l1.x+=n*this.m1,this.l1.y+=o*this.m1,this.l1.z+=a*this.m1,this.a1.x+=n*this.ax1x+o*this.ay1x+a*this.az1x,this.a1.y+=n*this.ax1y+o*this.ay1y+a*this.az1y,this.a1.z+=n*this.ax1z+o*this.ay1z+a*this.az1z,this.l2.x-=n*this.m2,this.l2.y-=o*this.m2,this.l2.z-=a*this.m2,this.a2.x-=n*this.ax2x+o*this.ay2x+a*this.az2x,this.a2.y-=n*this.ax2y+o*this.ay2y+a*this.az2y,this.a2.z-=n*this.ax2z+o*this.ay2z+a*this.az2z}});function Ml(t,e,s,r){this.cfm1=NaN,this.cfm2=NaN,this.cfm3=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=e,this.limitMotor2=s,this.limitMotor3=r,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0}Object.assign(Ml.prototype,{Rotational3Constraint:!0,preSolve:function(t,e){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0;var s=this.i1.elements,r=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=r[0],this.i2e01=r[1],this.i2e02=r[2],this.i2e10=r[3],this.i2e11=r[4],this.i2e12=r[5],this.i2e20=r[6],this.i2e21=r[7],this.i2e22=r[8];var n=this.limitMotor1.frequency,o=this.limitMotor2.frequency,a=this.limitMotor3.frequency,l=n>0,h=o>0,u=a>0,c=this.lowerLimit1<=this.upperLimit1,f=this.lowerLimit2<=this.upperLimit2,p=this.lowerLimit3<=this.upperLimit3,g=this.limitMotor1.angle;c?(this.lowerLimit1==this.upperLimit1?(this.limitState1!=0&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-g):g<this.lowerLimit1?(this.limitState1!=-1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-g):g>this.upperLimit1?(this.limitState1!=1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-g):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),l||(this.limitVelocity1>.02?this.limitVelocity1-=.02:this.limitVelocity1<-.02?this.limitVelocity1+=.02:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0);var y=this.limitMotor2.angle;f?(this.lowerLimit2==this.upperLimit2?(this.limitState2!=0&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-y):y<this.lowerLimit2?(this.limitState2!=-1&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-y):y>this.upperLimit2?(this.limitState2!=1&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-y):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),h||(this.limitVelocity2>.02?this.limitVelocity2-=.02:this.limitVelocity2<-.02?this.limitVelocity2+=.02:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0);var v=this.limitMotor3.angle;if(p?(this.lowerLimit3==this.upperLimit3?(this.limitState3!=0&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-v):v<this.lowerLimit3?(this.limitState3!=-1&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-v):v>this.upperLimit3?(this.limitState3!=1&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-v):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),u||(this.limitVelocity3>.02?this.limitVelocity3-=.02:this.limitVelocity3<-.02?this.limitVelocity3+=.02:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(this.limitState1!=0||l)?this.maxMotorImpulse1=this.maxMotorForce1*t:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(this.limitState2!=0||h)?this.maxMotorImpulse2=this.maxMotorForce2*t:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(this.limitState3!=0||u)?this.maxMotorImpulse3=this.maxMotorForce3*t:(this.motorImpulse3=0,this.maxMotorImpulse3=0),this.a1x1=this.ax1*this.i1e00+this.ay1*this.i1e01+this.az1*this.i1e02,this.a1y1=this.ax1*this.i1e10+this.ay1*this.i1e11+this.az1*this.i1e12,this.a1z1=this.ax1*this.i1e20+this.ay1*this.i1e21+this.az1*this.i1e22,this.a2x1=this.ax1*this.i2e00+this.ay1*this.i2e01+this.az1*this.i2e02,this.a2y1=this.ax1*this.i2e10+this.ay1*this.i2e11+this.az1*this.i2e12,this.a2z1=this.ax1*this.i2e20+this.ay1*this.i2e21+this.az1*this.i2e22,this.a1x2=this.ax2*this.i1e00+this.ay2*this.i1e01+this.az2*this.i1e02,this.a1y2=this.ax2*this.i1e10+this.ay2*this.i1e11+this.az2*this.i1e12,this.a1z2=this.ax2*this.i1e20+this.ay2*this.i1e21+this.az2*this.i1e22,this.a2x2=this.ax2*this.i2e00+this.ay2*this.i2e01+this.az2*this.i2e02,this.a2y2=this.ax2*this.i2e10+this.ay2*this.i2e11+this.az2*this.i2e12,this.a2z2=this.ax2*this.i2e20+this.ay2*this.i2e21+this.az2*this.i2e22,this.a1x3=this.ax3*this.i1e00+this.ay3*this.i1e01+this.az3*this.i1e02,this.a1y3=this.ax3*this.i1e10+this.ay3*this.i1e11+this.az3*this.i1e12,this.a1z3=this.ax3*this.i1e20+this.ay3*this.i1e21+this.az3*this.i1e22,this.a2x3=this.ax3*this.i2e00+this.ay3*this.i2e01+this.az3*this.i2e02,this.a2y3=this.ax3*this.i2e10+this.ay3*this.i2e11+this.az3*this.i2e12,this.a2z3=this.ax3*this.i2e20+this.ay3*this.i2e21+this.az3*this.i2e22,this.k00=this.ax1*(this.a1x1+this.a2x1)+this.ay1*(this.a1y1+this.a2y1)+this.az1*(this.a1z1+this.a2z1),this.k01=this.ax1*(this.a1x2+this.a2x2)+this.ay1*(this.a1y2+this.a2y2)+this.az1*(this.a1z2+this.a2z2),this.k02=this.ax1*(this.a1x3+this.a2x3)+this.ay1*(this.a1y3+this.a2y3)+this.az1*(this.a1z3+this.a2z3),this.k10=this.ax2*(this.a1x1+this.a2x1)+this.ay2*(this.a1y1+this.a2y1)+this.az2*(this.a1z1+this.a2z1),this.k11=this.ax2*(this.a1x2+this.a2x2)+this.ay2*(this.a1y2+this.a2y2)+this.az2*(this.a1z2+this.a2z2),this.k12=this.ax2*(this.a1x3+this.a2x3)+this.ay2*(this.a1y3+this.a2y3)+this.az2*(this.a1z3+this.a2z3),this.k20=this.ax3*(this.a1x1+this.a2x1)+this.ay3*(this.a1y1+this.a2y1)+this.az3*(this.a1z1+this.a2z1),this.k21=this.ax3*(this.a1x2+this.a2x2)+this.ay3*(this.a1y2+this.a2y2)+this.az3*(this.a1z2+this.a2z2),this.k22=this.ax3*(this.a1x3+this.a2x3)+this.ay3*(this.a1y3+this.a2y3)+this.az3*(this.a1z3+this.a2z3),this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,l&&this.limitState1!=2){var z=6.2831853*n,x=z*z*t,m=e/(x+2*this.limitMotor1.dampingRatio*z);this.cfm1=this.kv00*m,this.limitVelocity1*=x*m}else this.cfm1=0,this.limitVelocity1*=e*.05;h&&this.limitState2!=2?(z=6.2831853*o,x=z*z*t,m=e/(x+2*this.limitMotor2.dampingRatio*z),this.cfm2=this.kv11*m,this.limitVelocity2*=x*m):(this.cfm2=0,this.limitVelocity2*=e*.05),u&&this.limitState3!=2?(z=6.2831853*a,x=z*z*t,m=e/(x+2*this.limitMotor3.dampingRatio*z),this.cfm3=this.kv22*m,this.limitVelocity3*=x*m):(this.cfm3=0,this.limitVelocity3*=e*.05),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var d=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*d,this.d01=(this.k02*this.k21-this.k01*this.k22)*d,this.d02=(this.k01*this.k12-this.k02*this.k11)*d,this.d10=(this.k12*this.k20-this.k10*this.k22)*d,this.d11=(this.k00*this.k22-this.k02*this.k20)*d,this.d12=(this.k02*this.k10-this.k00*this.k12)*d,this.d20=(this.k10*this.k21-this.k11*this.k20)*d,this.d21=(this.k01*this.k20-this.k00*this.k21)*d,this.d22=(this.k00*this.k11-this.k01*this.k10)*d,this.limitImpulse1*=.95,this.motorImpulse1*=.95,this.limitImpulse2*=.95,this.motorImpulse2*=.95,this.limitImpulse3*=.95,this.motorImpulse3*=.95;var w=this.limitImpulse1+this.motorImpulse1,N=this.limitImpulse2+this.motorImpulse2,S=this.limitImpulse3+this.motorImpulse3;this.a1.x+=w*this.a1x1+N*this.a1x2+S*this.a1x3,this.a1.y+=w*this.a1y1+N*this.a1y2+S*this.a1y3,this.a1.z+=w*this.a1z1+N*this.a1z2+S*this.a1z3,this.a2.x-=w*this.a2x1+N*this.a2x2+S*this.a2x3,this.a2.y-=w*this.a2y1+N*this.a2y2+S*this.a2y3,this.a2.z-=w*this.a2z1+N*this.a2z2+S*this.a2z3},solve_:function(){var t=this.a2.x-this.a1.x,e=this.a2.y-this.a1.y,s=this.a2.z-this.a1.z;this.limitVelocity3=30;var r=t*this.ax1+e*this.ay1+s*this.az1-this.limitVelocity1,n=t*this.ax2+e*this.ay2+s*this.az2-this.limitVelocity2,o=t*this.ax3+e*this.ay3+s*this.az3-this.limitVelocity3,a=r*this.d00+n*this.d01+o*this.d02,l=r*this.d10+n*this.d11+o*this.d12,h=r*this.d20+n*this.d21+o*this.d22;this.limitImpulse1+=a,this.limitImpulse2+=l,this.limitImpulse3+=h,this.a1.x+=a*this.a1x1+l*this.a1x2+h*this.a1x3,this.a1.y+=a*this.a1y1+l*this.a1y2+h*this.a1y3,this.a1.z+=a*this.a1z1+l*this.a1z2+h*this.a1z3,this.a2.x-=a*this.a2x1+l*this.a2x2+h*this.a2x3,this.a2.y-=a*this.a2y1+l*this.a2y2+h*this.a2y3,this.a2.z-=a*this.a2z1+l*this.a2z2+h*this.a2z3},solve:function(){var t=this.a2.x-this.a1.x,e=this.a2.y-this.a1.y,s=this.a2.z-this.a1.z,r=t*this.ax1+e*this.ay1+s*this.az1,n=t*this.ax2+e*this.ay2+s*this.az2,o=t*this.ax3+e*this.ay3+s*this.az3,a=this.motorImpulse1,l=this.motorImpulse2,h=this.motorImpulse3,u=0,c=0,f=0;this.enableMotor1&&(u=(r-this.motorSpeed1)*this.dv00,this.motorImpulse1+=u,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),u=this.motorImpulse1-a),this.enableMotor2&&(c=(n-this.motorSpeed2)*this.dv11,this.motorImpulse2+=c,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),c=this.motorImpulse2-l),this.enableMotor3&&(f=(o-this.motorSpeed3)*this.dv22,this.motorImpulse3+=f,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),f=this.motorImpulse3-h),r+=u*this.kv00+c*this.k01+f*this.k02,n+=u*this.k10+c*this.kv11+f*this.k12,o+=u*this.k20+c*this.k21+f*this.kv22,r-=this.limitVelocity1+this.limitImpulse1*this.cfm1,n-=this.limitVelocity2+this.limitImpulse2*this.cfm2,o-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var p=this.limitImpulse1,g=this.limitImpulse2,y=this.limitImpulse3,v=r*this.d00+n*this.d01+o*this.d02,z=r*this.d10+n*this.d11+o*this.d12,x=r*this.d20+n*this.d21+o*this.d22;this.limitImpulse1+=v,this.limitImpulse2+=z,this.limitImpulse3+=x;var m=0;(this.limitState1==2||this.limitImpulse1*this.limitState1<0)&&(v=-p,n+=v*this.k10,o+=v*this.k20,m|=1),(this.limitState2==2||this.limitImpulse2*this.limitState2<0)&&(z=-g,r+=z*this.k01,o+=z*this.k21,m|=2),(this.limitState3==2||this.limitImpulse3*this.limitState3<0)&&(x=-y,r+=x*this.k02,n+=x*this.k12,m|=4);var d;switch(m){case 1:d=1/(this.k11*this.k22-this.k12*this.k21),z=(this.k22*n+-this.k12*o)*d,x=(-this.k21*n+this.k11*o)*d;break;case 2:d=1/(this.k00*this.k22-this.k02*this.k20),v=(this.k22*r+-this.k02*o)*d,x=(-this.k20*r+this.k00*o)*d;break;case 3:x=o/this.k22;break;case 4:d=1/(this.k00*this.k11-this.k01*this.k10),v=(this.k11*r+-this.k01*n)*d,z=(-this.k10*r+this.k00*n)*d;break;case 5:z=n/this.k11;break;case 6:v=r/this.k00;break}this.limitImpulse1=v+p,this.limitImpulse2=z+g,this.limitImpulse3=x+y;var w=u+v,N=c+z,S=f+x;this.a1.x+=w*this.a1x1+N*this.a1x2+S*this.a1x3,this.a1.y+=w*this.a1y1+N*this.a1y2+S*this.a1y3,this.a1.z+=w*this.a1z1+N*this.a1z2+S*this.a1z3,this.a2.x-=w*this.a2x1+N*this.a2x2+S*this.a2x3,this.a2.y-=w*this.a2y1+N*this.a2y2+S*this.a2y3,this.a2.z-=w*this.a2z1+N*this.a2z2+S*this.a2z3,t=this.a2.x-this.a1.x,e=this.a2.y-this.a1.y,s=this.a2.z-this.a1.z,n=t*this.ax2+e*this.ay2+s*this.az2}});function lu(t,e,s){cs.call(this,t),this.type=Iv,this.localAxis1=t.localAxis1.clone().normalize(),this.localAxis2=t.localAxis2.clone().normalize();var r=new ai().setQuat(new Si().setFromUnitVectors(this.localAxis1,this.localAxis2));this.localAngle1=new U().tangent(this.localAxis1).normalize(),this.localAngle2=this.localAngle1.clone().applyMatrix3(r,!0),this.ax1=new U,this.ax2=new U,this.an1=new U,this.an2=new U,this.tmp=new U,this.nor=new U,this.tan=new U,this.bin=new U,this.limitMotor=new ei(this.nor,!1),this.limitMotor.lowerLimit=e,this.limitMotor.upperLimit=s,this.lc=new Nc(this),this.r3=new Ml(this,this.limitMotor,new ei(this.tan,!0),new ei(this.bin,!0))}lu.prototype=Object.assign(Object.create(cs.prototype),{constructor:lu,preSolve:function(t,e){this.updateAnchorPoints(),this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation,!0),this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation,!0),this.an1.copy(this.localAngle1).applyMatrix3(this.body1.rotation,!0),this.an2.copy(this.localAngle2).applyMatrix3(this.body2.rotation,!0),this.nor.set(this.ax1.x*this.body2.inverseMass+this.ax2.x*this.body1.inverseMass,this.ax1.y*this.body2.inverseMass+this.ax2.y*this.body1.inverseMass,this.ax1.z*this.body2.inverseMass+this.ax2.z*this.body1.inverseMass).normalize(),this.tan.tangent(this.nor).normalize(),this.bin.crossVectors(this.nor,this.tan);var s=B.acosClamp(B.dotVectors(this.an1,this.an2));this.tmp.crossVectors(this.an1,this.an2),B.dotVectors(this.nor,this.tmp)<0?this.limitMotor.angle=-s:this.limitMotor.angle=s,this.tmp.crossVectors(this.ax1,this.ax2),this.r3.limitMotor2.angle=B.dotVectors(this.tan,this.tmp),this.r3.limitMotor3.angle=B.dotVectors(this.bin,this.tmp),this.r3.preSolve(t,e),this.lc.preSolve(t,e)},solve:function(){this.r3.solve(),this.lc.solve()},postSolve:function(){}});function hu(t){cs.call(this,t),this.type=Vv,this.lc=new Nc(this)}hu.prototype=Object.assign(Object.create(cs.prototype),{constructor:hu,preSolve:function(t,e){this.updateAnchorPoints(),this.lc.preSolve(t,e)},solve:function(){this.lc.solve()},postSolve:function(){}});function Nd(t,e){this.cfm=NaN,this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.motorDenom=NaN,this.invMotorDenom=NaN,this.invDenom=NaN,this.ax=NaN,this.ay=NaN,this.az=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x=NaN,this.t1y=NaN,this.t1z=NaN,this.t2x=NaN,this.t2y=NaN,this.t2z=NaN,this.l1x=NaN,this.l1y=NaN,this.l1z=NaN,this.l2x=NaN,this.l2y=NaN,this.l2z=NaN,this.a1x=NaN,this.a1y=NaN,this.a1z=NaN,this.a2x=NaN,this.a2y=NaN,this.a2z=NaN,this.lowerLimit=NaN,this.upperLimit=NaN,this.limitVelocity=NaN,this.limitState=0,this.enableMotor=!1,this.motorSpeed=NaN,this.maxMotorForce=NaN,this.maxMotorImpulse=NaN,this.limitMotor=e,this.b1=t.body1,this.b2=t.body2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse=0,this.motorImpulse=0}Object.assign(Nd.prototype,{TranslationalConstraint:!0,preSolve:function(t,e){this.ax=this.limitMotor.axis.x,this.ay=this.limitMotor.axis.y,this.az=this.limitMotor.axis.z,this.lowerLimit=this.limitMotor.lowerLimit,this.upperLimit=this.limitMotor.upperLimit,this.motorSpeed=this.limitMotor.motorSpeed,this.maxMotorForce=this.limitMotor.maxMotorForce,this.enableMotor=this.maxMotorForce>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var s=this.i1.elements,r=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=r[0],this.i2e01=r[1],this.i2e02=r[2],this.i2e10=r[3],this.i2e11=r[4],this.i2e12=r[5],this.i2e20=r[6],this.i2e21=r[7],this.i2e22=r[8];var n=this.p2.x-this.p1.x,o=this.p2.y-this.p1.y,a=this.p2.z-this.p1.z,l=n*this.ax+o*this.ay+a*this.az,h=this.limitMotor.frequency,u=h>0,c=this.lowerLimit<=this.upperLimit;(u&&l>20||l<-20)&&(u=!1),c?(this.lowerLimit==this.upperLimit?(this.limitState!=0&&(this.limitState=0,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-l,u||(l=this.lowerLimit)):l<this.lowerLimit?(this.limitState!=-1&&(this.limitState=-1,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-l,u||(l=this.lowerLimit)):l>this.upperLimit?(this.limitState!=1&&(this.limitState=1,this.limitImpulse=0),this.limitVelocity=this.upperLimit-l,u||(l=this.upperLimit)):(this.limitState=2,this.limitImpulse=0,this.limitVelocity=0),u||(this.limitVelocity>.005?this.limitVelocity-=.005:this.limitVelocity<-.005?this.limitVelocity+=.005:this.limitVelocity=0)):(this.limitState=2,this.limitImpulse=0),this.enableMotor&&(this.limitState!=0||u)?this.maxMotorImpulse=this.maxMotorForce*t:(this.motorImpulse=0,this.maxMotorImpulse=0);var f=l*this.ax,p=l*this.ay,g=l*this.az,y=this.m1/(this.m1+this.m2),v=1-y;if(this.r1x=this.r1.x+f*y,this.r1y=this.r1.y+p*y,this.r1z=this.r1.z+g*y,this.r2x=this.r2.x-f*v,this.r2y=this.r2.y-p*v,this.r2z=this.r2.z-g*v,this.t1x=this.r1y*this.az-this.r1z*this.ay,this.t1y=this.r1z*this.ax-this.r1x*this.az,this.t1z=this.r1x*this.ay-this.r1y*this.ax,this.t2x=this.r2y*this.az-this.r2z*this.ay,this.t2y=this.r2z*this.ax-this.r2x*this.az,this.t2z=this.r2x*this.ay-this.r2y*this.ax,this.l1x=this.ax*this.m1,this.l1y=this.ay*this.m1,this.l1z=this.az*this.m1,this.l2x=this.ax*this.m2,this.l2y=this.ay*this.m2,this.l2z=this.az*this.m2,this.a1x=this.t1x*this.i1e00+this.t1y*this.i1e01+this.t1z*this.i1e02,this.a1y=this.t1x*this.i1e10+this.t1y*this.i1e11+this.t1z*this.i1e12,this.a1z=this.t1x*this.i1e20+this.t1y*this.i1e21+this.t1z*this.i1e22,this.a2x=this.t2x*this.i2e00+this.t2y*this.i2e01+this.t2z*this.i2e02,this.a2y=this.t2x*this.i2e10+this.t2y*this.i2e11+this.t2z*this.i2e12,this.a2z=this.t2x*this.i2e20+this.t2y*this.i2e21+this.t2z*this.i2e22,this.motorDenom=this.m1+this.m2+this.ax*(this.a1y*this.r1z-this.a1z*this.r1y+this.a2y*this.r2z-this.a2z*this.r2y)+this.ay*(this.a1z*this.r1x-this.a1x*this.r1z+this.a2z*this.r2x-this.a2x*this.r2z)+this.az*(this.a1x*this.r1y-this.a1y*this.r1x+this.a2x*this.r2y-this.a2y*this.r2x),this.invMotorDenom=1/this.motorDenom,u&&this.limitState!=2){var z=6.2831853*h,x=z*z*t,m=e/(x+2*this.limitMotor.dampingRatio*z);this.cfm=this.motorDenom*m,this.limitVelocity*=x*m}else this.cfm=0,this.limitVelocity*=e*.05;this.invDenom=1/(this.motorDenom+this.cfm);var d=this.limitImpulse+this.motorImpulse;this.l1.x+=d*this.l1x,this.l1.y+=d*this.l1y,this.l1.z+=d*this.l1z,this.a1.x+=d*this.a1x,this.a1.y+=d*this.a1y,this.a1.z+=d*this.a1z,this.l2.x-=d*this.l2x,this.l2.y-=d*this.l2y,this.l2.z-=d*this.l2z,this.a2.x-=d*this.a2x,this.a2.y-=d*this.a2y,this.a2.z-=d*this.a2z},solve:function(){var t=this.ax*(this.l2.x-this.l1.x)+this.ay*(this.l2.y-this.l1.y)+this.az*(this.l2.z-this.l1.z)+this.t2x*this.a2.x-this.t1x*this.a1.x+this.t2y*this.a2.y-this.t1y*this.a1.y+this.t2z*this.a2.z-this.t1z*this.a1.z,e;if(this.enableMotor){e=(t-this.motorSpeed)*this.invMotorDenom;var s=this.motorImpulse;this.motorImpulse+=e,this.motorImpulse>this.maxMotorImpulse?this.motorImpulse=this.maxMotorImpulse:this.motorImpulse<-this.maxMotorImpulse&&(this.motorImpulse=-this.maxMotorImpulse),e=this.motorImpulse-s,t-=e*this.motorDenom}else e=0;var r;if(this.limitState!=2){r=(t-this.limitVelocity-this.limitImpulse*this.cfm)*this.invDenom;var n=this.limitImpulse;this.limitImpulse+=r,this.limitImpulse*this.limitState<0&&(this.limitImpulse=0),r=this.limitImpulse-n}else r=0;var o=r+e;this.l1.x+=o*this.l1x,this.l1.y+=o*this.l1y,this.l1.z+=o*this.l1z,this.a1.x+=o*this.a1x,this.a1.y+=o*this.a1y,this.a1.z+=o*this.a1z,this.l2.x-=o*this.l2x,this.l2.y-=o*this.l2y,this.l2.z-=o*this.l2z,this.a2.x-=o*this.a2x,this.a2.y-=o*this.a2y,this.a2.z-=o*this.a2z}});function uu(t,e,s){cs.call(this,t),this.type=Lv,this.nor=new U,this.limitMotor=new ei(this.nor,!0),this.limitMotor.lowerLimit=e,this.limitMotor.upperLimit=s,this.t=new Nd(this,this.limitMotor)}uu.prototype=Object.assign(Object.create(cs.prototype),{constructor:uu,preSolve:function(t,e){this.updateAnchorPoints(),this.nor.sub(this.anchorPoint2,this.anchorPoint1).normalize(),this.t.preSolve(t,e)},solve:function(){this.t.solve()},postSolve:function(){}});function Sd(t,e){this.joint=t,this.targetOrientation=new Si().invert(e),this.relativeOrientation=new Si,this.ii1=null,this.ii2=null,this.dd=null,this.vel=new U,this.imp=new U,this.rn0=new U,this.rn1=new U,this.rn2=new U,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia}Object.assign(Sd.prototype,{AngularConstraint:!0,preSolve:function(t,e){var s,r,n;this.ii1=this.i1.clone(),this.ii2=this.i2.clone(),n=new ai().add(this.ii1,this.ii2).elements,s=1/(n[0]*(n[4]*n[8]-n[7]*n[5])+n[3]*(n[7]*n[2]-n[1]*n[8])+n[6]*(n[1]*n[5]-n[4]*n[2])),this.dd=new ai().set(n[4]*n[8]-n[5]*n[7],n[2]*n[7]-n[1]*n[8],n[1]*n[5]-n[2]*n[4],n[5]*n[6]-n[3]*n[8],n[0]*n[8]-n[2]*n[6],n[2]*n[3]-n[0]*n[5],n[3]*n[7]-n[4]*n[6],n[1]*n[6]-n[0]*n[7],n[0]*n[4]-n[1]*n[3]).multiplyScalar(s),this.relativeOrientation.invert(this.b1.orientation).multiply(this.targetOrientation).multiply(this.b2.orientation),s=this.relativeOrientation.w*2,this.vel.copy(this.relativeOrientation).multiplyScalar(s),r=this.vel.length(),r>.02?(r=(.02-r)/r*e*.05,this.vel.multiplyScalar(r)):this.vel.set(0,0,0),this.rn1.copy(this.imp).applyMatrix3(this.ii1,!0),this.rn2.copy(this.imp).applyMatrix3(this.ii2,!0),this.a1.add(this.rn1),this.a2.sub(this.rn2)},solve:function(){var t=this.a2.clone().sub(this.a1).sub(this.vel);this.rn0.copy(t).applyMatrix3(this.dd,!0),this.rn1.copy(this.rn0).applyMatrix3(this.ii1,!0),this.rn2.copy(this.rn0).applyMatrix3(this.ii2,!0),this.imp.add(this.rn0),this.a1.add(this.rn1),this.a2.sub(this.rn2)}});function Pl(t,e,s,r){this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x1=NaN,this.t1y1=NaN,this.t1z1=NaN,this.t2x1=NaN,this.t2y1=NaN,this.t2z1=NaN,this.l1x1=NaN,this.l1y1=NaN,this.l1z1=NaN,this.l2x1=NaN,this.l2y1=NaN,this.l2z1=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.t1x2=NaN,this.t1y2=NaN,this.t1z2=NaN,this.t2x2=NaN,this.t2y2=NaN,this.t2z2=NaN,this.l1x2=NaN,this.l1y2=NaN,this.l1z2=NaN,this.l2x2=NaN,this.l2y2=NaN,this.l2z2=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.t1x3=NaN,this.t1y3=NaN,this.t1z3=NaN,this.t2x3=NaN,this.t2y3=NaN,this.t2z3=NaN,this.l1x3=NaN,this.l1y3=NaN,this.l1z3=NaN,this.l2x3=NaN,this.l2y3=NaN,this.l2z3=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=e,this.limitMotor2=s,this.limitMotor3=r,this.b1=t.body1,this.b2=t.body2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0,this.cfm1=0,this.cfm2=0,this.cfm3=0,this.weight=-1}Object.assign(Pl.prototype,{Translational3Constraint:!0,preSolve:function(t,e){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var s=this.i1.elements,r=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=r[0],this.i2e01=r[1],this.i2e02=r[2],this.i2e10=r[3],this.i2e11=r[4],this.i2e12=r[5],this.i2e20=r[6],this.i2e21=r[7],this.i2e22=r[8];var n=this.p2.x-this.p1.x,o=this.p2.y-this.p1.y,a=this.p2.z-this.p1.z,l=n*this.ax1+o*this.ay1+a*this.az1,h=n*this.ax2+o*this.ay2+a*this.az2,u=n*this.ax3+o*this.ay3+a*this.az3,c=this.limitMotor1.frequency,f=this.limitMotor2.frequency,p=this.limitMotor3.frequency,g=c>0,y=f>0,v=p>0,z=this.lowerLimit1<=this.upperLimit1,x=this.lowerLimit2<=this.upperLimit2,m=this.lowerLimit3<=this.upperLimit3;(g&&l>20||l<-20)&&(g=!1),(y&&h>20||h<-20)&&(y=!1),(v&&u>20||u<-20)&&(v=!1),z?(this.lowerLimit1==this.upperLimit1?(this.limitState1!=0&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-l,g||(l=this.lowerLimit1)):l<this.lowerLimit1?(this.limitState1!=-1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-l,g||(l=this.lowerLimit1)):l>this.upperLimit1?(this.limitState1!=1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-l,g||(l=this.upperLimit1)):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),g||(this.limitVelocity1>.005?this.limitVelocity1-=.005:this.limitVelocity1<-.005?this.limitVelocity1+=.005:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0),x?(this.lowerLimit2==this.upperLimit2?(this.limitState2!=0&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-h,y||(h=this.lowerLimit2)):h<this.lowerLimit2?(this.limitState2!=-1&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-h,y||(h=this.lowerLimit2)):h>this.upperLimit2?(this.limitState2!=1&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-h,y||(h=this.upperLimit2)):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),y||(this.limitVelocity2>.005?this.limitVelocity2-=.005:this.limitVelocity2<-.005?this.limitVelocity2+=.005:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0),m?(this.lowerLimit3==this.upperLimit3?(this.limitState3!=0&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-u,v||(u=this.lowerLimit3)):u<this.lowerLimit3?(this.limitState3!=-1&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-u,v||(u=this.lowerLimit3)):u>this.upperLimit3?(this.limitState3!=1&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-u,v||(u=this.upperLimit3)):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),v||(this.limitVelocity3>.005?this.limitVelocity3-=.005:this.limitVelocity3<-.005?this.limitVelocity3+=.005:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(this.limitState1!=0||g)?this.maxMotorImpulse1=this.maxMotorForce1*t:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(this.limitState2!=0||y)?this.maxMotorImpulse2=this.maxMotorForce2*t:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(this.limitState3!=0||v)?this.maxMotorImpulse3=this.maxMotorForce3*t:(this.motorImpulse3=0,this.maxMotorImpulse3=0);var d=l*this.ax1+h*this.ax2+u*this.ax2,w=l*this.ay1+h*this.ay2+u*this.ay2,N=l*this.az1+h*this.az2+u*this.az2,S=this.m2/(this.m1+this.m2);this.weight>=0&&(S=this.weight);var k=1-S;this.r1x=this.r1.x+d*S,this.r1y=this.r1.y+w*S,this.r1z=this.r1.z+N*S,this.r2x=this.r2.x-d*k,this.r2y=this.r2.y-w*k,this.r2z=this.r2.z-N*k,this.t1x1=this.r1y*this.az1-this.r1z*this.ay1,this.t1y1=this.r1z*this.ax1-this.r1x*this.az1,this.t1z1=this.r1x*this.ay1-this.r1y*this.ax1,this.t2x1=this.r2y*this.az1-this.r2z*this.ay1,this.t2y1=this.r2z*this.ax1-this.r2x*this.az1,this.t2z1=this.r2x*this.ay1-this.r2y*this.ax1,this.l1x1=this.ax1*this.m1,this.l1y1=this.ay1*this.m1,this.l1z1=this.az1*this.m1,this.l2x1=this.ax1*this.m2,this.l2y1=this.ay1*this.m2,this.l2z1=this.az1*this.m2,this.a1x1=this.t1x1*this.i1e00+this.t1y1*this.i1e01+this.t1z1*this.i1e02,this.a1y1=this.t1x1*this.i1e10+this.t1y1*this.i1e11+this.t1z1*this.i1e12,this.a1z1=this.t1x1*this.i1e20+this.t1y1*this.i1e21+this.t1z1*this.i1e22,this.a2x1=this.t2x1*this.i2e00+this.t2y1*this.i2e01+this.t2z1*this.i2e02,this.a2y1=this.t2x1*this.i2e10+this.t2y1*this.i2e11+this.t2z1*this.i2e12,this.a2z1=this.t2x1*this.i2e20+this.t2y1*this.i2e21+this.t2z1*this.i2e22,this.t1x2=this.r1y*this.az2-this.r1z*this.ay2,this.t1y2=this.r1z*this.ax2-this.r1x*this.az2,this.t1z2=this.r1x*this.ay2-this.r1y*this.ax2,this.t2x2=this.r2y*this.az2-this.r2z*this.ay2,this.t2y2=this.r2z*this.ax2-this.r2x*this.az2,this.t2z2=this.r2x*this.ay2-this.r2y*this.ax2,this.l1x2=this.ax2*this.m1,this.l1y2=this.ay2*this.m1,this.l1z2=this.az2*this.m1,this.l2x2=this.ax2*this.m2,this.l2y2=this.ay2*this.m2,this.l2z2=this.az2*this.m2,this.a1x2=this.t1x2*this.i1e00+this.t1y2*this.i1e01+this.t1z2*this.i1e02,this.a1y2=this.t1x2*this.i1e10+this.t1y2*this.i1e11+this.t1z2*this.i1e12,this.a1z2=this.t1x2*this.i1e20+this.t1y2*this.i1e21+this.t1z2*this.i1e22,this.a2x2=this.t2x2*this.i2e00+this.t2y2*this.i2e01+this.t2z2*this.i2e02,this.a2y2=this.t2x2*this.i2e10+this.t2y2*this.i2e11+this.t2z2*this.i2e12,this.a2z2=this.t2x2*this.i2e20+this.t2y2*this.i2e21+this.t2z2*this.i2e22,this.t1x3=this.r1y*this.az3-this.r1z*this.ay3,this.t1y3=this.r1z*this.ax3-this.r1x*this.az3,this.t1z3=this.r1x*this.ay3-this.r1y*this.ax3,this.t2x3=this.r2y*this.az3-this.r2z*this.ay3,this.t2y3=this.r2z*this.ax3-this.r2x*this.az3,this.t2z3=this.r2x*this.ay3-this.r2y*this.ax3,this.l1x3=this.ax3*this.m1,this.l1y3=this.ay3*this.m1,this.l1z3=this.az3*this.m1,this.l2x3=this.ax3*this.m2,this.l2y3=this.ay3*this.m2,this.l2z3=this.az3*this.m2,this.a1x3=this.t1x3*this.i1e00+this.t1y3*this.i1e01+this.t1z3*this.i1e02,this.a1y3=this.t1x3*this.i1e10+this.t1y3*this.i1e11+this.t1z3*this.i1e12,this.a1z3=this.t1x3*this.i1e20+this.t1y3*this.i1e21+this.t1z3*this.i1e22,this.a2x3=this.t2x3*this.i2e00+this.t2y3*this.i2e01+this.t2z3*this.i2e02,this.a2y3=this.t2x3*this.i2e10+this.t2y3*this.i2e11+this.t2z3*this.i2e12,this.a2z3=this.t2x3*this.i2e20+this.t2y3*this.i2e21+this.t2z3*this.i2e22;var O=this.m1+this.m2;if(this.k00=(this.ax1*this.ax1+this.ay1*this.ay1+this.az1*this.az1)*O,this.k01=(this.ax1*this.ax2+this.ay1*this.ay2+this.az1*this.az2)*O,this.k02=(this.ax1*this.ax3+this.ay1*this.ay3+this.az1*this.az3)*O,this.k10=(this.ax2*this.ax1+this.ay2*this.ay1+this.az2*this.az1)*O,this.k11=(this.ax2*this.ax2+this.ay2*this.ay2+this.az2*this.az2)*O,this.k12=(this.ax2*this.ax3+this.ay2*this.ay3+this.az2*this.az3)*O,this.k20=(this.ax3*this.ax1+this.ay3*this.ay1+this.az3*this.az1)*O,this.k21=(this.ax3*this.ax2+this.ay3*this.ay2+this.az3*this.az2)*O,this.k22=(this.ax3*this.ax3+this.ay3*this.ay3+this.az3*this.az3)*O,this.k00+=this.t1x1*this.a1x1+this.t1y1*this.a1y1+this.t1z1*this.a1z1,this.k01+=this.t1x1*this.a1x2+this.t1y1*this.a1y2+this.t1z1*this.a1z2,this.k02+=this.t1x1*this.a1x3+this.t1y1*this.a1y3+this.t1z1*this.a1z3,this.k10+=this.t1x2*this.a1x1+this.t1y2*this.a1y1+this.t1z2*this.a1z1,this.k11+=this.t1x2*this.a1x2+this.t1y2*this.a1y2+this.t1z2*this.a1z2,this.k12+=this.t1x2*this.a1x3+this.t1y2*this.a1y3+this.t1z2*this.a1z3,this.k20+=this.t1x3*this.a1x1+this.t1y3*this.a1y1+this.t1z3*this.a1z1,this.k21+=this.t1x3*this.a1x2+this.t1y3*this.a1y2+this.t1z3*this.a1z2,this.k22+=this.t1x3*this.a1x3+this.t1y3*this.a1y3+this.t1z3*this.a1z3,this.k00+=this.t2x1*this.a2x1+this.t2y1*this.a2y1+this.t2z1*this.a2z1,this.k01+=this.t2x1*this.a2x2+this.t2y1*this.a2y2+this.t2z1*this.a2z2,this.k02+=this.t2x1*this.a2x3+this.t2y1*this.a2y3+this.t2z1*this.a2z3,this.k10+=this.t2x2*this.a2x1+this.t2y2*this.a2y1+this.t2z2*this.a2z1,this.k11+=this.t2x2*this.a2x2+this.t2y2*this.a2y2+this.t2z2*this.a2z2,this.k12+=this.t2x2*this.a2x3+this.t2y2*this.a2y3+this.t2z2*this.a2z3,this.k20+=this.t2x3*this.a2x1+this.t2y3*this.a2y1+this.t2z3*this.a2z1,this.k21+=this.t2x3*this.a2x2+this.t2y3*this.a2y2+this.t2z3*this.a2z2,this.k22+=this.t2x3*this.a2x3+this.t2y3*this.a2y3+this.t2z3*this.a2z3,this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,g&&this.limitState1!=2){var E=6.2831853*c,M=E*E*t,R=e/(M+2*this.limitMotor1.dampingRatio*E);this.cfm1=this.kv00*R,this.limitVelocity1*=M*R}else this.cfm1=0,this.limitVelocity1*=e*.05;y&&this.limitState2!=2?(E=6.2831853*f,M=E*E*t,R=e/(M+2*this.limitMotor2.dampingRatio*E),this.cfm2=this.kv11*R,this.limitVelocity2*=M*R):(this.cfm2=0,this.limitVelocity2*=e*.05),v&&this.limitState3!=2?(E=6.2831853*p,M=E*E*t,R=e/(M+2*this.limitMotor3.dampingRatio*E),this.cfm3=this.kv22*R,this.limitVelocity3*=M*R):(this.cfm3=0,this.limitVelocity3*=e*.05),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var D=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*D,this.d01=(this.k02*this.k21-this.k01*this.k22)*D,this.d02=(this.k01*this.k12-this.k02*this.k11)*D,this.d10=(this.k12*this.k20-this.k10*this.k22)*D,this.d11=(this.k00*this.k22-this.k02*this.k20)*D,this.d12=(this.k02*this.k10-this.k00*this.k12)*D,this.d20=(this.k10*this.k21-this.k11*this.k20)*D,this.d21=(this.k01*this.k20-this.k00*this.k21)*D,this.d22=(this.k00*this.k11-this.k01*this.k10)*D;var A=this.limitImpulse1+this.motorImpulse1,P=this.limitImpulse2+this.motorImpulse2,st=this.limitImpulse3+this.motorImpulse3;this.l1.x+=A*this.l1x1+P*this.l1x2+st*this.l1x3,this.l1.y+=A*this.l1y1+P*this.l1y2+st*this.l1y3,this.l1.z+=A*this.l1z1+P*this.l1z2+st*this.l1z3,this.a1.x+=A*this.a1x1+P*this.a1x2+st*this.a1x3,this.a1.y+=A*this.a1y1+P*this.a1y2+st*this.a1y3,this.a1.z+=A*this.a1z1+P*this.a1z2+st*this.a1z3,this.l2.x-=A*this.l2x1+P*this.l2x2+st*this.l2x3,this.l2.y-=A*this.l2y1+P*this.l2y2+st*this.l2y3,this.l2.z-=A*this.l2z1+P*this.l2z2+st*this.l2z3,this.a2.x-=A*this.a2x1+P*this.a2x2+st*this.a2x3,this.a2.y-=A*this.a2y1+P*this.a2y2+st*this.a2y3,this.a2.z-=A*this.a2z1+P*this.a2z2+st*this.a2z3},solve:function(){var t=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y,e=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z,s=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x,r=t*this.ax1+e*this.ay1+s*this.az1,n=t*this.ax2+e*this.ay2+s*this.az2,o=t*this.ax3+e*this.ay3+s*this.az3,a=this.motorImpulse1,l=this.motorImpulse2,h=this.motorImpulse3,u=0,c=0,f=0;this.enableMotor1&&(u=(r-this.motorSpeed1)*this.dv00,this.motorImpulse1+=u,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),u=this.motorImpulse1-a),this.enableMotor2&&(c=(n-this.motorSpeed2)*this.dv11,this.motorImpulse2+=c,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),c=this.motorImpulse2-l),this.enableMotor3&&(f=(o-this.motorSpeed3)*this.dv22,this.motorImpulse3+=f,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),f=this.motorImpulse3-h),r+=u*this.kv00+c*this.k01+f*this.k02,n+=u*this.k10+c*this.kv11+f*this.k12,o+=u*this.k20+c*this.k21+f*this.kv22,r-=this.limitVelocity1+this.limitImpulse1*this.cfm1,n-=this.limitVelocity2+this.limitImpulse2*this.cfm2,o-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var p=this.limitImpulse1,g=this.limitImpulse2,y=this.limitImpulse3,v=r*this.d00+n*this.d01+o*this.d02,z=r*this.d10+n*this.d11+o*this.d12,x=r*this.d20+n*this.d21+o*this.d22;this.limitImpulse1+=v,this.limitImpulse2+=z,this.limitImpulse3+=x;var m=0;(this.limitState1==2||this.limitImpulse1*this.limitState1<0)&&(v=-p,n+=v*this.k10,o+=v*this.k20,m|=1),(this.limitState2==2||this.limitImpulse2*this.limitState2<0)&&(z=-g,r+=z*this.k01,o+=z*this.k21,m|=2),(this.limitState3==2||this.limitImpulse3*this.limitState3<0)&&(x=-y,r+=x*this.k02,n+=x*this.k12,m|=4);var d;switch(m){case 1:d=1/(this.k11*this.k22-this.k12*this.k21),z=(this.k22*n+-this.k12*o)*d,x=(-this.k21*n+this.k11*o)*d;break;case 2:d=1/(this.k00*this.k22-this.k02*this.k20),v=(this.k22*r+-this.k02*o)*d,x=(-this.k20*r+this.k00*o)*d;break;case 3:x=o/this.k22;break;case 4:d=1/(this.k00*this.k11-this.k01*this.k10),v=(this.k11*r+-this.k01*n)*d,z=(-this.k10*r+this.k00*n)*d;break;case 5:z=n/this.k11;break;case 6:v=r/this.k00;break}this.limitImpulse1=p+v,this.limitImpulse2=g+z,this.limitImpulse3=y+x;var w=u+v,N=c+z,S=f+x;this.l1.x+=w*this.l1x1+N*this.l1x2+S*this.l1x3,this.l1.y+=w*this.l1y1+N*this.l1y2+S*this.l1y3,this.l1.z+=w*this.l1z1+N*this.l1z2+S*this.l1z3,this.a1.x+=w*this.a1x1+N*this.a1x2+S*this.a1x3,this.a1.y+=w*this.a1y1+N*this.a1y2+S*this.a1y3,this.a1.z+=w*this.a1z1+N*this.a1z2+S*this.a1z3,this.l2.x-=w*this.l2x1+N*this.l2x2+S*this.l2x3,this.l2.y-=w*this.l2y1+N*this.l2y2+S*this.l2y3,this.l2.z-=w*this.l2z1+N*this.l2z2+S*this.l2z3,this.a2.x-=w*this.a2x1+N*this.a2x2+S*this.a2x3,this.a2.y-=w*this.a2y1+N*this.a2y2+S*this.a2y3,this.a2.z-=w*this.a2z1+N*this.a2z2+S*this.a2z3}});function cu(t,e,s){cs.call(this,t),this.type=bv,this.localAxis1=t.localAxis1.clone().normalize(),this.localAxis2=t.localAxis2.clone().normalize(),this.ax1=new U,this.ax2=new U,this.nor=new U,this.tan=new U,this.bin=new U,this.ac=new Sd(this,new Si().setFromUnitVectors(this.localAxis1,this.localAxis2)),this.limitMotor=new ei(this.nor,!0),this.limitMotor.lowerLimit=e,this.limitMotor.upperLimit=s,this.t3=new Pl(this,this.limitMotor,new ei(this.tan,!0),new ei(this.bin,!0))}cu.prototype=Object.assign(Object.create(cs.prototype),{constructor:cu,preSolve:function(t,e){this.updateAnchorPoints(),this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation,!0),this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation,!0),this.nor.set(this.ax1.x*this.body2.inverseMass+this.ax2.x*this.body1.inverseMass,this.ax1.y*this.body2.inverseMass+this.ax2.y*this.body1.inverseMass,this.ax1.z*this.body2.inverseMass+this.ax2.z*this.body1.inverseMass).normalize(),this.tan.tangent(this.nor).normalize(),this.bin.crossVectors(this.nor,this.tan),this.ac.preSolve(t,e),this.t3.preSolve(t,e)},solve:function(){this.ac.solve(),this.t3.solve()},postSolve:function(){}});function fu(t,e,s){cs.call(this,t),this.type=Tv,this.localAxis1=t.localAxis1.clone().normalize(),this.localAxis2=t.localAxis2.clone().normalize();var r=new ai().setQuat(new Si().setFromUnitVectors(this.localAxis1,this.localAxis2));this.localAngle1=new U().tangent(this.localAxis1).normalize(),this.localAngle2=this.localAngle1.clone().applyMatrix3(r,!0),this.ax1=new U,this.ax2=new U,this.an1=new U,this.an2=new U,this.tmp=new U,this.nor=new U,this.tan=new U,this.bin=new U,this.rotationalLimitMotor=new ei(this.nor,!1),this.r3=new Ml(this,this.rotationalLimitMotor,new ei(this.tan,!0),new ei(this.bin,!0)),this.translationalLimitMotor=new ei(this.nor,!0),this.translationalLimitMotor.lowerLimit=e,this.translationalLimitMotor.upperLimit=s,this.t3=new Pl(this,this.translationalLimitMotor,new ei(this.tan,!0),new ei(this.bin,!0))}fu.prototype=Object.assign(Object.create(cs.prototype),{constructor:fu,preSolve:function(t,e){this.updateAnchorPoints(),this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation,!0),this.an1.copy(this.localAngle1).applyMatrix3(this.body1.rotation,!0),this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation,!0),this.an2.copy(this.localAngle2).applyMatrix3(this.body2.rotation,!0),this.nor.set(this.ax1.x*this.body2.inverseMass+this.ax2.x*this.body1.inverseMass,this.ax1.y*this.body2.inverseMass+this.ax2.y*this.body1.inverseMass,this.ax1.z*this.body2.inverseMass+this.ax2.z*this.body1.inverseMass).normalize(),this.tan.tangent(this.nor).normalize(),this.bin.crossVectors(this.nor,this.tan),this.tmp.crossVectors(this.an1,this.an2);var s=B.acosClamp(B.dotVectors(this.an1,this.an2));B.dotVectors(this.nor,this.tmp)<0?this.rotationalLimitMotor.angle=-s:this.rotationalLimitMotor.angle=s,this.tmp.crossVectors(this.ax1,this.ax2),this.r3.limitMotor2.angle=B.dotVectors(this.tan,this.tmp),this.r3.limitMotor3.angle=B.dotVectors(this.bin,this.tmp),this.r3.preSolve(t,e),this.t3.preSolve(t,e)},solve:function(){this.r3.solve(),this.t3.solve()},postSolve:function(){}});function pu(t){cs.call(this,t),this.type=Cv,this.localAxis1=t.localAxis1.clone().normalize(),this.localAxis2=t.localAxis2.clone().normalize(),this.localAngle1=new U,this.localAngle2=new U;var e=B.dotVectors(this.localAxis1,this.localAxis2);if(e>-1&&e<1)this.localAngle1.set(this.localAxis2.x-e*this.localAxis1.x,this.localAxis2.y-e*this.localAxis1.y,this.localAxis2.z-e*this.localAxis1.z).normalize(),this.localAngle2.set(this.localAxis1.x-e*this.localAxis2.x,this.localAxis1.y-e*this.localAxis2.y,this.localAxis1.z-e*this.localAxis2.z).normalize();else{var s=new ai().setQuat(new Si().setFromUnitVectors(this.localAxis1,this.localAxis2));this.localAngle1.tangent(this.localAxis1).normalize(),this.localAngle2=this.localAngle1.clone().applyMatrix3(s,!0)}this.ax1=new U,this.ax2=new U,this.an1=new U,this.an2=new U,this.tmp=new U,this.nor=new U,this.tan=new U,this.bin=new U,this.translationalLimitMotor=new ei(this.tan,!0),this.translationalLimitMotor.frequency=8,this.translationalLimitMotor.dampingRatio=1,this.rotationalLimitMotor1=new ei(this.tan,!1),this.rotationalLimitMotor2=new ei(this.bin,!1),this.t3=new Pl(this,new ei(this.nor,!0),this.translationalLimitMotor,new ei(this.bin,!0)),this.t3.weight=1,this.r3=new Ml(this,new ei(this.nor,!0),this.rotationalLimitMotor1,this.rotationalLimitMotor2)}pu.prototype=Object.assign(Object.create(cs.prototype),{constructor:pu,preSolve:function(t,e){this.updateAnchorPoints(),this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation,!0),this.an1.copy(this.localAngle1).applyMatrix3(this.body1.rotation,!0),this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation,!0),this.an2.copy(this.localAngle2).applyMatrix3(this.body2.rotation,!0),this.r3.limitMotor1.angle=B.dotVectors(this.ax1,this.ax2);var s=B.dotVectors(this.an1,this.ax2);B.dotVectors(this.ax1,this.tmp.crossVectors(this.an1,this.ax2))<0?this.rotationalLimitMotor1.angle=-s:this.rotationalLimitMotor1.angle=s,s=B.dotVectors(this.an2,this.ax1),B.dotVectors(this.ax2,this.tmp.crossVectors(this.an2,this.ax1))<0?this.rotationalLimitMotor2.angle=-s:this.rotationalLimitMotor2.angle=s,this.nor.crossVectors(this.ax1,this.ax2).normalize(),this.tan.crossVectors(this.nor,this.ax2).normalize(),this.bin.crossVectors(this.nor,this.ax1).normalize(),this.r3.preSolve(t,e),this.t3.preSolve(t,e)},solve:function(){this.r3.solve(),this.t3.solve()},postSolve:function(){}});function Fv(){this.scale=1,this.invScale=1,this.body1=null,this.body2=null,this.localAnchorPoint1=new U,this.localAnchorPoint2=new U,this.localAxis1=new U,this.localAxis2=new U,this.allowCollision=!1}function Rv(){this.mass=0,this.inertia=new ai}function ca(t){this.prev=null,this.next=null,this.shape=null,this.body=null,this.contact=t}function fa(){this.lp1X=NaN,this.lp1Y=NaN,this.lp1Z=NaN,this.lp2X=NaN,this.lp2Y=NaN,this.lp2Z=NaN,this.impulse=NaN}function pa(){this.warmStarted=!1,this.position=new U,this.localPoint1=new U,this.localPoint2=new U,this.normal=new U,this.tangent=new U,this.binormal=new U,this.normalImpulse=0,this.tangentImpulse=0,this.binormalImpulse=0,this.normalDenominator=0,this.tangentDenominator=0,this.binormalDenominator=0,this.penetration=0}function du(){this.body1=null,this.body2=null,this.numPoints=0,this.points=[new pa,new pa,new pa,new pa]}du.prototype={constructor:du,reset:function(t,e){this.body1=t.parent,this.body2=e.parent,this.numPoints=0},addPointVec:function(t,e,s,r){var n=this.points[this.numPoints++];n.position.copy(t),n.localPoint1.sub(t,this.body1.position).applyMatrix3(this.body1.rotation),n.localPoint2.sub(t,this.body2.position).applyMatrix3(this.body2.rotation),n.normal.copy(e),r&&n.normal.negate(),n.normalImpulse=0,n.penetration=s,n.warmStarted=!1},addPoint:function(t,e,s,r,n,o,a,l){var h=this.points[this.numPoints++];h.position.set(t,e,s),h.localPoint1.sub(h.position,this.body1.position).applyMatrix3(this.body1.rotation),h.localPoint2.sub(h.position,this.body2.position).applyMatrix3(this.body2.rotation),h.normalImpulse=0,h.normal.set(r,n,o),l&&h.normal.negate(),h.penetration=a,h.warmStarted=!1}};function da(){this.nor=new U,this.tan=new U,this.bin=new U,this.norU1=new U,this.tanU1=new U,this.binU1=new U,this.norU2=new U,this.tanU2=new U,this.binU2=new U,this.norT1=new U,this.tanT1=new U,this.binT1=new U,this.norT2=new U,this.tanT2=new U,this.binT2=new U,this.norTU1=new U,this.tanTU1=new U,this.binTU1=new U,this.norTU2=new U,this.tanTU2=new U,this.binTU2=new U,this.norImp=0,this.tanImp=0,this.binImp=0,this.norDen=0,this.tanDen=0,this.binDen=0,this.norTar=0,this.next=null,this.last=!1}function mu(t){Go.call(this),this.manifold=t,this.restitution=NaN,this.friction=NaN,this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null,this.tmp=new U,this.tmpC1=new U,this.tmpC2=new U,this.tmpP1=new U,this.tmpP2=new U,this.tmplv1=new U,this.tmplv2=new U,this.tmpav1=new U,this.tmpav2=new U,this.m1=NaN,this.m2=NaN,this.num=0,this.ps=t.points,this.cs=new da,this.cs.next=new da,this.cs.next.next=new da,this.cs.next.next.next=new da}mu.prototype=Object.assign(Object.create(Go.prototype),{constructor:mu,attach:function(){this.p1=this.body1.position,this.p2=this.body2.position,this.lv1=this.body1.linearVelocity,this.av1=this.body1.angularVelocity,this.lv2=this.body2.linearVelocity,this.av2=this.body2.angularVelocity,this.i1=this.body1.inverseInertia,this.i2=this.body2.inverseInertia},detach:function(){this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null},preSolve:function(t,e){this.m1=this.body1.inverseMass,this.m2=this.body2.inverseMass;var s=this.m1+this.m2;this.num=this.manifold.numPoints;for(var r=this.cs,n,o,a,l,h,u,c,f,p=0;p<this.num;p++)n=this.ps[p],this.tmpP1.sub(n.position,this.p1),this.tmpP2.sub(n.position,this.p2),this.tmpC1.crossVectors(this.av1,this.tmpP1),this.tmpC2.crossVectors(this.av2,this.tmpP2),r.norImp=n.normalImpulse,r.tanImp=n.tangentImpulse,r.binImp=n.binormalImpulse,r.nor.copy(n.normal),this.tmp.set(this.lv2.x+this.tmpC2.x-(this.lv1.x+this.tmpC1.x),this.lv2.y+this.tmpC2.y-(this.lv1.y+this.tmpC1.y),this.lv2.z+this.tmpC2.z-(this.lv1.z+this.tmpC1.z)),o=B.dotVectors(r.nor,this.tmp),r.tan.set(this.tmp.x-o*r.nor.x,this.tmp.y-o*r.nor.y,this.tmp.z-o*r.nor.z),a=B.dotVectors(r.tan,r.tan),a<=.04&&r.tan.tangent(r.nor),r.tan.normalize(),r.bin.crossVectors(r.nor,r.tan),r.norU1.scale(r.nor,this.m1),r.norU2.scale(r.nor,this.m2),r.tanU1.scale(r.tan,this.m1),r.tanU2.scale(r.tan,this.m2),r.binU1.scale(r.bin,this.m1),r.binU2.scale(r.bin,this.m2),r.norT1.crossVectors(this.tmpP1,r.nor),r.tanT1.crossVectors(this.tmpP1,r.tan),r.binT1.crossVectors(this.tmpP1,r.bin),r.norT2.crossVectors(this.tmpP2,r.nor),r.tanT2.crossVectors(this.tmpP2,r.tan),r.binT2.crossVectors(this.tmpP2,r.bin),c=this.i1,f=this.i2,r.norTU1.copy(r.norT1).applyMatrix3(c,!0),r.tanTU1.copy(r.tanT1).applyMatrix3(c,!0),r.binTU1.copy(r.binT1).applyMatrix3(c,!0),r.norTU2.copy(r.norT2).applyMatrix3(f,!0),r.tanTU2.copy(r.tanT2).applyMatrix3(f,!0),r.binTU2.copy(r.binT2).applyMatrix3(f,!0),this.tmpC1.crossVectors(r.norTU1,this.tmpP1),this.tmpC2.crossVectors(r.norTU2,this.tmpP2),this.tmp.add(this.tmpC1,this.tmpC2),r.norDen=1/(s+B.dotVectors(r.nor,this.tmp)),this.tmpC1.crossVectors(r.tanTU1,this.tmpP1),this.tmpC2.crossVectors(r.tanTU2,this.tmpP2),this.tmp.add(this.tmpC1,this.tmpC2),r.tanDen=1/(s+B.dotVectors(r.tan,this.tmp)),this.tmpC1.crossVectors(r.binTU1,this.tmpP1),this.tmpC2.crossVectors(r.binTU2,this.tmpP2),this.tmp.add(this.tmpC1,this.tmpC2),r.binDen=1/(s+B.dotVectors(r.bin,this.tmp)),n.warmStarted?(l=n.normalImpulse,this.lv1.addScaledVector(r.norU1,l),this.av1.addScaledVector(r.norTU1,l),this.lv2.subScaledVector(r.norU2,l),this.av2.subScaledVector(r.norTU2,l),r.norImp=l,r.tanImp=0,r.binImp=0,o=0):(r.norImp=0,r.tanImp=0,r.binImp=0),o>-1&&(o=0),h=this.restitution*-o,u=-(n.penetration+.005)*e*.05,h<u&&(h=u),r.norTar=h,r.last=p==this.num-1,r=r.next},solve:function(){this.tmplv1.copy(this.lv1),this.tmplv2.copy(this.lv2),this.tmpav1.copy(this.av1),this.tmpav2.copy(this.av2);for(var t,e,s,r,n,o,a,l,h,u,c=this.cs;o=c.norImp,a=c.tanImp,l=c.binImp,h=-o*this.friction,this.tmp.sub(this.tmplv2,this.tmplv1),n=B.dotVectors(this.tmp,c.tan)+B.dotVectors(this.tmpav2,c.tanT2)-B.dotVectors(this.tmpav1,c.tanT1),t=a,e=n*c.tanDen,a+=e,n=B.dotVectors(this.tmp,c.bin)+B.dotVectors(this.tmpav2,c.binT2)-B.dotVectors(this.tmpav1,c.binT1),s=l,r=n*c.binDen,l+=r,u=a*a+l*l,u>h*h&&(u=h/B.sqrt(u),a*=u,l*=u),e=a-t,r=l-s,this.tmp.set(c.tanU1.x*e+c.binU1.x*r,c.tanU1.y*e+c.binU1.y*r,c.tanU1.z*e+c.binU1.z*r),this.tmplv1.addEqual(this.tmp),this.tmp.set(c.tanTU1.x*e+c.binTU1.x*r,c.tanTU1.y*e+c.binTU1.y*r,c.tanTU1.z*e+c.binTU1.z*r),this.tmpav1.addEqual(this.tmp),this.tmp.set(c.tanU2.x*e+c.binU2.x*r,c.tanU2.y*e+c.binU2.y*r,c.tanU2.z*e+c.binU2.z*r),this.tmplv2.subEqual(this.tmp),this.tmp.set(c.tanTU2.x*e+c.binTU2.x*r,c.tanTU2.y*e+c.binTU2.y*r,c.tanTU2.z*e+c.binTU2.z*r),this.tmpav2.subEqual(this.tmp),this.tmp.sub(this.tmplv2,this.tmplv1),n=B.dotVectors(this.tmp,c.nor)+B.dotVectors(this.tmpav2,c.norT2)-B.dotVectors(this.tmpav1,c.norT1),t=o,e=(n-c.norTar)*c.norDen,o+=e,o>0&&(o=0),e=o-t,this.tmplv1.addScaledVector(c.norU1,e),this.tmpav1.addScaledVector(c.norTU1,e),this.tmplv2.subScaledVector(c.norU2,e),this.tmpav2.subScaledVector(c.norTU2,e),c.norImp=o,c.tanImp=a,c.binImp=l,!c.last;)c=c.next;this.lv1.copy(this.tmplv1),this.lv2.copy(this.tmplv2),this.av1.copy(this.tmpav1),this.av2.copy(this.tmpav2)},postSolve:function(){for(var t=this.cs,e,s=this.num;s--;)e=this.ps[s],e.normal.copy(t.nor),e.tangent.copy(t.tan),e.binormal.copy(t.bin),e.normalImpulse=t.norImp,e.tangentImpulse=t.tanImp,e.binormalImpulse=t.binImp,e.normalDenominator=t.norDen,e.tangentDenominator=t.tanDen,e.binormalDenominator=t.binDen,t=t.next}});function kd(){this.shape1=null,this.shape2=null,this.body1=null,this.body2=null,this.prev=null,this.next=null,this.persisting=!1,this.sleeping=!1,this.detector=null,this.constraint=null,this.touching=!1,this.close=!1,this.dist=B.INF,this.b1Link=new ca(this),this.b2Link=new ca(this),this.s1Link=new ca(this),this.s2Link=new ca(this),this.manifold=new du,this.buffer=[new fa,new fa,new fa,new fa],this.points=this.manifold.points,this.constraint=new mu(this.manifold)}Object.assign(kd.prototype,{Contact:!0,mixRestitution:function(t,e){return B.sqrt(t*e)},mixFriction:function(t,e){return B.sqrt(t*e)},updateManifold:function(){this.constraint.restitution=this.mixRestitution(this.shape1.restitution,this.shape2.restitution),this.constraint.friction=this.mixFriction(this.shape1.friction,this.shape2.friction);for(var t=this.manifold.numPoints,e=t;e--;){var s=this.buffer[e],r=this.points[e];s.lp1X=r.localPoint1.x,s.lp1Y=r.localPoint1.y,s.lp1Z=r.localPoint1.z,s.lp2X=r.localPoint2.x,s.lp2Y=r.localPoint2.y,s.lp2Z=r.localPoint2.z,s.impulse=r.normalImpulse}this.manifold.numPoints=0,this.detector.detectCollision(this.shape1,this.shape2,this.manifold);var n=this.manifold.numPoints;if(n==0){this.touching=!1,this.close=!1,this.dist=B.INF;return}for((this.touching||this.dist<.001)&&(this.close=!0),this.touching=!0,e=n;e--;){r=this.points[e];for(var o=r.localPoint1.x,a=r.localPoint1.y,l=r.localPoint1.z,h=r.localPoint2.x,u=r.localPoint2.y,c=r.localPoint2.z,f=-1,p=4e-4,g=t;g--;){s=this.buffer[g];var y=s.lp1X-o,v=s.lp1Y-a,z=s.lp1Z-l,x=y*y+v*v+z*z;y=s.lp2X-h,v=s.lp2Y-u,z=s.lp2Z-c;var m=y*y+v*v+z*z;x<m?x<p&&(p=x,f=g):m<p&&(p=m,f=g),p<this.dist&&(this.dist=p)}if(f!=-1){var d=this.buffer[f];this.buffer[f]=this.buffer[--t],this.buffer[t]=d,r.normalImpulse=d.impulse,r.warmStarted=!0}else r.normalImpulse=0,r.warmStarted=!1}},attach:function(t,e){this.shape1=t,this.shape2=e,this.body1=t.parent,this.body2=e.parent,this.manifold.body1=this.body1,this.manifold.body2=this.body2,this.constraint.body1=this.body1,this.constraint.body2=this.body2,this.constraint.attach(),this.s1Link.shape=e,this.s1Link.body=this.body2,this.s2Link.shape=t,this.s2Link.body=this.body1,t.contactLink!=null?(this.s1Link.next=t.contactLink).prev=this.s1Link:this.s1Link.next=null,t.contactLink=this.s1Link,t.numContacts++,e.contactLink!=null?(this.s2Link.next=e.contactLink).prev=this.s2Link:this.s2Link.next=null,e.contactLink=this.s2Link,e.numContacts++,this.b1Link.shape=e,this.b1Link.body=this.body2,this.b2Link.shape=t,this.b2Link.body=this.body1,this.body1.contactLink!=null?(this.b1Link.next=this.body1.contactLink).prev=this.b1Link:this.b1Link.next=null,this.body1.contactLink=this.b1Link,this.body1.numContacts++,this.body2.contactLink!=null?(this.b2Link.next=this.body2.contactLink).prev=this.b2Link:this.b2Link.next=null,this.body2.contactLink=this.b2Link,this.body2.numContacts++,this.prev=null,this.next=null,this.persisting=!0,this.sleeping=this.body1.sleeping&&this.body2.sleeping,this.manifold.numPoints=0},detach:function(){var t=this.s1Link.prev,e=this.s1Link.next;t!==null&&(t.next=e),e!==null&&(e.prev=t),this.shape1.contactLink==this.s1Link&&(this.shape1.contactLink=e),this.s1Link.prev=null,this.s1Link.next=null,this.s1Link.shape=null,this.s1Link.body=null,this.shape1.numContacts--,t=this.s2Link.prev,e=this.s2Link.next,t!==null&&(t.next=e),e!==null&&(e.prev=t),this.shape2.contactLink==this.s2Link&&(this.shape2.contactLink=e),this.s2Link.prev=null,this.s2Link.next=null,this.s2Link.shape=null,this.s2Link.body=null,this.shape2.numContacts--,t=this.b1Link.prev,e=this.b1Link.next,t!==null&&(t.next=e),e!==null&&(e.prev=t),this.body1.contactLink==this.b1Link&&(this.body1.contactLink=e),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.shape=null,this.b1Link.body=null,this.body1.numContacts--,t=this.b2Link.prev,e=this.b2Link.next,t!==null&&(t.next=e),e!==null&&(e.prev=t),this.body2.contactLink==this.b2Link&&(this.body2.contactLink=e),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.shape=null,this.b2Link.body=null,this.body2.numContacts--,this.manifold.body1=null,this.manifold.body2=null,this.constraint.body1=null,this.constraint.body2=null,this.constraint.detach(),this.shape1=null,this.shape2=null,this.body1=null,this.body2=null}});function pn(t,e){this.position=t||new U,this.orientation=e||new Si,this.scale=1,this.invScale=1,this.mesh=null,this.id=NaN,this.name="",this.prev=null,this.next=null,this.type=kv,this.massInfo=new Rv,this.newPosition=new U,this.controlPos=!1,this.newOrientation=new Si,this.newRotation=new U,this.currentRotation=new U,this.controlRot=!1,this.controlRotInTime=!1,this.quaternion=new Si,this.pos=new U,this.linearVelocity=new U,this.angularVelocity=new U,this.parent=null,this.contactLink=null,this.numContacts=0,this.shapes=null,this.numShapes=0,this.jointLink=null,this.numJoints=0,this.sleepPosition=new U,this.sleepOrientation=new Si,this.isStatic=!1,this.isDynamic=!1,this.isKinematic=!1,this.rotation=new ai,this.mass=0,this.inverseMass=0,this.inverseInertia=new ai,this.localInertia=new ai,this.inverseLocalInertia=new ai,this.tmpInertia=new ai,this.addedToIsland=!1,this.allowSleep=!0,this.sleepTime=0,this.sleeping=!1}Object.assign(pn.prototype,{setParent:function(t){this.parent=t,this.scale=this.parent.scale,this.invScale=this.parent.invScale,this.id=this.parent.numRigidBodies,this.name||(this.name=this.id),this.updateMesh()},addShape:function(t){t.parent&&Ni("RigidBody","It is not possible that you add a shape which already has an associated body."),this.shapes!=null&&((this.shapes.prev=t).next=this.shapes),this.shapes=t,t.parent=this,this.parent&&this.parent.addShape(t),this.numShapes++},removeShape:function(t){var e=t;if(e.parent==this){var s=e.prev,r=e.next;s!=null&&(s.next=r),r!=null&&(r.prev=s),this.shapes==e&&(this.shapes=r),e.prev=null,e.next=null,e.parent=null,this.parent&&this.parent.removeShape(e),this.numShapes--}},remove:function(){this.dispose()},dispose:function(){this.parent.removeRigidBody(this)},checkContact:function(t){this.parent.checkContact(this.name,t)},setupMass:function(t,e){var s=e!==void 0?e:!0;this.type=t||lo,this.isDynamic=this.type===el,this.isStatic=this.type===lo,this.mass=0,this.localInertia.set(0,0,0,0,0,0,0,0,0);for(var r=new ai,n=new U,o=this.shapes;o!==null;o=o.next){o.calculateMassInfo(this.massInfo);var a=this.massInfo.mass;n.addScaledVector(o.relativePosition,a),this.mass+=a,this.rotateInertia(o.relativeRotation,this.massInfo.inertia,r),this.localInertia.add(r),this.localInertia.addOffset(a,o.relativePosition)}if(this.inverseMass=1/this.mass,n.scaleEqual(this.inverseMass),s){for(this.position.add(n),o=this.shapes;o!==null;o=o.next)o.relativePosition.subEqual(n);this.localInertia.subOffset(this.mass,n)}this.inverseLocalInertia.invert(this.localInertia),this.type===lo&&(this.inverseMass=0,this.inverseLocalInertia.set(0,0,0,0,0,0,0,0,0)),this.syncShapes(),this.awake()},awake:function(){if(!(!this.allowSleep||!this.sleeping)){this.sleeping=!1,this.sleepTime=0;for(var t=this.contactLink;t!=null;)t.body.sleepTime=0,t.body.sleeping=!1,t=t.next;for(var e=this.jointLink;e!=null;)e.body.sleepTime=0,e.body.sleeping=!1,e=e.next;for(var s=this.shapes;s!=null;s=s.next)s.updateProxy()}},sleep:function(){if(!(!this.allowSleep||this.sleeping)){this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.sleepPosition.copy(this.position),this.sleepOrientation.copy(this.orientation),this.sleepTime=0,this.sleeping=!0;for(var t=this.shapes;t!=null;t=t.next)t.updateProxy()}},testWakeUp:function(){(this.linearVelocity.testZero()||this.angularVelocity.testZero()||this.position.testDiff(this.sleepPosition)||this.orientation.testDiff(this.sleepOrientation))&&this.awake()},isLonely:function(){return this.numJoints==0&&this.numContacts==0},updatePosition:function(t){switch(this.type){case lo:this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.controlPos&&(this.position.copy(this.newPosition),this.controlPos=!1),this.controlRot&&(this.orientation.copy(this.newOrientation),this.controlRot=!1);break;case el:this.isKinematic&&(this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0)),this.controlPos&&(this.linearVelocity.subVectors(this.newPosition,this.position).multiplyScalar(1/t),this.controlPos=!1),this.controlRot&&(this.angularVelocity.copy(this.getAxis()),this.orientation.copy(this.newOrientation),this.controlRot=!1),this.position.addScaledVector(this.linearVelocity,t),this.orientation.addTime(this.angularVelocity,t),this.updateMesh();break;default:Ni("RigidBody","Invalid type.")}this.syncShapes(),this.updateMesh()},getAxis:function(){return new U(0,1,0).applyMatrix3(this.inverseLocalInertia,!0).normalize()},rotateInertia:function(t,e,s){this.tmpInertia.multiplyMatrices(t,e),s.multiplyMatrices(this.tmpInertia,t,!0)},syncShapes:function(){this.rotation.setQuat(this.orientation),this.rotateInertia(this.rotation,this.inverseLocalInertia,this.inverseInertia);for(var t=this.shapes;t!=null;t=t.next)t.position.copy(t.relativePosition).applyMatrix3(this.rotation,!0).add(this.position),t.rotation.multiplyMatrices(this.rotation,t.relativeRotation),t.updateProxy()},applyImpulse:function(t,e){this.linearVelocity.addScaledVector(e,this.inverseMass);var s=new U().copy(t).sub(this.position).cross(e).applyMatrix3(this.inverseInertia,!0);this.angularVelocity.add(s)},setPosition:function(t){this.newPosition.copy(t).multiplyScalar(this.invScale),this.controlPos=!0,this.isKinematic||(this.isKinematic=!0)},setQuaternion:function(t){this.newOrientation.set(t.x,t.y,t.z,t.w),this.controlRot=!0,this.isKinematic||(this.isKinematic=!0)},setRotation:function(t){this.newOrientation=new Si().setFromEuler(t.x*B.degtorad,t.y*B.degtorad,t.y*B.degtorad),this.controlRot=!0},resetPosition:function(t,e,s){this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.position.set(t,e,s).multiplyScalar(this.invScale),this.awake()},resetQuaternion:function(t){this.angularVelocity.set(0,0,0),this.orientation=new Si(t.x,t.y,t.z,t.w),this.awake()},resetRotation:function(t,e,s){this.angularVelocity.set(0,0,0),this.orientation=new Si().setFromEuler(t*B.degtorad,e*B.degtorad,s*B.degtorad),this.awake()},getPosition:function(){return this.pos},getQuaternion:function(){return this.quaternion},connectMesh:function(t){this.mesh=t,this.updateMesh()},updateMesh:function(){this.pos.scale(this.position,this.scale),this.quaternion.copy(this.orientation),this.mesh!==null&&(this.mesh.position.copy(this.getPosition()),this.mesh.quaternion.copy(this.getQuaternion()))}});function Ov(t,e){this.shape1=t||null,this.shape2=e||null}function an(){this.types=wv,this.numPairChecks=0,this.numPairs=0,this.pairs=[]}Object.assign(an.prototype,{BroadPhase:!0,createProxy:function(t){Ni("BroadPhase","Inheritance error.")},addProxy:function(t){Ni("BroadPhase","Inheritance error.")},removeProxy:function(t){Ni("BroadPhase","Inheritance error.")},isAvailablePair:function(t,e){var s=t.parent,r=e.parent;if(s==r||!s.isDynamic&&!r.isDynamic||!(t.belongsTo&e.collidesWith)||!(e.belongsTo&t.collidesWith))return!1;var n;for(s.numJoints<r.numJoints?n=s.jointLink:n=r.jointLink;n!==null;){var o=n.joint;if(!o.allowCollision&&(o.body1==s&&o.body2==r||o.body1==r&&o.body2==s))return!1;n=n.next}return!0},detectPairs:function(){this.pairs=[],this.numPairs=0,this.numPairChecks=0,this.collectPairs()},collectPairs:function(){},addPair:function(t,e){var s=new Ov(t,e);this.pairs.push(s),this.numPairs++}});var Uv=0;function Bv(){return Uv++}function ln(t){this.shape=t,this.aabb=t.aabb}Object.assign(ln.prototype,{Proxy:!0,update:function(){Ni("Proxy","Inheritance error.")}});function vu(t){ln.call(this,t),this.id=Bv()}vu.prototype=Object.assign(Object.create(ln.prototype),{constructor:vu,update:function(){}});function yu(){an.call(this),this.types=zv,this.proxies=[]}yu.prototype=Object.assign(Object.create(an.prototype),{constructor:yu,createProxy:function(t){return new vu(t)},addProxy:function(t){this.proxies.push(t)},removeProxy:function(t){var e=this.proxies.indexOf(t);e>-1&&this.proxies.splice(e,1)},collectPairs:function(){var t=0,e,s,r,n=this.proxies,o=n.length;for(this.numPairChecks=o*(o-1)>>1;t<o;)for(s=n[t++],e=t+1;e<o;)r=n[e++],!(s.aabb.intersectTest(r.aabb)||!this.isAvailablePair(s.shape,r.shape))&&this.addPair(s.shape,r.shape)}});function qr(){this.numElements=0,this.bufferSize=256,this.elements=[],this.elements.length=this.bufferSize,this.stack=new Float32Array(64)}Object.assign(qr.prototype,{SAPAxis:!0,addElements:function(t,e){if(this.numElements+2>=this.bufferSize){this.bufferSize*=2;for(var s=[],r=this.numElements;r--;)s[r]=this.elements[r]}this.elements[this.numElements++]=t,this.elements[this.numElements++]=e},removeElements:function(t,e){for(var s=-1,r=-1,n=0,o=this.numElements;n<o;n++){var a=this.elements[n];if(a==t||a==e)if(s==-1)s=n;else{r=n;break}}for(n=s+1,o=r;n<o;n++)this.elements[n-1]=this.elements[n];for(n=r+1,o=this.numElements;n<o;n++)this.elements[n-2]=this.elements[n];this.elements[--this.numElements]=null,this.elements[--this.numElements]=null},sort:function(){for(var t=0,e=1;this.numElements>>e;)e++;e=e*this.numElements>>2,t=0;for(var s=!1,r=this.elements,n=1,o=this.numElements;n<o;n++){var a=r[n],l=a.value,h=r[n-1];if(h.value>l){var u=n;do{if(r[u]=h,--u==0)break;h=r[u-1]}while(h.value>l);if(r[u]=a,t+=n-u,t>e){s=!0;break}}}if(s){t=2;var c=this.stack;for(c[0]=0,c[1]=this.numElements-1;t>0;){var f=c[--t],p=c[--t],g=f-p;if(g>16){var y=p+B.floor(g*.5);for(a=r[y],r[y]=r[f],r[f]=a,l=a.value,n=p-1,u=f;;){var v,z;do v=r[++n];while(v.value<l);do z=r[--u];while(l<z.value&&u!=p);if(n>=u)break;r[n]=z,r[u]=v}r[f]=r[n],r[n]=a,n-p>f-n?(c[t++]=p,c[t++]=n-1,c[t++]=n+1,c[t++]=f):(c[t++]=n+1,c[t++]=f,c[t++]=p,c[t++]=n-1)}else for(n=p+1;n<=f;n++)if(a=r[n],l=a.value,h=r[n-1],h.value>l){u=n;do{if(r[u]=h,--u==0)break;h=r[u-1]}while(h.value>l);r[u]=a}}}},calculateTestCount:function(){for(var t=1,e=0,s=1,r=this.numElements;s<r;s++)this.elements[s].max?t--:(e+=t,t++);return e}});function fn(t,e){this.proxy=t,this.pair=null,this.min1=null,this.max1=null,this.min2=null,this.max2=null,this.max=e,this.value=0}function xu(t,e){ln.call(this,e),this.belongsTo=0,this.max=[],this.min=[],this.sap=t,this.min[0]=new fn(this,!1),this.max[0]=new fn(this,!0),this.min[1]=new fn(this,!1),this.max[1]=new fn(this,!0),this.min[2]=new fn(this,!1),this.max[2]=new fn(this,!0),this.max[0].pair=this.min[0],this.max[1].pair=this.min[1],this.max[2].pair=this.min[2],this.min[0].min1=this.min[1],this.min[0].max1=this.max[1],this.min[0].min2=this.min[2],this.min[0].max2=this.max[2],this.min[1].min1=this.min[0],this.min[1].max1=this.max[0],this.min[1].min2=this.min[2],this.min[1].max2=this.max[2],this.min[2].min1=this.min[0],this.min[2].max1=this.max[0],this.min[2].min2=this.min[1],this.min[2].max2=this.max[1]}xu.prototype=Object.assign(Object.create(ln.prototype),{constructor:xu,isDynamic:function(){var t=this.shape.parent;return t.isDynamic&&!t.sleeping},update:function(){var t=this.aabb.elements;this.min[0].value=t[0],this.min[1].value=t[1],this.min[2].value=t[2],this.max[0].value=t[3],this.max[1].value=t[4],this.max[2].value=t[5],(this.belongsTo==1&&!this.isDynamic()||this.belongsTo==2&&this.isDynamic())&&(this.sap.removeProxy(this),this.sap.addProxy(this))}});function gu(){an.call(this),this.types=Nv,this.numElementsD=0,this.numElementsS=0,this.axesD=[new qr,new qr,new qr],this.axesS=[new qr,new qr,new qr],this.index1=0,this.index2=1}gu.prototype=Object.assign(Object.create(an.prototype),{constructor:gu,createProxy:function(t){return new xu(this,t)},addProxy:function(t){var e=t;e.isDynamic()?(this.axesD[0].addElements(e.min[0],e.max[0]),this.axesD[1].addElements(e.min[1],e.max[1]),this.axesD[2].addElements(e.min[2],e.max[2]),e.belongsTo=1,this.numElementsD+=2):(this.axesS[0].addElements(e.min[0],e.max[0]),this.axesS[1].addElements(e.min[1],e.max[1]),this.axesS[2].addElements(e.min[2],e.max[2]),e.belongsTo=2,this.numElementsS+=2)},removeProxy:function(t){var e=t;if(e.belongsTo!=0){switch(e.belongsTo){case 1:this.axesD[0].removeElements(e.min[0],e.max[0]),this.axesD[1].removeElements(e.min[1],e.max[1]),this.axesD[2].removeElements(e.min[2],e.max[2]),this.numElementsD-=2;break;case 2:this.axesS[0].removeElements(e.min[0],e.max[0]),this.axesS[1].removeElements(e.min[1],e.max[1]),this.axesS[2].removeElements(e.min[2],e.max[2]),this.numElementsS-=2;break}e.belongsTo=0}},collectPairs:function(){if(this.numElementsD!=0){var t=this.axesD[this.index1],e=this.axesD[this.index2];t.sort(),e.sort();var s=t.calculateTestCount(),r=e.calculateTestCount(),n,o;s<=r?(e=this.axesS[this.index1],e.sort(),n=t.elements,o=e.elements):(t=this.axesS[this.index2],t.sort(),n=e.elements,o=t.elements,this.index1^=this.index2,this.index2^=this.index1,this.index1^=this.index2);for(var a,l,h=0,u=0;h<this.numElementsD;){var c,f;if(u==this.numElementsS)c=n[h],f=!0,h++;else{var p=n[h],g=o[u];p.value<g.value?(c=p,f=!0,h++):(c=g,f=!1,u++)}if(c.max){var N=c.pair;if(f)if(N==a){a=a.pair;continue}else c=a;else if(N==l){l=l.pair;continue}else c=l;do{if(d=c.pair,d==N){c.pair=d.pair;break}c=d}while(c!=null)}else{for(var y=c.proxy.shape,v=c.min1.value,z=c.max1.value,x=c.min2.value,m=c.max2.value,d=a;d!=null;d=d.pair){var w=d.proxy.shape;this.numPairChecks++,!(v>d.max1.value||z<d.min1.value||x>d.max2.value||m<d.min2.value||!this.isAvailablePair(y,w))&&this.addPair(y,w)}if(f){for(d=l;d!=null;d=d.pair)w=d.proxy.shape,this.numPairChecks++,!(v>d.max1.value||z<d.min1.value||x>d.max2.value||m<d.min2.value||!this.isAvailablePair(y,w))&&this.addPair(y,w);c.pair=a,a=c}else c.pair=l,l=c}}this.index2=(this.index1|this.index2)^3}}});function Md(){this.child1=null,this.child2=null,this.parent=null,this.proxy=null,this.height=0,this.aabb=new kl}function Pd(){this.root=null,this.freeNodes=[],this.freeNodes.length=16384,this.numFreeNodes=0,this.aabb=new kl}Object.assign(Pd.prototype,{DBVT:!0,moveLeaf:function(t){this.deleteLeaf(t),this.insertLeaf(t)},insertLeaf:function(t){if(this.root==null){this.root=t;return}for(var e=t.aabb,s=this.root,r,n;s.proxy==null;){var o=s.child1,a=s.child2,l=s.aabb,h=o.aabb,u=a.aabb;r=l.surfaceArea(),this.aabb.combine(e,l),n=this.aabb.surfaceArea();var c=n*2,f=(n-r)*2,p=f;this.aabb.combine(e,h),o.proxy!=null?p+=this.aabb.surfaceArea():p+=this.aabb.surfaceArea()-h.surfaceArea();var g=f;if(this.aabb.combine(e,u),a.proxy!=null?g+=this.aabb.surfaceArea():g+=this.aabb.surfaceArea()-u.surfaceArea(),p<g){if(c<p)break;s=o}else{if(c<g)break;s=a}}var y=s.parent,v;this.numFreeNodes>0?v=this.freeNodes[--this.numFreeNodes]:v=new Md,v.parent=y,v.child1=t,v.child2=s,v.aabb.combine(t.aabb,s.aabb),v.height=s.height+1,s.parent=v,t.parent=v,s==this.root?this.root=v:y.child1==s?y.child1=v:y.child2=v;do v=this.balance(v),this.fix(v),v=v.parent;while(v!=null)},getBalance:function(t){return t.proxy!=null?0:t.child1.height-t.child2.height},deleteLeaf:function(t){if(t==this.root){this.root=null;return}var e=t.parent,s;if(e.child1==t?s=e.child2:s=e.child1,e==this.root){this.root=s,s.parent=null;return}var r=e.parent;s.parent=r,r.child1==e?r.child1=s:r.child2=s,this.numFreeNodes<16384&&(this.freeNodes[this.numFreeNodes++]=e);do r=this.balance(r),this.fix(r),r=r.parent;while(r!=null)},balance:function(t){var e=t.height;if(e<2)return t;var s=t.parent,r=t.child1,n=t.child2,o=r.height,a=n.height,l=o-a,h;if(l>1){var u=r.child1,c=r.child2,f=u.height,p=c.height;return f>p?(r.child2=t,t.parent=r,t.child1=c,c.parent=t,t.aabb.combine(c.aabb,n.aabb),h=p-a,t.height=p-(h&h>>31)+1,r.aabb.combine(u.aabb,t.aabb),h=f-e,r.height=f-(h&h>>31)+1):(r.child1=t,t.parent=r,t.child1=u,u.parent=t,t.aabb.combine(u.aabb,n.aabb),h=f-a,t.height=f-(h&h>>31)+1,r.aabb.combine(t.aabb,c.aabb),h=e-p,r.height=e-(h&h>>31)+1),s!=null?s.child1==t?s.child1=r:s.child2=r:this.root=r,r.parent=s,r}else if(l<-1){var g=n.child1,y=n.child2,v=g.height,z=y.height;return v>z?(n.child2=t,t.parent=n,t.child2=y,y.parent=t,t.aabb.combine(r.aabb,y.aabb),h=o-z,t.height=o-(h&h>>31)+1,n.aabb.combine(g.aabb,t.aabb),h=v-e,n.height=v-(h&h>>31)+1):(n.child1=t,t.parent=n,t.child2=g,g.parent=t,t.aabb.combine(r.aabb,g.aabb),h=o-v,t.height=o-(h&h>>31)+1,n.aabb.combine(t.aabb,y.aabb),h=e-z,n.height=e-(h&h>>31)+1),s!=null?s.child1==t?s.child1=n:s.child2=n:this.root=n,n.parent=s,n}return t},fix:function(t){var e=t.child1,s=t.child2;t.aabb.combine(e.aabb,s.aabb),t.height=e.height<s.height?s.height+1:e.height+1}});function wu(t){ln.call(this,t),this.leaf=new Md,this.leaf.proxy=this}wu.prototype=Object.assign(Object.create(ln.prototype),{constructor:wu,update:function(){}});function zu(){an.call(this),this.types=Sv,this.tree=new Pd,this.stack=[],this.leaves=[],this.numLeaves=0}zu.prototype=Object.assign(Object.create(an.prototype),{constructor:zu,createProxy:function(t){return new wu(t)},addProxy:function(t){this.tree.insertLeaf(t.leaf),this.leaves.push(t.leaf),this.numLeaves++},removeProxy:function(t){this.tree.deleteLeaf(t.leaf);var e=this.leaves.indexOf(t.leaf);e>-1&&(this.leaves.splice(e,1),this.numLeaves--)},collectPairs:function(){if(!(this.numLeaves<2))for(var t,e=.1,s=this.numLeaves;s--;)t=this.leaves[s],t.proxy.aabb.intersectTestTwo(t.aabb)&&(t.aabb.copy(t.proxy.aabb,e),this.tree.deleteLeaf(t),this.tree.insertLeaf(t),this.collide(t,this.tree.root))},collide:function(t,e){var s=2,r,n,o,a,l,h;for(this.stack[0]=t,this.stack[1]=e;s>0;)if(o=this.stack[--s],a=this.stack[--s],l=o.proxy!=null,h=a.proxy!=null,this.numPairChecks++,l&&h){if(r=o.proxy.shape,n=a.proxy.shape,r==n||r.aabb.intersectTest(n.aabb)||!this.isAvailablePair(r,n))continue;this.addPair(r,n)}else{if(o.aabb.intersectTest(a.aabb))continue;h||!l&&o.aabb.surfaceArea()>a.aabb.surfaceArea()?(this.stack[s++]=o.child1,this.stack[s++]=a,this.stack[s++]=o.child2,this.stack[s++]=a):(this.stack[s++]=o,this.stack[s++]=a.child1,this.stack[s++]=o,this.stack[s++]=a.child2)}}});function Pi(){this.flip=!1}Object.assign(Pi.prototype,{CollisionDetector:!0,detectCollision:function(t,e,s){Ni("CollisionDetector","Inheritance error.")}});function Nu(){Pi.call(this),this.clipVertices1=new Float32Array(24),this.clipVertices2=new Float32Array(24),this.used=new Float32Array(8),this.INF=1/0}Nu.prototype=Object.assign(Object.create(Pi.prototype),{constructor:Nu,detectCollision:function(t,e,s){var r,n;t.id<e.id?(r=t,n=e):(r=e,n=t);var o=r.elements,a=n.elements,l=r.dimentions,h=n.dimentions,u=r.position,c=n.position,f=u.x,p=u.y,g=u.z,y=c.x,v=c.y,z=c.z,x=y-f,m=v-p,d=z-g,w=r.halfWidth,N=r.halfHeight,S=r.halfDepth,k=n.halfWidth,O=n.halfHeight,E=n.halfDepth,M=l[0],R=l[1],D=l[2],A=l[3],P=l[4],st=l[5],zt=l[6],tt=l[7],L=l[8],W=l[9],V=l[10],q=l[11],H=l[12],Q=l[13],vt=l[14],Dt=l[15],It=l[16],K=l[17],I=h[0],C=h[1],b=h[2],$=h[3],G=h[4],Nt=h[5],ut=h[6],yt=h[7],ft=h[8],Yt=h[9],ue=h[10],wt=h[11],Y=h[12],et=h[13],it=h[14],Pe=h[15],qt=h[16],$t=h[17],Xt=R*b-D*C,Kt=D*I-M*b,Le=M*C-R*I,at=R*Nt-D*G,lt=D*$-M*Nt,ht=M*G-R*$,Se=R*ft-D*yt,re=D*ut-M*ft,ne=M*yt-R*ut,Et=P*b-st*C,dt=st*I-A*b,mt=A*C-P*I,nt=P*Nt-st*G,Wt=st*$-A*Nt,ee=A*G-P*$,Pt=P*ft-st*yt,Z=st*ut-A*ft,J=A*yt-P*ut,pt=tt*b-L*C,xt=L*I-zt*b,ge=zt*C-tt*I,te=tt*Nt-L*G,ke=L*$-zt*Nt,oe=zt*G-tt*$,hi=tt*ft-L*yt,ui=L*ut-zt*ft,ci=zt*yt-tt*ut,xs,ae,le,he,Lt,Oe,Ve,Ie,At,Rt,Ce,Ft,fi,pi,di,mi,si,ri,Te,be,Zi,Ci,Ti,bi,Ei,Di,Ai,Fi,Ri,Ji,Is=!1,Cs=!1,rt=!1,Mc=!1,Pc=!1,_c=!1,Lc=!1,Vc=!1,Ic=!1,F,ce,fe,_,T,pe;if(F=M*x+R*m+D*d,xs=F>0,xs||(F=-F),ce=w,_=M*I+R*C+D*b,T=M*$+R*G+D*Nt,pe=M*ut+R*yt+D*ft,_<0&&(_=-_),T<0&&(T=-T),pe<0&&(pe=-pe),fe=_*k+T*O+pe*E,mi=F-ce-fe,!(mi>0)&&(F=A*x+P*m+st*d,ae=F>0,ae||(F=-F),ce=N,_=A*I+P*C+st*b,T=A*$+P*G+st*Nt,pe=A*ut+P*yt+st*ft,_<0&&(_=-_),T<0&&(T=-T),pe<0&&(pe=-pe),fe=_*k+T*O+pe*E,si=F-ce-fe,!(si>0)&&(F=zt*x+tt*m+L*d,le=F>0,le||(F=-F),ce=S,_=zt*I+tt*C+L*b,T=zt*$+tt*G+L*Nt,pe=zt*ut+tt*yt+L*ft,_<0&&(_=-_),T<0&&(T=-T),pe<0&&(pe=-pe),fe=_*k+T*O+pe*E,ri=F-ce-fe,!(ri>0)&&(F=I*x+C*m+b*d,he=F>0,he||(F=-F),_=I*M+C*R+b*D,T=I*A+C*P+b*st,pe=I*zt+C*tt+b*L,_<0&&(_=-_),T<0&&(T=-T),pe<0&&(pe=-pe),ce=_*w+T*N+pe*S,fe=k,Te=(F-ce-fe)*1,!(Te>0)&&(F=$*x+G*m+Nt*d,Lt=F>0,Lt||(F=-F),_=$*M+G*R+Nt*D,T=$*A+G*P+Nt*st,pe=$*zt+G*tt+Nt*L,_<0&&(_=-_),T<0&&(T=-T),pe<0&&(pe=-pe),ce=_*w+T*N+pe*S,fe=O,be=(F-ce-fe)*1,!(be>0)&&(F=ut*x+yt*m+ft*d,Oe=F>0,Oe||(F=-F),_=ut*M+yt*R+ft*D,T=ut*A+yt*P+ft*st,pe=ut*zt+yt*tt+ft*L,_<0&&(_=-_),T<0&&(T=-T),pe<0&&(pe=-pe),ce=_*w+T*N+pe*S,fe=E,Zi=(F-ce-fe)*1,!(Zi>0))))))){if(F=Xt*Xt+Kt*Kt+Le*Le,F>1e-5){if(F=1/B.sqrt(F),Xt*=F,Kt*=F,Le*=F,F=Xt*x+Kt*m+Le*d,Ve=F>0,Ve||(F=-F),_=Xt*A+Kt*P+Le*st,T=Xt*zt+Kt*tt+Le*L,_<0&&(_=-_),T<0&&(T=-T),ce=_*N+T*S,_=Xt*$+Kt*G+Le*Nt,T=Xt*ut+Kt*yt+Le*ft,_<0&&(_=-_),T<0&&(T=-T),fe=_*O+T*E,Ci=F-ce-fe,Ci>0)return}else Ve=!1,Ci=0,Is=!0;if(F=at*at+lt*lt+ht*ht,F>1e-5){if(F=1/B.sqrt(F),at*=F,lt*=F,ht*=F,F=at*x+lt*m+ht*d,Ie=F>0,Ie||(F=-F),_=at*A+lt*P+ht*st,T=at*zt+lt*tt+ht*L,_<0&&(_=-_),T<0&&(T=-T),ce=_*N+T*S,_=at*I+lt*C+ht*b,T=at*ut+lt*yt+ht*ft,_<0&&(_=-_),T<0&&(T=-T),fe=_*k+T*E,Ti=F-ce-fe,Ti>0)return}else Ie=!1,Ti=0,Cs=!0;if(F=Se*Se+re*re+ne*ne,F>1e-5){if(F=1/B.sqrt(F),Se*=F,re*=F,ne*=F,F=Se*x+re*m+ne*d,At=F>0,At||(F=-F),_=Se*A+re*P+ne*st,T=Se*zt+re*tt+ne*L,_<0&&(_=-_),T<0&&(T=-T),ce=_*N+T*S,_=Se*I+re*C+ne*b,T=Se*$+re*G+ne*Nt,_<0&&(_=-_),T<0&&(T=-T),fe=_*k+T*O,bi=F-ce-fe,bi>0)return}else At=!1,bi=0,rt=!0;if(F=Et*Et+dt*dt+mt*mt,F>1e-5){if(F=1/B.sqrt(F),Et*=F,dt*=F,mt*=F,F=Et*x+dt*m+mt*d,Rt=F>0,Rt||(F=-F),_=Et*M+dt*R+mt*D,T=Et*zt+dt*tt+mt*L,_<0&&(_=-_),T<0&&(T=-T),ce=_*w+T*S,_=Et*$+dt*G+mt*Nt,T=Et*ut+dt*yt+mt*ft,_<0&&(_=-_),T<0&&(T=-T),fe=_*O+T*E,Ei=F-ce-fe,Ei>0)return}else Rt=!1,Ei=0,Mc=!0;if(F=nt*nt+Wt*Wt+ee*ee,F>1e-5){if(F=1/B.sqrt(F),nt*=F,Wt*=F,ee*=F,F=nt*x+Wt*m+ee*d,Ce=F>0,Ce||(F=-F),_=nt*M+Wt*R+ee*D,T=nt*zt+Wt*tt+ee*L,_<0&&(_=-_),T<0&&(T=-T),ce=_*w+T*S,_=nt*I+Wt*C+ee*b,T=nt*ut+Wt*yt+ee*ft,_<0&&(_=-_),T<0&&(T=-T),fe=_*k+T*E,Di=F-ce-fe,Di>0)return}else Ce=!1,Di=0,Pc=!0;if(F=Pt*Pt+Z*Z+J*J,F>1e-5){if(F=1/B.sqrt(F),Pt*=F,Z*=F,J*=F,F=Pt*x+Z*m+J*d,Ft=F>0,Ft||(F=-F),_=Pt*M+Z*R+J*D,T=Pt*zt+Z*tt+J*L,_<0&&(_=-_),T<0&&(T=-T),ce=_*w+T*S,_=Pt*I+Z*C+J*b,T=Pt*$+Z*G+J*Nt,_<0&&(_=-_),T<0&&(T=-T),fe=_*k+T*O,Ai=F-ce-fe,Ai>0)return}else Ft=!1,Ai=0,_c=!0;if(F=pt*pt+xt*xt+ge*ge,F>1e-5){if(F=1/B.sqrt(F),pt*=F,xt*=F,ge*=F,F=pt*x+xt*m+ge*d,fi=F>0,fi||(F=-F),_=pt*M+xt*R+ge*D,T=pt*A+xt*P+ge*st,_<0&&(_=-_),T<0&&(T=-T),ce=_*w+T*N,_=pt*$+xt*G+ge*Nt,T=pt*ut+xt*yt+ge*ft,_<0&&(_=-_),T<0&&(T=-T),fe=_*O+T*E,Fi=F-ce-fe,Fi>0)return}else fi=!1,Fi=0,Lc=!0;if(F=te*te+ke*ke+oe*oe,F>1e-5){if(F=1/B.sqrt(F),te*=F,ke*=F,oe*=F,F=te*x+ke*m+oe*d,pi=F>0,pi||(F=-F),_=te*M+ke*R+oe*D,T=te*A+ke*P+oe*st,_<0&&(_=-_),T<0&&(T=-T),ce=_*w+T*N,_=te*I+ke*C+oe*b,T=te*ut+ke*yt+oe*ft,_<0&&(_=-_),T<0&&(T=-T),fe=_*k+T*E,Ri=F-ce-fe,Ri>0)return}else pi=!1,Ri=0,Vc=!0;if(F=hi*hi+ui*ui+ci*ci,F>1e-5){if(F=1/B.sqrt(F),hi*=F,ui*=F,ci*=F,F=hi*x+ui*m+ci*d,di=F>0,di||(F=-F),_=hi*M+ui*R+ci*D,T=hi*A+ui*P+ci*st,_<0&&(_=-_),T<0&&(T=-T),ce=_*w+T*N,_=hi*I+ui*C+ci*b,T=hi*$+ui*G+ci*Nt,_<0&&(_=-_),T<0&&(T=-T),fe=_*k+T*O,Ji=F-ce-fe,Ji>0)return}else di=!1,Ji=0,Ic=!0;var vi=mi,Me=mi,de=0,Je=xs;si>Me&&(vi=si,Me=si,de=1,Je=ae),ri>Me&&(vi=ri,Me=ri,de=2,Je=le),Te>Me&&(vi=Te,Me=Te,de=3,Je=he),be>Me&&(vi=be,Me=be,de=4,Je=Lt),Zi>Me&&(vi=Zi,Me=Zi,de=5,Je=Oe),Ci-.01>Me&&!Is&&(vi=Ci,Me=Ci-.01,de=6,Je=Ve),Ti-.01>Me&&!Cs&&(vi=Ti,Me=Ti-.01,de=7,Je=Ie),bi-.01>Me&&!rt&&(vi=bi,Me=bi-.01,de=8,Je=At),Ei-.01>Me&&!Mc&&(vi=Ei,Me=Ei-.01,de=9,Je=Rt),Di-.01>Me&&!Pc&&(vi=Di,Me=Di-.01,de=10,Je=Ce),Ai-.01>Me&&!_c&&(vi=Ai,Me=Ai-.01,de=11,Je=Ft),Fi-.01>Me&&!Lc&&(vi=Fi,Me=Fi-.01,de=12,Je=fi),Ri-.01>Me&&!Vc&&(vi=Ri,Me=Ri-.01,de=13,Je=pi),Ji-.01>Me&&!Ic&&(vi=Ji,de=14,Je=di);var St=0,kt=0,Mt=0,Ue=0,Be=0,je=0,He=0,We=0,qe=0,Ee=0,De=0,Ae=0,$s=0,Gs=0,Hs=0,Ws=0,qs=0,Qs=0,Hn=!1;if(de==0?(Je?(Ee=f+W,De=p+V,Ae=g+q,St=M,kt=R,Mt=D):(Ee=f-W,De=p-V,Ae=g-q,St=-M,kt=-R,Mt=-D),$s=H,Gs=Q,Hs=vt,Ue=-A,Be=-P,je=-st,Ws=Dt,qs=It,Qs=K,He=-zt,We=-tt,qe=-L):de==1?(Je?(Ee=f+H,De=p+Q,Ae=g+vt,St=A,kt=P,Mt=st):(Ee=f-H,De=p-Q,Ae=g-vt,St=-A,kt=-P,Mt=-st),$s=W,Gs=V,Hs=q,Ue=-M,Be=-R,je=-D,Ws=Dt,qs=It,Qs=K,He=-zt,We=-tt,qe=-L):de==2?(Je?(Ee=f+Dt,De=p+It,Ae=g+K,St=zt,kt=tt,Mt=L):(Ee=f-Dt,De=p-It,Ae=g-K,St=-zt,kt=-tt,Mt=-L),$s=W,Gs=V,Hs=q,Ue=-M,Be=-R,je=-D,Ws=H,qs=Q,Qs=vt,He=-A,We=-P,qe=-st):de==3?(Hn=!0,Je?(Ee=y-Yt,De=v-ue,Ae=z-wt,St=-I,kt=-C,Mt=-b):(Ee=y+Yt,De=v+ue,Ae=z+wt,St=I,kt=C,Mt=b),$s=Y,Gs=et,Hs=it,Ue=-$,Be=-G,je=-Nt,Ws=Pe,qs=qt,Qs=$t,He=-ut,We=-yt,qe=-ft):de==4?(Hn=!0,Je?(Ee=y-Y,De=v-et,Ae=z-it,St=-$,kt=-G,Mt=-Nt):(Ee=y+Y,De=v+et,Ae=z+it,St=$,kt=G,Mt=Nt),$s=Yt,Gs=ue,Hs=wt,Ue=-I,Be=-C,je=-b,Ws=Pe,qs=qt,Qs=$t,He=-ut,We=-yt,qe=-ft):de==5?(Hn=!0,Je?(Ee=y-Pe,De=v-qt,Ae=z-$t,St=-ut,kt=-yt,Mt=-ft):(Ee=y+Pe,De=v+qt,Ae=z+$t,St=ut,kt=yt,Mt=ft),$s=Yt,Gs=ue,Hs=wt,Ue=-I,Be=-C,je=-b,Ws=Y,qs=et,Qs=it,He=-$,We=-G,qe=-Nt):de==6?(St=Xt,kt=Kt,Mt=Le,Ue=M,Be=R,je=D,He=I,We=C,qe=b):de==7?(St=at,kt=lt,Mt=ht,Ue=M,Be=R,je=D,He=$,We=G,qe=Nt):de==8?(St=Se,kt=re,Mt=ne,Ue=M,Be=R,je=D,He=ut,We=yt,qe=ft):de==9?(St=Et,kt=dt,Mt=mt,Ue=A,Be=P,je=st,He=I,We=C,qe=b):de==10?(St=nt,kt=Wt,Mt=ee,Ue=A,Be=P,je=st,He=$,We=G,qe=Nt):de==11?(St=Pt,kt=Z,Mt=J,Ue=A,Be=P,je=st,He=ut,We=yt,qe=ft):de==12?(St=pt,kt=xt,Mt=ge,Ue=zt,Be=tt,je=L,He=I,We=C,qe=b):de==13?(St=te,kt=ke,Mt=oe,Ue=zt,Be=tt,je=L,He=$,We=G,qe=Nt):de==14&&(St=hi,kt=ui,Mt=ci,Ue=zt,Be=tt,je=L,He=ut,We=yt,qe=ft),de>5){Je||(St=-St,kt=-kt,Mt=-Mt);var Gt,me,Ot,Ut,Bt,Ts,bs,Es,Ys,Xs,Ks;Ts=o[0],bs=o[1],Es=o[2],me=St*Ts+kt*bs+Mt*Es,Ot=o[3],Ut=o[4],Bt=o[5],Gt=St*Ot+kt*Ut+Mt*Bt,Gt>me&&(me=Gt,Ts=Ot,bs=Ut,Es=Bt),Ot=o[6],Ut=o[7],Bt=o[8],Gt=St*Ot+kt*Ut+Mt*Bt,Gt>me&&(me=Gt,Ts=Ot,bs=Ut,Es=Bt),Ot=o[9],Ut=o[10],Bt=o[11],Gt=St*Ot+kt*Ut+Mt*Bt,Gt>me&&(me=Gt,Ts=Ot,bs=Ut,Es=Bt),Ot=o[12],Ut=o[13],Bt=o[14],Gt=St*Ot+kt*Ut+Mt*Bt,Gt>me&&(me=Gt,Ts=Ot,bs=Ut,Es=Bt),Ot=o[15],Ut=o[16],Bt=o[17],Gt=St*Ot+kt*Ut+Mt*Bt,Gt>me&&(me=Gt,Ts=Ot,bs=Ut,Es=Bt),Ot=o[18],Ut=o[19],Bt=o[20],Gt=St*Ot+kt*Ut+Mt*Bt,Gt>me&&(me=Gt,Ts=Ot,bs=Ut,Es=Bt),Ot=o[21],Ut=o[22],Bt=o[23],Gt=St*Ot+kt*Ut+Mt*Bt,Gt>me&&(me=Gt,Ts=Ot,bs=Ut,Es=Bt),Ys=a[0],Xs=a[1],Ks=a[2],me=St*Ys+kt*Xs+Mt*Ks,Ot=a[3],Ut=a[4],Bt=a[5],Gt=St*Ot+kt*Ut+Mt*Bt,Gt<me&&(me=Gt,Ys=Ot,Xs=Ut,Ks=Bt),Ot=a[6],Ut=a[7],Bt=a[8],Gt=St*Ot+kt*Ut+Mt*Bt,Gt<me&&(me=Gt,Ys=Ot,Xs=Ut,Ks=Bt),Ot=a[9],Ut=a[10],Bt=a[11],Gt=St*Ot+kt*Ut+Mt*Bt,Gt<me&&(me=Gt,Ys=Ot,Xs=Ut,Ks=Bt),Ot=a[12],Ut=a[13],Bt=a[14],Gt=St*Ot+kt*Ut+Mt*Bt,Gt<me&&(me=Gt,Ys=Ot,Xs=Ut,Ks=Bt),Ot=a[15],Ut=a[16],Bt=a[17],Gt=St*Ot+kt*Ut+Mt*Bt,Gt<me&&(me=Gt,Ys=Ot,Xs=Ut,Ks=Bt),Ot=a[18],Ut=a[19],Bt=a[20],Gt=St*Ot+kt*Ut+Mt*Bt,Gt<me&&(me=Gt,Ys=Ot,Xs=Ut,Ks=Bt),Ot=a[21],Ut=a[22],Bt=a[23],Gt=St*Ot+kt*Ut+Mt*Bt,Gt<me&&(me=Gt,Ys=Ot,Xs=Ut,Ks=Bt),Ot=Ys-Ts,Ut=Xs-bs,Bt=Ks-Es,_=Ue*He+Be*We+je*qe;var Jt=(Ot*(Ue-He*_)+Ut*(Be-We*_)+Bt*(je-qe*_))/(1-_*_);s.addPoint(Ts+Ue*Jt+St*vi*.5,bs+Be*Jt+kt*vi*.5,Es+je*Jt+Mt*vi*.5,St,kt,Mt,vi,!1);return}var Oi,Ui,Bi,ji,$i,Gi,ts,es,is,ss,rs,ns,ve=1,_t=0,$e=0;Hn?(_t=M*St+R*kt+D*Mt,_t<ve&&(ve=_t,$e=0),-_t<ve&&(ve=-_t,$e=1),_t=A*St+P*kt+st*Mt,_t<ve&&(ve=_t,$e=2),-_t<ve&&(ve=-_t,$e=3),_t=zt*St+tt*kt+L*Mt,_t<ve&&(ve=_t,$e=4),-_t<ve&&(ve=-_t,$e=5),$e==0?(Oi=o[0],Ui=o[1],Bi=o[2],ji=o[6],$i=o[7],Gi=o[8],ts=o[9],es=o[10],is=o[11],ss=o[3],rs=o[4],ns=o[5]):$e==1?(Oi=o[15],Ui=o[16],Bi=o[17],ji=o[21],$i=o[22],Gi=o[23],ts=o[18],es=o[19],is=o[20],ss=o[12],rs=o[13],ns=o[14]):$e==2?(Oi=o[12],Ui=o[13],Bi=o[14],ji=o[0],$i=o[1],Gi=o[2],ts=o[3],es=o[4],is=o[5],ss=o[15],rs=o[16],ns=o[17]):$e==3?(Oi=o[21],Ui=o[22],Bi=o[23],ji=o[9],$i=o[10],Gi=o[11],ts=o[6],es=o[7],is=o[8],ss=o[18],rs=o[19],ns=o[20]):$e==4?(Oi=o[12],Ui=o[13],Bi=o[14],ji=o[18],$i=o[19],Gi=o[20],ts=o[6],es=o[7],is=o[8],ss=o[0],rs=o[1],ns=o[2]):$e==5&&(Oi=o[3],Ui=o[4],Bi=o[5],ji=a[9],$i=a[10],Gi=a[11],ts=o[21],es=o[22],is=o[23],ss=o[15],rs=o[16],ns=o[17])):(_t=I*St+C*kt+b*Mt,_t<ve&&(ve=_t,$e=0),-_t<ve&&(ve=-_t,$e=1),_t=$*St+G*kt+Nt*Mt,_t<ve&&(ve=_t,$e=2),-_t<ve&&(ve=-_t,$e=3),_t=ut*St+yt*kt+ft*Mt,_t<ve&&(ve=_t,$e=4),-_t<ve&&(ve=-_t,$e=5),$e==0?(Oi=a[0],Ui=a[1],Bi=a[2],ji=a[6],$i=a[7],Gi=a[8],ts=a[9],es=a[10],is=a[11],ss=a[3],rs=a[4],ns=a[5]):$e==1?(Oi=a[15],Ui=a[16],Bi=a[17],ji=a[21],$i=a[22],Gi=a[23],ts=a[18],es=a[19],is=a[20],ss=a[12],rs=a[13],ns=a[14]):$e==2?(Oi=a[12],Ui=a[13],Bi=a[14],ji=a[0],$i=a[1],Gi=a[2],ts=a[3],es=a[4],is=a[5],ss=a[15],rs=a[16],ns=a[17]):$e==3?(Oi=a[21],Ui=a[22],Bi=a[23],ji=a[9],$i=a[10],Gi=a[11],ts=a[6],es=a[7],is=a[8],ss=a[18],rs=a[19],ns=a[20]):$e==4?(Oi=a[12],Ui=a[13],Bi=a[14],ji=a[18],$i=a[19],Gi=a[20],ts=a[6],es=a[7],is=a[8],ss=a[0],rs=a[1],ns=a[2]):$e==5&&(Oi=a[3],Ui=a[4],Bi=a[5],ji=a[9],$i=a[10],Gi=a[11],ts=a[21],es=a[22],is=a[23],ss=a[15],rs=a[16],ns=a[17]));var yi,Qt,j,Ct,Tt,bt,we,ze,Ne;this.clipVertices1[0]=Oi,this.clipVertices1[1]=Ui,this.clipVertices1[2]=Bi,this.clipVertices1[3]=ji,this.clipVertices1[4]=$i,this.clipVertices1[5]=Gi,this.clipVertices1[6]=ts,this.clipVertices1[7]=es,this.clipVertices1[8]=is,this.clipVertices1[9]=ss,this.clipVertices1[10]=rs,this.clipVertices1[11]=ns,Qt=0,Ct=this.clipVertices1[9],Tt=this.clipVertices1[10],bt=this.clipVertices1[11],_=(Ct-Ee-$s)*Ue+(Tt-De-Gs)*Be+(bt-Ae-Hs)*je;for(var ie=0;ie<4;ie++)j=ie*3,we=this.clipVertices1[j],ze=this.clipVertices1[j+1],Ne=this.clipVertices1[j+2],T=(we-Ee-$s)*Ue+(ze-De-Gs)*Be+(Ne-Ae-Hs)*je,_>0?T>0?(j=Qt*3,Qt++,this.clipVertices2[j]=we,this.clipVertices2[j+1]=ze,this.clipVertices2[j+2]=Ne):(j=Qt*3,Qt++,Jt=_/(_-T),this.clipVertices2[j]=Ct+(we-Ct)*Jt,this.clipVertices2[j+1]=Tt+(ze-Tt)*Jt,this.clipVertices2[j+2]=bt+(Ne-bt)*Jt):T>0&&(j=Qt*3,Qt++,Jt=_/(_-T),this.clipVertices2[j]=Ct+(we-Ct)*Jt,this.clipVertices2[j+1]=Tt+(ze-Tt)*Jt,this.clipVertices2[j+2]=bt+(Ne-bt)*Jt,j=Qt*3,Qt++,this.clipVertices2[j]=we,this.clipVertices2[j+1]=ze,this.clipVertices2[j+2]=Ne),Ct=we,Tt=ze,bt=Ne,_=T;if(yi=Qt,yi!=0){for(Qt=0,j=(yi-1)*3,Ct=this.clipVertices2[j],Tt=this.clipVertices2[j+1],bt=this.clipVertices2[j+2],_=(Ct-Ee-Ws)*He+(Tt-De-qs)*We+(bt-Ae-Qs)*qe,ie=0;ie<yi;ie++)j=ie*3,we=this.clipVertices2[j],ze=this.clipVertices2[j+1],Ne=this.clipVertices2[j+2],T=(we-Ee-Ws)*He+(ze-De-qs)*We+(Ne-Ae-Qs)*qe,_>0?T>0?(j=Qt*3,Qt++,this.clipVertices1[j]=we,this.clipVertices1[j+1]=ze,this.clipVertices1[j+2]=Ne):(j=Qt*3,Qt++,Jt=_/(_-T),this.clipVertices1[j]=Ct+(we-Ct)*Jt,this.clipVertices1[j+1]=Tt+(ze-Tt)*Jt,this.clipVertices1[j+2]=bt+(Ne-bt)*Jt):T>0&&(j=Qt*3,Qt++,Jt=_/(_-T),this.clipVertices1[j]=Ct+(we-Ct)*Jt,this.clipVertices1[j+1]=Tt+(ze-Tt)*Jt,this.clipVertices1[j+2]=bt+(Ne-bt)*Jt,j=Qt*3,Qt++,this.clipVertices1[j]=we,this.clipVertices1[j+1]=ze,this.clipVertices1[j+2]=Ne),Ct=we,Tt=ze,bt=Ne,_=T;if(yi=Qt,yi!=0){for(Qt=0,j=(yi-1)*3,Ct=this.clipVertices1[j],Tt=this.clipVertices1[j+1],bt=this.clipVertices1[j+2],_=(Ct-Ee+$s)*-Ue+(Tt-De+Gs)*-Be+(bt-Ae+Hs)*-je,ie=0;ie<yi;ie++)j=ie*3,we=this.clipVertices1[j],ze=this.clipVertices1[j+1],Ne=this.clipVertices1[j+2],T=(we-Ee+$s)*-Ue+(ze-De+Gs)*-Be+(Ne-Ae+Hs)*-je,_>0?T>0?(j=Qt*3,Qt++,this.clipVertices2[j]=we,this.clipVertices2[j+1]=ze,this.clipVertices2[j+2]=Ne):(j=Qt*3,Qt++,Jt=_/(_-T),this.clipVertices2[j]=Ct+(we-Ct)*Jt,this.clipVertices2[j+1]=Tt+(ze-Tt)*Jt,this.clipVertices2[j+2]=bt+(Ne-bt)*Jt):T>0&&(j=Qt*3,Qt++,Jt=_/(_-T),this.clipVertices2[j]=Ct+(we-Ct)*Jt,this.clipVertices2[j+1]=Tt+(ze-Tt)*Jt,this.clipVertices2[j+2]=bt+(Ne-bt)*Jt,j=Qt*3,Qt++,this.clipVertices2[j]=we,this.clipVertices2[j+1]=ze,this.clipVertices2[j+2]=Ne),Ct=we,Tt=ze,bt=Ne,_=T;if(yi=Qt,yi!=0){for(Qt=0,j=(yi-1)*3,Ct=this.clipVertices2[j],Tt=this.clipVertices2[j+1],bt=this.clipVertices2[j+2],_=(Ct-Ee+Ws)*-He+(Tt-De+qs)*-We+(bt-Ae+Qs)*-qe,ie=0;ie<yi;ie++)j=ie*3,we=this.clipVertices2[j],ze=this.clipVertices2[j+1],Ne=this.clipVertices2[j+2],T=(we-Ee+Ws)*-He+(ze-De+qs)*-We+(Ne-Ae+Qs)*-qe,_>0?T>0?(j=Qt*3,Qt++,this.clipVertices1[j]=we,this.clipVertices1[j+1]=ze,this.clipVertices1[j+2]=Ne):(j=Qt*3,Qt++,Jt=_/(_-T),this.clipVertices1[j]=Ct+(we-Ct)*Jt,this.clipVertices1[j+1]=Tt+(ze-Tt)*Jt,this.clipVertices1[j+2]=bt+(Ne-bt)*Jt):T>0&&(j=Qt*3,Qt++,Jt=_/(_-T),this.clipVertices1[j]=Ct+(we-Ct)*Jt,this.clipVertices1[j+1]=Tt+(ze-Tt)*Jt,this.clipVertices1[j+2]=bt+(Ne-bt)*Jt,j=Qt*3,Qt++,this.clipVertices1[j]=we,this.clipVertices1[j+1]=ze,this.clipVertices1[j+2]=Ne),Ct=we,Tt=ze,bt=Ne,_=T;if(yi=Qt,Hn){var Vd=r;r=n,n=Vd}if(yi!=0){var Wn=r!=t;if(yi>4){Ct=(Oi+ji+ts+ss)*.25,Tt=(Ui+$i+es+rs)*.25,bt=(Bi+Gi+is+ns)*.25,Ue=Oi-Ct,Be=Ui-Tt,je=Bi-bt,He=ji-Ct,We=$i-Tt,qe=Gi-bt;var _l=0,Cc=0,Ll=0,Tc=0,qn=-this.INF;for(ve=this.INF,ie=0;ie<yi;ie++)this.used[ie]=!1,j=ie*3,Ct=this.clipVertices1[j],Tt=this.clipVertices1[j+1],bt=this.clipVertices1[j+2],_t=Ct*Ue+Tt*Be+bt*je,_t<ve&&(ve=_t,_l=ie),_t>qn&&(qn=_t,Ll=ie);for(this.used[_l]=!0,this.used[Ll]=!0,qn=-this.INF,ve=this.INF,ie=0;ie<yi;ie++)this.used[ie]||(j=ie*3,Ct=this.clipVertices1[j],Tt=this.clipVertices1[j+1],bt=this.clipVertices1[j+2],_t=Ct*He+Tt*We+bt*qe,_t<ve&&(ve=_t,Cc=ie),_t>qn&&(qn=_t,Tc=ie));j=_l*3,Ct=this.clipVertices1[j],Tt=this.clipVertices1[j+1],bt=this.clipVertices1[j+2],_t=(Ct-Ee)*St+(Tt-De)*kt+(bt-Ae)*Mt,_t<0&&s.addPoint(Ct,Tt,bt,St,kt,Mt,_t,Wn),j=Cc*3,Ct=this.clipVertices1[j],Tt=this.clipVertices1[j+1],bt=this.clipVertices1[j+2],_t=(Ct-Ee)*St+(Tt-De)*kt+(bt-Ae)*Mt,_t<0&&s.addPoint(Ct,Tt,bt,St,kt,Mt,_t,Wn),j=Ll*3,Ct=this.clipVertices1[j],Tt=this.clipVertices1[j+1],bt=this.clipVertices1[j+2],_t=(Ct-Ee)*St+(Tt-De)*kt+(bt-Ae)*Mt,_t<0&&s.addPoint(Ct,Tt,bt,St,kt,Mt,_t,Wn),j=Tc*3,Ct=this.clipVertices1[j],Tt=this.clipVertices1[j+1],bt=this.clipVertices1[j+2],_t=(Ct-Ee)*St+(Tt-De)*kt+(bt-Ae)*Mt,_t<0&&s.addPoint(Ct,Tt,bt,St,kt,Mt,_t,Wn)}else for(ie=0;ie<yi;ie++)j=ie*3,Ct=this.clipVertices1[j],Tt=this.clipVertices1[j+1],bt=this.clipVertices1[j+2],_t=(Ct-Ee)*St+(Tt-De)*kt+(bt-Ae)*Mt,_t<0&&s.addPoint(Ct,Tt,bt,St,kt,Mt,_t,Wn)}}}}}}});function il(t){Pi.call(this),this.flip=t}il.prototype=Object.assign(Object.create(Pi.prototype),{constructor:il,getSep:function(t,e,s,r,n){var o,a,l,h,u,c,f=new U,p,g,y,v,z,x,m,d=t.position.x,w=t.position.y,N=t.position.z,S=e.position.x,k=e.position.y,O=e.position.z,E=S-d,M=k-w,R=O-N;E*E+M*M+R*R==0&&(M=.001);var D=-E,A=-M,P=-R;this.supportPointB(t,-D,-A,-P,f);var st=f.x,zt=f.y,tt=f.z;this.supportPointC(e,D,A,P,f);var L=f.x,W=f.y,V=f.z,q=L-st,H=W-zt,Q=V-tt;if(q*D+H*A+Q*P<=0)return!1;if(D=H*R-Q*M,A=Q*E-q*R,P=q*M-H*E,D*D+A*A+P*P==0)return s.set(q-E,H-M,Q-R).normalize(),r.set((st+L)*.5,(zt+W)*.5,(tt+V)*.5),!0;this.supportPointB(t,-D,-A,-P,f);var vt=f.x,Dt=f.y,It=f.z;this.supportPointC(e,D,A,P,f);var K=f.x,I=f.y,C=f.z,b=K-vt,$=I-Dt,G=C-It;if(b*D+$*A+G*P<=0)return!1;o=q-E,a=H-M,l=Q-R,h=b-E,u=$-M,c=G-R,D=a*c-l*u,A=l*h-o*c,P=o*u-a*h,D*E+A*M+P*R>0&&(o=q,a=H,l=Q,q=b,H=$,Q=G,b=o,$=a,G=l,o=st,a=zt,l=tt,st=vt,zt=Dt,tt=It,vt=o,Dt=a,It=l,o=L,a=W,l=V,L=K,W=I,V=C,K=o,I=a,C=l,D=-D,A=-A,P=-P);for(var Nt=0;;){if(++Nt>100)return!1;this.supportPointB(t,-D,-A,-P,f);var ut=f.x,yt=f.y,ft=f.z;this.supportPointC(e,D,A,P,f);var Yt=f.x,ue=f.y,wt=f.z,Y=Yt-ut,et=ue-yt,it=wt-ft;if(Y*D+et*A+it*P<=0)return!1;if((H*it-Q*et)*E+(Q*Y-q*it)*M+(q*et-H*Y)*R<0){b=Y,$=et,G=it,vt=ut,Dt=yt,It=ft,K=Yt,I=ue,C=wt,o=q-E,a=H-M,l=Q-R,h=Y-E,u=et-M,c=it-R,D=a*c-l*u,A=l*h-o*c,P=o*u-a*h;continue}if((et*G-it*$)*E+(it*b-Y*G)*M+(Y*$-et*b)*R<0){q=Y,H=et,Q=it,st=ut,zt=yt,tt=ft,L=Yt,W=ue,V=wt,o=Y-E,a=et-M,l=it-R,h=b-E,u=$-M,c=G-R,D=a*c-l*u,A=l*h-o*c,P=o*u-a*h;continue}for(var Pe=!1;;){if(o=b-q,a=$-H,l=G-Q,h=Y-q,u=et-H,c=it-Q,D=a*c-l*u,A=l*h-o*c,P=o*u-a*h,p=1/B.sqrt(D*D+A*A+P*P),D*=p,A*=p,P*=p,D*q+A*H+P*Q>=0&&!Pe){var qt=(H*G-Q*$)*Y+(Q*b-q*G)*et+(q*$-H*b)*it,$t=(et*G-it*$)*E+(it*b-Y*G)*M+(Y*$-et*b)*R,Xt=(M*Q-R*H)*Y+(R*q-E*Q)*et+(E*H-M*q)*it,Kt=($*Q-G*H)*E+(G*q-b*Q)*M+(b*H-$*q)*R,Le=qt+$t+Xt+Kt;Le<=0&&(qt=0,$t=($*it-G*et)*D+(G*Y-b*it)*A+(b*et-$*Y)*P,Xt=(et*G-it*$)*D+(it*b-Y*G)*A+(Y*$-et*b)*P,Kt=(H*G-Q*$)*D+(Q*b-q*G)*A+(q*$-H*b)*P,Le=$t+Xt+Kt);var at=1/Le;g=(d*qt+st*$t+vt*Xt+ut*Kt)*at,y=(w*qt+zt*$t+Dt*Xt+yt*Kt)*at,v=(N*qt+tt*$t+It*Xt+ft*Kt)*at,z=(S*qt+L*$t+K*Xt+Yt*Kt)*at,x=(k*qt+W*$t+I*Xt+ue*Kt)*at,m=(O*qt+V*$t+C*Xt+wt*Kt)*at,Pe=!0}this.supportPointB(t,-D,-A,-P,f);var lt=f.x,ht=f.y,Se=f.z;this.supportPointC(e,D,A,P,f);var re=f.x,ne=f.y,Et=f.z,dt=re-lt,mt=ne-ht,nt=Et-Se,Wt=-(dt*D+mt*A+nt*P);if((dt-Y)*D+(mt-et)*A+(nt-it)*P<=.01||Wt>=0)return Pe?(s.set(-D,-A,-P),r.set((g+z)*.5,(y+x)*.5,(v+m)*.5),n.x=Wt,!0):!1;(mt*Q-nt*H)*E+(nt*q-dt*Q)*M+(dt*H-mt*q)*R<0?(mt*G-nt*$)*E+(nt*b-dt*G)*M+(dt*$-mt*b)*R<0?(q=dt,H=mt,Q=nt,st=lt,zt=ht,tt=Se,L=re,W=ne,V=Et):(Y=dt,et=mt,it=nt,ut=lt,yt=ht,ft=Se,Yt=re,ue=ne,wt=Et):(mt*it-nt*et)*E+(nt*Y-dt*it)*M+(dt*et-mt*Y)*R<0?(b=dt,$=mt,G=nt,vt=lt,Dt=ht,It=Se,K=re,I=ne,C=Et):(q=dt,H=mt,Q=nt,st=lt,zt=ht,tt=Se,L=re,W=ne,V=Et)}}},supportPointB:function(t,e,s,r,n){var o=t.rotation.elements,a=o[0]*e+o[3]*s+o[6]*r,l=o[1]*e+o[4]*s+o[7]*r,h=o[2]*e+o[5]*s+o[8]*r,u=t.halfWidth,c=t.halfHeight,f=t.halfDepth,p,g,y;a<0?p=-u:p=u,l<0?g=-c:g=c,h<0?y=-f:y=f,a=o[0]*p+o[1]*g+o[2]*y+t.position.x,l=o[3]*p+o[4]*g+o[5]*y+t.position.y,h=o[6]*p+o[7]*g+o[8]*y+t.position.z,n.set(a,l,h)},supportPointC:function(t,e,s,r,n){var o=t.rotation.elements,a=o[0]*e+o[3]*s+o[6]*r,l=o[1]*e+o[4]*s+o[7]*r,h=o[2]*e+o[5]*s+o[8]*r,u=a,c=h,f=u*u+c*c,p=t.radius,g=t.halfHeight,y,v,z;f==0?l<0?(y=p,v=-g,z=0):(y=p,v=g,z=0):(f=t.radius/B.sqrt(f),l<0?(y=u*f,v=-g,z=c*f):(y=u*f,v=g,z=c*f)),a=o[0]*y+o[1]*v+o[2]*z+t.position.x,l=o[3]*y+o[4]*v+o[5]*z+t.position.y,h=o[6]*y+o[7]*v+o[8]*z+t.position.z,n.set(a,l,h)},detectCollision:function(t,e,s){var r,n;this.flip?(r=e,n=t):(r=t,n=e);var o=new U,a=new U,l=new U;if(this.getSep(r,n,o,a,l)){var h=r.position.x,u=r.position.y,c=r.position.z,f=n.position.x,p=n.position.y,g=n.position.z,y=r.halfWidth,v=r.halfHeight,z=r.halfDepth,x=n.halfHeight,m=n.radius,d=r.dimentions,w=d[0],N=d[1],S=d[2],k=d[3],O=d[4],E=d[5],M=d[6],R=d[7],D=d[8],A=d[9],P=d[10],st=d[11],zt=d[12],tt=d[13],L=d[14],W=d[15],V=d[16],q=d[17],H=n.normalDirection.x,Q=n.normalDirection.y,vt=n.normalDirection.z,Dt=n.halfDirection.x,It=n.halfDirection.y,K=n.halfDirection.z,I=o.x,C=o.y,b=o.z,$=I*w+C*N+b*S,G=I*k+C*O+b*E,Nt=I*M+C*R+b*D,ut=I*H+C*Q+b*vt,yt=$>0,ft=G>0,Yt=Nt>0,ue=ut>0;yt||($=-$),ft||(G=-G),Yt||(Nt=-Nt),ue||(ut=-ut);var wt=0;ut>.999?$>.999?$>ut?wt=1:wt=4:G>.999?G>ut?wt=2:wt=4:Nt>.999&&Nt>ut?wt=3:wt=4:$>.999?wt=1:G>.999?wt=2:Nt>.999&&(wt=3);var Y,et,it,Pe,qt,$t,Xt,Kt,Le,at,lt,ht,Se,re,ne,Et,dt,mt,nt,Wt,ee,Pt,Z,J,pt,xt,ge,te,ke,oe,hi,ui,ci,xs,ae,le,he,Lt,Oe,Ve,Ie,At,Rt,Ce,Ft,fi,pi,di,mi,si,ri,Te,be;if(wt==0)s.addPoint(a.x,a.y,a.z,I,C,b,l.x,this.flip);else if(wt==4){ue?(Pe=f-Dt,qt=p-It,$t=g-K,I=-H,C=-Q,b=-vt):(Pe=f+Dt,qt=p+It,$t=g+K,I=H,C=Q,b=vt);var Zi,Ci,Ti,bi,Ei,Di,Ai,Fi,Ri,Ji,Is,Cs;Wt=1,wt=0,Rt=w*I+N*C+S*b,Rt<Wt&&(Wt=Rt,wt=0),-Rt<Wt&&(Wt=-Rt,wt=1),Rt=k*I+O*C+E*b,Rt<Wt&&(Wt=Rt,wt=2),-Rt<Wt&&(Wt=-Rt,wt=3),Rt=M*I+R*C+D*b,Rt<Wt&&(Wt=Rt,wt=4),-Rt<Wt&&(Wt=-Rt,wt=5);var rt=r.elements;switch(wt){case 0:Zi=rt[0],Ci=rt[1],Ti=rt[2],bi=rt[6],Ei=rt[7],Di=rt[8],Ai=rt[9],Fi=rt[10],Ri=rt[11],Ji=rt[3],Is=rt[4],Cs=rt[5];break;case 1:Zi=rt[15],Ci=rt[16],Ti=rt[17],bi=rt[21],Ei=rt[22],Di=rt[23],Ai=rt[18],Fi=rt[19],Ri=rt[20],Ji=rt[12],Is=rt[13],Cs=rt[14];break;case 2:Zi=rt[12],Ci=rt[13],Ti=rt[14],bi=rt[0],Ei=rt[1],Di=rt[2],Ai=rt[3],Fi=rt[4],Ri=rt[5],Ji=rt[15],Is=rt[16],Cs=rt[17];break;case 3:Zi=rt[21],Ci=rt[22],Ti=rt[23],bi=rt[9],Ei=rt[10],Di=rt[11],Ai=rt[6],Fi=rt[7],Ri=rt[8],Ji=rt[18],Is=rt[19],Cs=rt[20];break;case 4:Zi=rt[12],Ci=rt[13],Ti=rt[14],bi=rt[18],Ei=rt[19],Di=rt[20],Ai=rt[6],Fi=rt[7],Ri=rt[8],Ji=rt[0],Is=rt[1],Cs=rt[2];break;case 5:Zi=rt[3],Ci=rt[4],Ti=rt[5],bi=rt[9],Ei=rt[10],Di=rt[11],Ai=rt[21],Fi=rt[22],Ri=rt[23],Ji=rt[15],Is=rt[16],Cs=rt[17];break}nt=I*(Zi-Pe)+C*(Ci-qt)+b*(Ti-$t),nt<=0&&s.addPoint(Zi,Ci,Ti,-I,-C,-b,nt,this.flip),nt=I*(bi-Pe)+C*(Ei-qt)+b*(Di-$t),nt<=0&&s.addPoint(bi,Ei,Di,-I,-C,-b,nt,this.flip),nt=I*(Ai-Pe)+C*(Fi-qt)+b*(Ri-$t),nt<=0&&s.addPoint(Ai,Fi,Ri,-I,-C,-b,nt,this.flip),nt=I*(Ji-Pe)+C*(Is-qt)+b*(Cs-$t),nt<=0&&s.addPoint(Ji,Is,Cs,-I,-C,-b,nt,this.flip)}else{switch(wt){case 1:yt?(Y=h+A,et=u+P,it=c+st,I=w,C=N,b=S):(Y=h-A,et=u-P,it=c-st,I=-w,C=-N,b=-S),fi=k,pi=O,di=E,Te=v,mi=M,si=R,ri=D,be=z;break;case 2:ft?(Y=h+zt,et=u+tt,it=c+L,I=k,C=O,b=E):(Y=h-zt,et=u-tt,it=c-L,I=-k,C=-O,b=-E),fi=w,pi=N,di=S,Te=y,mi=M,si=R,ri=D,be=z;break;case 3:Yt?(Y=h+W,et=u+V,it=c+q,I=M,C=R,b=D):(Y=h-W,et=u-V,it=c-q,I=-M,C=-R,b=-D),fi=w,pi=N,di=S,Te=y,mi=k,si=O,ri=E,be=v;break}if(Wt=I*H+C*Q+b*vt,Wt<0?ee=x:ee=-x,Pe=f+ee*H,qt=p+ee*Q,$t=g+ee*vt,ut>=.999999?(Pt=-C,Z=b,J=I):(Pt=I,Z=C,J=b),ee=Pt*H+Z*Q+J*vt,xt=ee*H-Pt,ge=ee*Q-Z,te=ee*vt-J,ee=B.sqrt(xt*xt+ge*ge+te*te),ee==0)return;if(ee=m/ee,xt*=ee,ge*=ee,te*=ee,Pt=Pe+xt,Z=qt+ge,J=$t+te,Wt<-.96||Wt>.96)Xt=H*H*1.5-.5,Kt=H*Q*1.5-vt*.866025403,Le=H*vt*1.5+Q*.866025403,at=Q*H*1.5+vt*.866025403,lt=Q*Q*1.5-.5,ht=Q*vt*1.5-H*.866025403,Se=vt*H*1.5-Q*.866025403,re=vt*Q*1.5+H*.866025403,ne=vt*vt*1.5-.5,Et=Pt,dt=Z,mt=J,nt=I*(Et-Y)+C*(dt-et)+b*(mt-it),Pt=Et-nt*I-Y,Z=dt-nt*C-et,J=mt-nt*b-it,Lt=fi*Pt+pi*Z+di*J,At=mi*Pt+si*Z+ri*J,Lt<-Te?Lt=-Te:Lt>Te&&(Lt=Te),At<-be?At=-be:At>be&&(At=be),Pt=Lt*fi+At*mi,Z=Lt*pi+At*si,J=Lt*di+At*ri,Et=Y+Pt,dt=et+Z,mt=it+J,s.addPoint(Et,dt,mt,I,C,b,nt,this.flip),Et=xt*Xt+ge*Kt+te*Le,dt=xt*at+ge*lt+te*ht,mt=xt*Se+ge*re+te*ne,Et=(xt=Et)+Pe,dt=(ge=dt)+qt,mt=(te=mt)+$t,nt=I*(Et-Y)+C*(dt-et)+b*(mt-it),nt<=0&&(Pt=Et-nt*I-Y,Z=dt-nt*C-et,J=mt-nt*b-it,Lt=fi*Pt+pi*Z+di*J,At=mi*Pt+si*Z+ri*J,Lt<-Te?Lt=-Te:Lt>Te&&(Lt=Te),At<-be?At=-be:At>be&&(At=be),Pt=Lt*fi+At*mi,Z=Lt*pi+At*si,J=Lt*di+At*ri,Et=Y+Pt,dt=et+Z,mt=it+J,s.addPoint(Et,dt,mt,I,C,b,nt,this.flip)),Et=xt*Xt+ge*Kt+te*Le,dt=xt*at+ge*lt+te*ht,mt=xt*Se+ge*re+te*ne,Et=(xt=Et)+Pe,dt=(ge=dt)+qt,mt=(te=mt)+$t,nt=I*(Et-Y)+C*(dt-et)+b*(mt-it),nt<=0&&(Pt=Et-nt*I-Y,Z=dt-nt*C-et,J=mt-nt*b-it,Lt=fi*Pt+pi*Z+di*J,At=mi*Pt+si*Z+ri*J,Lt<-Te?Lt=-Te:Lt>Te&&(Lt=Te),At<-be?At=-be:At>be&&(At=be),Pt=Lt*fi+At*mi,Z=Lt*pi+At*si,J=Lt*di+At*ri,Et=Y+Pt,dt=et+Z,mt=it+J,s.addPoint(Et,dt,mt,I,C,b,nt,this.flip));else{if(ae=Pt,le=Z,he=J,Lt=I*(ae-Y)+C*(le-et)+b*(he-it),ae-=Lt*I,le-=Lt*C,he-=Lt*b,Wt>0?(Oe=Pt+Dt*2,Ve=Z+It*2,Ie=J+K*2):(Oe=Pt-Dt*2,Ve=Z-It*2,Ie=J-K*2),At=I*(Oe-Y)+C*(Ve-et)+b*(Ie-it),Oe-=At*I,Ve-=At*C,Ie-=At*b,ke=ae-Y,oe=le-et,hi=he-it,ui=Oe-Y,ci=Ve-et,xs=Ie-it,Pt=Oe-ae,Z=Ve-le,J=Ie-he,pt=At-Lt,$=ke*fi+oe*pi+hi*di,G=ui*fi+ci*pi+xs*di,Rt=$-Te,Ce=G-Te,Rt>0){if(Ce>0)return;Ft=Rt/(Rt-Ce),ae=ae+Pt*Ft,le=le+Z*Ft,he=he+J*Ft,Lt=Lt+pt*Ft,ke=ae-Y,oe=le-et,hi=he-it,$=ke*fi+oe*pi+hi*di,Pt=Oe-ae,Z=Ve-le,J=Ie-he,pt=At-Lt}else Ce>0&&(Ft=Rt/(Rt-Ce),Oe=ae+Pt*Ft,Ve=le+Z*Ft,Ie=he+J*Ft,At=Lt+pt*Ft,ui=Oe-Y,ci=Ve-et,xs=Ie-it,G=ui*fi+ci*pi+xs*di,Pt=Oe-ae,Z=Ve-le,J=Ie-he,pt=At-Lt);if(Rt=$+Te,Ce=G+Te,Rt<0){if(Ce<0)return;Ft=Rt/(Rt-Ce),ae=ae+Pt*Ft,le=le+Z*Ft,he=he+J*Ft,Lt=Lt+pt*Ft,ke=ae-Y,oe=le-et,hi=he-it,Pt=Oe-ae,Z=Ve-le,J=Ie-he,pt=At-Lt}else Ce<0&&(Ft=Rt/(Rt-Ce),Oe=ae+Pt*Ft,Ve=le+Z*Ft,Ie=he+J*Ft,At=Lt+pt*Ft,ui=Oe-Y,ci=Ve-et,xs=Ie-it,Pt=Oe-ae,Z=Ve-le,J=Ie-he,pt=At-Lt);if($=ke*mi+oe*si+hi*ri,G=ui*mi+ci*si+xs*ri,Rt=$-be,Ce=G-be,Rt>0){if(Ce>0)return;Ft=Rt/(Rt-Ce),ae=ae+Pt*Ft,le=le+Z*Ft,he=he+J*Ft,Lt=Lt+pt*Ft,ke=ae-Y,oe=le-et,hi=he-it,$=ke*mi+oe*si+hi*ri,Pt=Oe-ae,Z=Ve-le,J=Ie-he,pt=At-Lt}else Ce>0&&(Ft=Rt/(Rt-Ce),Oe=ae+Pt*Ft,Ve=le+Z*Ft,Ie=he+J*Ft,At=Lt+pt*Ft,ui=Oe-Y,ci=Ve-et,xs=Ie-it,G=ui*mi+ci*si+xs*ri,Pt=Oe-ae,Z=Ve-le,J=Ie-he,pt=At-Lt);if(Rt=$+be,Ce=G+be,Rt<0){if(Ce<0)return;Ft=Rt/(Rt-Ce),ae=ae+Pt*Ft,le=le+Z*Ft,he=he+J*Ft,Lt=Lt+pt*Ft}else Ce<0&&(Ft=Rt/(Rt-Ce),Oe=ae+Pt*Ft,Ve=le+Z*Ft,Ie=he+J*Ft,At=Lt+pt*Ft);Lt<0&&s.addPoint(ae,le,he,I,C,b,Lt,this.flip),At<0&&s.addPoint(Oe,Ve,Ie,I,C,b,At,this.flip)}}}}});function Su(){Pi.call(this)}Su.prototype=Object.assign(Object.create(Pi.prototype),{constructor:Su,getSep:function(t,e,s,r,n){var o,a,l,h,u,c,f=new U,p,g,y,v,z,x,m,d=t.position.x,w=t.position.y,N=t.position.z,S=e.position.x,k=e.position.y,O=e.position.z,E=S-d,M=k-w,R=O-N;E*E+M*M+R*R==0&&(M=.001);var D=-E,A=-M,P=-R;this.supportPoint(t,-D,-A,-P,f);var st=f.x,zt=f.y,tt=f.z;this.supportPoint(e,D,A,P,f);var L=f.x,W=f.y,V=f.z,q=L-st,H=W-zt,Q=V-tt;if(q*D+H*A+Q*P<=0)return!1;if(D=H*R-Q*M,A=Q*E-q*R,P=q*M-H*E,D*D+A*A+P*P==0)return s.set(q-E,H-M,Q-R).normalize(),r.set((st+L)*.5,(zt+W)*.5,(tt+V)*.5),!0;this.supportPoint(t,-D,-A,-P,f);var vt=f.x,Dt=f.y,It=f.z;this.supportPoint(e,D,A,P,f);var K=f.x,I=f.y,C=f.z,b=K-vt,$=I-Dt,G=C-It;if(b*D+$*A+G*P<=0)return!1;o=q-E,a=H-M,l=Q-R,h=b-E,u=$-M,c=G-R,D=a*c-l*u,A=l*h-o*c,P=o*u-a*h,D*E+A*M+P*R>0&&(o=q,a=H,l=Q,q=b,H=$,Q=G,b=o,$=a,G=l,o=st,a=zt,l=tt,st=vt,zt=Dt,tt=It,vt=o,Dt=a,It=l,o=L,a=W,l=V,L=K,W=I,V=C,K=o,I=a,C=l,D=-D,A=-A,P=-P);for(var Nt=0;;){if(++Nt>100)return!1;this.supportPoint(t,-D,-A,-P,f);var ut=f.x,yt=f.y,ft=f.z;this.supportPoint(e,D,A,P,f);var Yt=f.x,ue=f.y,wt=f.z,Y=Yt-ut,et=ue-yt,it=wt-ft;if(Y*D+et*A+it*P<=0)return!1;if((H*it-Q*et)*E+(Q*Y-q*it)*M+(q*et-H*Y)*R<0){b=Y,$=et,G=it,vt=ut,Dt=yt,It=ft,K=Yt,I=ue,C=wt,o=q-E,a=H-M,l=Q-R,h=Y-E,u=et-M,c=it-R,D=a*c-l*u,A=l*h-o*c,P=o*u-a*h;continue}if((et*G-it*$)*E+(it*b-Y*G)*M+(Y*$-et*b)*R<0){q=Y,H=et,Q=it,st=ut,zt=yt,tt=ft,L=Yt,W=ue,V=wt,o=Y-E,a=et-M,l=it-R,h=b-E,u=$-M,c=G-R,D=a*c-l*u,A=l*h-o*c,P=o*u-a*h;continue}for(var Pe=!1;;){if(o=b-q,a=$-H,l=G-Q,h=Y-q,u=et-H,c=it-Q,D=a*c-l*u,A=l*h-o*c,P=o*u-a*h,p=1/B.sqrt(D*D+A*A+P*P),D*=p,A*=p,P*=p,D*q+A*H+P*Q>=0&&!Pe){var qt=(H*G-Q*$)*Y+(Q*b-q*G)*et+(q*$-H*b)*it,$t=(et*G-it*$)*E+(it*b-Y*G)*M+(Y*$-et*b)*R,Xt=(M*Q-R*H)*Y+(R*q-E*Q)*et+(E*H-M*q)*it,Kt=($*Q-G*H)*E+(G*q-b*Q)*M+(b*H-$*q)*R,Le=qt+$t+Xt+Kt;Le<=0&&(qt=0,$t=($*it-G*et)*D+(G*Y-b*it)*A+(b*et-$*Y)*P,Xt=(et*G-it*$)*D+(it*b-Y*G)*A+(Y*$-et*b)*P,Kt=(H*G-Q*$)*D+(Q*b-q*G)*A+(q*$-H*b)*P,Le=$t+Xt+Kt);var at=1/Le;g=(d*qt+st*$t+vt*Xt+ut*Kt)*at,y=(w*qt+zt*$t+Dt*Xt+yt*Kt)*at,v=(N*qt+tt*$t+It*Xt+ft*Kt)*at,z=(S*qt+L*$t+K*Xt+Yt*Kt)*at,x=(k*qt+W*$t+I*Xt+ue*Kt)*at,m=(O*qt+V*$t+C*Xt+wt*Kt)*at,Pe=!0}this.supportPoint(t,-D,-A,-P,f);var lt=f.x,ht=f.y,Se=f.z;this.supportPoint(e,D,A,P,f);var re=f.x,ne=f.y,Et=f.z,dt=re-lt,mt=ne-ht,nt=Et-Se,Wt=-(dt*D+mt*A+nt*P);if((dt-Y)*D+(mt-et)*A+(nt-it)*P<=.01||Wt>=0)return Pe?(s.set(-D,-A,-P),r.set((g+z)*.5,(y+x)*.5,(v+m)*.5),n.x=Wt,!0):!1;(mt*Q-nt*H)*E+(nt*q-dt*Q)*M+(dt*H-mt*q)*R<0?(mt*G-nt*$)*E+(nt*b-dt*G)*M+(dt*$-mt*b)*R<0?(q=dt,H=mt,Q=nt,st=lt,zt=ht,tt=Se,L=re,W=ne,V=Et):(Y=dt,et=mt,it=nt,ut=lt,yt=ht,ft=Se,Yt=re,ue=ne,wt=Et):(mt*it-nt*et)*E+(nt*Y-dt*it)*M+(dt*et-mt*Y)*R<0?(b=dt,$=mt,G=nt,vt=lt,Dt=ht,It=Se,K=re,I=ne,C=Et):(q=dt,H=mt,Q=nt,st=lt,zt=ht,tt=Se,L=re,W=ne,V=Et)}}},supportPoint:function(t,e,s,r,n){var o=t.rotation.elements,a=o[0]*e+o[3]*s+o[6]*r,l=o[1]*e+o[4]*s+o[7]*r,h=o[2]*e+o[5]*s+o[8]*r,u=a,c=h,f=u*u+c*c,p=t.radius,g=t.halfHeight,y,v,z;f==0?l<0?(y=p,v=-g,z=0):(y=p,v=g,z=0):(f=t.radius/B.sqrt(f),l<0?(y=u*f,v=-g,z=c*f):(y=u*f,v=g,z=c*f)),a=o[0]*y+o[1]*v+o[2]*z+t.position.x,l=o[3]*y+o[4]*v+o[5]*z+t.position.y,h=o[6]*y+o[7]*v+o[8]*z+t.position.z,n.set(a,l,h)},detectCollision:function(t,e,s){var r,n;t.id<e.id?(r=t,n=e):(r=e,n=t);var o=r.position,a=n.position,l=o.x,h=o.y,u=o.z,c=a.x,f=a.y,p=a.z,g=r.halfHeight,y=n.halfHeight,v=r.normalDirection,z=n.normalDirection,x=r.halfDirection,m=n.halfDirection,d=r.radius,w=n.radius,N=v.x,S=v.y,k=v.z,O=z.x,E=z.y,M=z.z,R=x.x,D=x.y,A=x.z,P=m.x,st=m.y,zt=m.z,tt=l-c,L=h-f,W=u-p,V,q,H,Q,vt,Dt,It,K,I,C,b,$,G,Nt,ut,yt,ft,Yt,ue,wt,Y,et=new U,it=new U,Pe=new U;if(this.getSep(r,n,et,it,Pe)){var qt=et.x*N+et.y*S+et.z*k,$t=et.x*O+et.y*E+et.z*M,Xt=qt>0,Kt=$t>0;Xt||(qt=-qt),Kt||($t=-$t);var Le=0;(qt>.999||$t>.999)&&(qt>$t?Le=1:Le=2);var at,lt,ht,Se=Pe.x,re,ne,Et,dt,mt,nt,Wt,ee,Pt,Z,J,pt,xt,ge,te,ke,oe;switch(at=et.x,lt=et.y,ht=et.z,Le){case 0:s.addPoint(it.x,it.y,it.z,at,lt,ht,Se,!1);break;case 1:if(Xt?(q=l+R,H=h+D,Q=u+A,at=N,lt=S,ht=k):(q=l-R,H=h-D,Q=u-A,at=-N,lt=-S,ht=-k),ue=at*O+lt*E+ht*M,ue<0?V=y:V=-y,vt=c+V*O,Dt=f+V*E,It=p+V*M,$t>=.999999?(K=-lt,I=ht,C=at):(K=at,I=lt,C=ht),V=K*O+I*E+C*M,tt=V*O-K,L=V*E-I,W=V*M-C,V=B.sqrt(tt*tt+L*L+W*W),V==0)break;if(V=w/V,tt*=V,L*=V,W*=V,K=vt+tt,I=Dt+L,C=It+W,ue<-.96||ue>.96)re=O*O*1.5-.5,ne=O*E*1.5-M*.866025403,Et=O*M*1.5+E*.866025403,dt=E*O*1.5+M*.866025403,mt=E*E*1.5-.5,nt=E*M*1.5-O*.866025403,Wt=M*O*1.5-E*.866025403,ee=M*E*1.5+O*.866025403,Pt=M*M*1.5-.5,Z=K,J=I,pt=C,xt=at*(Z-q)+lt*(J-H)+ht*(pt-Q),K=Z-xt*at-q,I=J-xt*lt-H,C=pt-xt*ht-Q,V=K*K+I*I+C*C,V>d*d&&(V=d/B.sqrt(V),K*=V,I*=V,C*=V),Z=q+K,J=H+I,pt=Q+C,s.addPoint(Z,J,pt,at,lt,ht,xt,!1),Z=tt*re+L*ne+W*Et,J=tt*dt+L*mt+W*nt,pt=tt*Wt+L*ee+W*Pt,Z=(tt=Z)+vt,J=(L=J)+Dt,pt=(W=pt)+It,xt=at*(Z-q)+lt*(J-H)+ht*(pt-Q),xt<=0&&(K=Z-xt*at-q,I=J-xt*lt-H,C=pt-xt*ht-Q,V=K*K+I*I+C*C,V>d*d&&(V=d/B.sqrt(V),K*=V,I*=V,C*=V),Z=q+K,J=H+I,pt=Q+C,s.addPoint(Z,J,pt,at,lt,ht,xt,!1)),Z=tt*re+L*ne+W*Et,J=tt*dt+L*mt+W*nt,pt=tt*Wt+L*ee+W*Pt,Z=(tt=Z)+vt,J=(L=J)+Dt,pt=(W=pt)+It,xt=at*(Z-q)+lt*(J-H)+ht*(pt-Q),xt<=0&&(K=Z-xt*at-q,I=J-xt*lt-H,C=pt-xt*ht-Q,V=K*K+I*I+C*C,V>d*d&&(V=d/B.sqrt(V),K*=V,I*=V,C*=V),Z=q+K,J=H+I,pt=Q+C,s.addPoint(Z,J,pt,at,lt,ht,xt,!1));else{if(b=K,$=I,G=C,ft=at*(b-q)+lt*($-H)+ht*(G-Q),b-=ft*at,$-=ft*lt,G-=ft*ht,ue>0?(Nt=K+O*y*2,ut=I+E*y*2,yt=C+M*y*2):(Nt=K-O*y*2,ut=I-E*y*2,yt=C-M*y*2),Yt=at*(Nt-q)+lt*(ut-H)+ht*(yt-Q),Nt-=Yt*at,ut-=Yt*lt,yt-=Yt*ht,tt=q-b,L=H-$,W=Q-G,K=Nt-b,I=ut-$,C=yt-G,ge=tt*tt+L*L+W*W,te=tt*K+L*I+W*C,ke=K*K+I*I+C*C,oe=te*te-ke*(ge-d*d),oe<0)break;oe=B.sqrt(oe),wt=(te+oe)/ke,Y=(te-oe)/ke,Y<wt&&(V=wt,wt=Y,Y=V),Y>1&&(Y=1),wt<0&&(wt=0),K=b+(Nt-b)*wt,I=$+(ut-$)*wt,C=G+(yt-G)*wt,Nt=b+(Nt-b)*Y,ut=$+(ut-$)*Y,yt=G+(yt-G)*Y,b=K,$=I,G=C,V=ft+(Yt-ft)*wt,Yt=ft+(Yt-ft)*Y,ft=V,ft<0&&s.addPoint(b,$,G,at,lt,ht,xt,!1),Yt<0&&s.addPoint(Nt,ut,yt,at,lt,ht,xt,!1)}break;case 2:if(Kt?(vt=c-P,Dt=f-st,It=p-zt,at=-O,lt=-E,ht=-M):(vt=c+P,Dt=f+st,It=p+zt,at=O,lt=E,ht=M),ue=at*N+lt*S+ht*k,ue<0?V=g:V=-g,q=l+V*N,H=h+V*S,Q=u+V*k,qt>=.999999?(K=-lt,I=ht,C=at):(K=at,I=lt,C=ht),V=K*N+I*S+C*k,tt=V*N-K,L=V*S-I,W=V*k-C,V=B.sqrt(tt*tt+L*L+W*W),V==0)break;if(V=d/V,tt*=V,L*=V,W*=V,K=q+tt,I=H+L,C=Q+W,ue<-.96||ue>.96)re=N*N*1.5-.5,ne=N*S*1.5-k*.866025403,Et=N*k*1.5+S*.866025403,dt=S*N*1.5+k*.866025403,mt=S*S*1.5-.5,nt=S*k*1.5-N*.866025403,Wt=k*N*1.5-S*.866025403,ee=k*S*1.5+N*.866025403,Pt=k*k*1.5-.5,Z=K,J=I,pt=C,xt=at*(Z-vt)+lt*(J-Dt)+ht*(pt-It),K=Z-xt*at-vt,I=J-xt*lt-Dt,C=pt-xt*ht-It,V=K*K+I*I+C*C,V>w*w&&(V=w/B.sqrt(V),K*=V,I*=V,C*=V),Z=vt+K,J=Dt+I,pt=It+C,s.addPoint(Z,J,pt,-at,-lt,-ht,xt,!1),Z=tt*re+L*ne+W*Et,J=tt*dt+L*mt+W*nt,pt=tt*Wt+L*ee+W*Pt,Z=(tt=Z)+q,J=(L=J)+H,pt=(W=pt)+Q,xt=at*(Z-vt)+lt*(J-Dt)+ht*(pt-It),xt<=0&&(K=Z-xt*at-vt,I=J-xt*lt-Dt,C=pt-xt*ht-It,V=K*K+I*I+C*C,V>w*w&&(V=w/B.sqrt(V),K*=V,I*=V,C*=V),Z=vt+K,J=Dt+I,pt=It+C,s.addPoint(Z,J,pt,-at,-lt,-ht,xt,!1)),Z=tt*re+L*ne+W*Et,J=tt*dt+L*mt+W*nt,pt=tt*Wt+L*ee+W*Pt,Z=(tt=Z)+q,J=(L=J)+H,pt=(W=pt)+Q,xt=at*(Z-vt)+lt*(J-Dt)+ht*(pt-It),xt<=0&&(K=Z-xt*at-vt,I=J-xt*lt-Dt,C=pt-xt*ht-It,V=K*K+I*I+C*C,V>w*w&&(V=w/B.sqrt(V),K*=V,I*=V,C*=V),Z=vt+K,J=Dt+I,pt=It+C,s.addPoint(Z,J,pt,-at,-lt,-ht,xt,!1));else{if(b=K,$=I,G=C,ft=at*(b-vt)+lt*($-Dt)+ht*(G-It),b-=ft*at,$-=ft*lt,G-=ft*ht,ue>0?(Nt=K+N*g*2,ut=I+S*g*2,yt=C+k*g*2):(Nt=K-N*g*2,ut=I-S*g*2,yt=C-k*g*2),Yt=at*(Nt-vt)+lt*(ut-Dt)+ht*(yt-It),Nt-=Yt*at,ut-=Yt*lt,yt-=Yt*ht,tt=vt-b,L=Dt-$,W=It-G,K=Nt-b,I=ut-$,C=yt-G,ge=tt*tt+L*L+W*W,te=tt*K+L*I+W*C,ke=K*K+I*I+C*C,oe=te*te-ke*(ge-w*w),oe<0)break;oe=B.sqrt(oe),wt=(te+oe)/ke,Y=(te-oe)/ke,Y<wt&&(V=wt,wt=Y,Y=V),Y>1&&(Y=1),wt<0&&(wt=0),K=b+(Nt-b)*wt,I=$+(ut-$)*wt,C=G+(yt-G)*wt,Nt=b+(Nt-b)*Y,ut=$+(ut-$)*Y,yt=G+(yt-G)*Y,b=K,$=I,G=C,V=ft+(Yt-ft)*wt,Yt=ft+(Yt-ft)*Y,ft=V,ft<0&&s.addPoint(b,$,G,-at,-lt,-ht,ft,!1),Yt<0&&s.addPoint(Nt,ut,yt,-at,-lt,-ht,Yt,!1)}break}}}});function sl(t){Pi.call(this),this.flip=t}sl.prototype=Object.assign(Object.create(Pi.prototype),{constructor:sl,detectCollision:function(t,e,s){var r,n;this.flip?(r=e,n=t):(r=t,n=e);var o=n.dimentions,a=r.position,l=a.x,h=a.y,u=a.z,c=n.position,f=c.x,p=c.y,g=c.z,y=r.radius,v=n.halfWidth,z=n.halfHeight,x=n.halfDepth,m=l-f,d=h-p,w=u-g,N=o[0]*m+o[1]*d+o[2]*w,S=o[3]*m+o[4]*d+o[5]*w,k=o[6]*m+o[7]*d+o[8]*w,O,E,M,R,D,A=0;N>v?N=v:N<-v?N=-v:A=1,S>z?S=z:S<-z?S=-z:A|=2,k>x?k=x:k<-x?k=-x:A|=4,A==7?(N<0?m=v+N:m=v-N,S<0?d=z+S:d=z-S,k<0?w=x+k:w=x-k,m<d?m<w?(R=m-v,N<0?(N=-v,m=o[0],d=o[1],w=o[2]):(N=v,m=-o[0],d=-o[1],w=-o[2])):(R=w-x,k<0?(k=-x,m=o[6],d=o[7],w=o[8]):(k=x,m=-o[6],d=-o[7],w=-o[8])):d<w?(R=d-z,S<0?(S=-z,m=o[3],d=o[4],w=o[5]):(S=z,m=-o[3],d=-o[4],w=-o[5])):(R=w-x,k<0?(k=-x,m=o[6],d=o[7],w=o[8]):(k=x,m=-o[6],d=-o[7],w=-o[8])),O=f+N*o[0]+S*o[3]+k*o[6],E=p+N*o[1]+S*o[4]+k*o[7],M=g+N*o[2]+S*o[5]+k*o[8],s.addPoint(l+y*m,h+y*d,u+y*w,m,d,w,R-y,this.flip)):(O=f+N*o[0]+S*o[3]+k*o[6],E=p+N*o[1]+S*o[4]+k*o[7],M=g+N*o[2]+S*o[5]+k*o[8],m=O-a.x,d=E-a.y,w=M-a.z,R=m*m+d*d+w*w,R>0&&R<y*y&&(R=B.sqrt(R),D=1/R,m*=D,d*=D,w*=D,s.addPoint(l+y*m,h+y*d,u+y*w,m,d,w,R-y,this.flip)))}});function rl(t){Pi.call(this),this.flip=t}rl.prototype=Object.assign(Object.create(Pi.prototype),{constructor:rl,detectCollision:function(t,e,s){var r,n;this.flip?(r=e,n=t):(r=t,n=e);var o=r.position,a=o.x,l=o.y,h=o.z,u=n.position,c=u.x,f=u.y,p=u.z,g=n.normalDirection.x,y=n.normalDirection.y,v=n.normalDirection.z,z=r.radius,x=n.radius,m=z+x,d=n.halfHeight,w=a-c,N=l-f,S=h-p,k=w*g+N*y+S*v;if(!(k<-d-z||k>d+z)){var O=c+k*g,E=f+k*y,M=p+k*v,R=a-O,D=l-E,A=h-M,P=R*R+D*D+A*A;if(!(P>m*m)){P>x*x&&(P=x/B.sqrt(P),R*=P,D*=P,A*=P),k<-d?k=-d:k>d&&(k=d),O=c+k*g+R,E=f+k*y+D,M=p+k*v+A,w=O-a,N=E-l,S=M-h,P=w*w+N*N+S*S;var st;P>0&&P<z*z&&(P=B.sqrt(P),st=1/P,w*=st,N*=st,S*=st,s.addPoint(a+w*z,l+N*z,h+S*z,w,N,S,P-z,this.flip))}}}});function ku(){Pi.call(this)}ku.prototype=Object.assign(Object.create(Pi.prototype),{constructor:ku,detectCollision:function(t,e,s){var r=t,n=e,o=r.position,a=n.position,l=a.x-o.x,h=a.y-o.y,u=a.z-o.z,c=l*l+h*h+u*u,f=r.radius,p=n.radius,g=f+p;if(c>0&&c<g*g){c=B.sqrt(c);var y=1/c;l*=y,h*=y,u*=y,s.addPoint(o.x+l*f,o.y+h*f,o.z+u*f,l,h,u,c-g,!1)}}});function nl(t){Pi.call(this),this.flip=t,this.n=new U,this.p=new U}nl.prototype=Object.assign(Object.create(Pi.prototype),{constructor:nl,detectCollision:function(t,e,s){var r=this.n,n=this.p,o=this.flip?e:t,a=this.flip?t:e,l=o.radius,h;r.sub(o.position,a.position),r.x*=a.normal.x,r.y*=a.normal.y,r.z*=a.normal.z;var h=r.lengthSq();h>0&&h<l*l&&(h=B.sqrt(h),r.copy(a.normal).negate(),n.copy(o.position).addScaledVector(r,l),s.addPointVec(n,r,h-l,this.flip))}});function ol(t){Pi.call(this),this.flip=t,this.n=new U,this.p=new U,this.dix=new U,this.diy=new U,this.diz=new U,this.cc=new U,this.cc2=new U}ol.prototype=Object.assign(Object.create(Pi.prototype),{constructor:ol,detectCollision:function(t,e,s){var r=this.n,n=this.p,o=this.cc,a=this.flip?e:t,l=this.flip?t:e,h=a.dimentions,u=a.halfWidth,c=a.halfHeight,f=a.halfDepth,p,g=0;this.dix.set(h[0],h[1],h[2]),this.diy.set(h[3],h[4],h[5]),this.diz.set(h[6],h[7],h[8]),r.sub(a.position,l.position),r.x*=l.normal.x,r.y*=l.normal.y,r.z*=l.normal.z,o.set(B.dotVectors(this.dix,r),B.dotVectors(this.diy,r),B.dotVectors(this.diz,r)),o.x>u?o.x=u:o.x<-u?o.x=-u:g=1,o.y>c?o.y=c:o.y<-c?o.y=-c:g|=2,o.z>f?o.z=f:o.z<-f?o.z=-f:g|=4,g===7&&(r.set(o.x<0?u+o.x:u-o.x,o.y<0?c+o.y:c-o.y,o.z<0?f+o.z:f-o.z),r.x<r.y?r.x<r.z?(p=r.x-u,o.x<0?(o.x=-u,r.copy(this.dix)):(o.x=u,r.subEqual(this.dix))):(p=r.z-f,o.z<0?(o.z=-f,r.copy(this.diz)):(o.z=f,r.subEqual(this.diz))):r.y<r.z?(p=r.y-c,o.y<0?(o.y=-c,r.copy(this.diy)):(o.y=c,r.subEqual(this.diy))):(p=r.z-f,o.z<0?(o.z=-f,r.copy(this.diz)):(o.z=f,r.subEqual(this.diz))),n.copy(l.position).addScaledVector(r,1),s.addPointVec(n,r,p,this.flip))}});function _d(t){switch(t instanceof Object||(t={}),this.scale=t.worldscale||1,this.invScale=1/this.scale,this.timeStep=t.timestep||.01666,this.timerate=this.timeStep*1e3,this.timer=null,this.preLoop=null,this.postLoop=null,this.numIterations=t.iterations||8,t.broadphase||2){case 1:this.broadPhase=new yu;break;case 2:default:this.broadPhase=new gu;break;case 3:this.broadPhase=new zu;break}this.Btypes=["None","BruteForce","Sweep & Prune","Bounding Volume Tree"],this.broadPhaseType=this.Btypes[t.broadphase||2],this.performance=null,this.isStat=t.info===void 0?!1:t.info,this.isStat&&(this.performance=new zd(this)),this.enableRandomizer=t.random!==void 0?t.random:!0,this.rigidBodies=null,this.numRigidBodies=0,this.contacts=null,this.unusedContacts=null,this.numContacts=0,this.numContactPoints=0,this.joints=null,this.numJoints=0,this.numIslands=0,this.gravity=new U(0,-9.8,0),t.gravity!==void 0&&this.gravity.fromArray(t.gravity);var e=5;this.detectors=[],this.detectors.length=e;for(var s=e;s--;)this.detectors[s]=[],this.detectors[s].length=e;this.detectors[lr][lr]=new ku,this.detectors[lr][hr]=new sl(!1),this.detectors[hr][lr]=new sl(!0),this.detectors[hr][hr]=new Nu,this.detectors[Wr][Wr]=new Su,this.detectors[Wr][hr]=new il(!0),this.detectors[hr][Wr]=new il(!1),this.detectors[Wr][lr]=new rl(!0),this.detectors[lr][Wr]=new rl(!1),this.detectors[ho][lr]=new nl(!0),this.detectors[lr][ho]=new nl(!1),this.detectors[ho][hr]=new ol(!0),this.detectors[hr][ho]=new ol(!1),this.randX=65535,this.randA=98765,this.randB=123456789,this.islandRigidBodies=[],this.islandStack=[],this.islandConstraints=[]}Object.assign(_d.prototype,{World:!0,play:function(){if(this.timer===null){var t=this;this.timer=setInterval(function(){t.step()},this.timerate)}},stop:function(){this.timer!==null&&(clearInterval(this.timer),this.timer=null)},setGravity:function(t){this.gravity.fromArray(t)},getInfo:function(){return this.isStat?this.performance.show():""},clear:function(){for(this.stop(),this.preLoop=null,this.postLoop=null,this.randX=65535;this.joints!==null;)this.removeJoint(this.joints);for(;this.contacts!==null;)this.removeContact(this.contacts);for(;this.rigidBodies!==null;)this.removeRigidBody(this.rigidBodies)},addRigidBody:function(t){t.parent&&Ni("World","It is not possible to be added to more than one world one of the rigid body"),t.setParent(this);for(var e=t.shapes;e!==null;e=e.next)this.addShape(e);this.rigidBodies!==null&&((this.rigidBodies.prev=t).next=this.rigidBodies),this.rigidBodies=t,this.numRigidBodies++},removeRigidBody:function(t){var e=t;if(e.parent===this){e.awake();for(var s=e.jointLink;s!=null;){var r=s.joint;s=s.next,this.removeJoint(r)}for(var n=t.shapes;n!==null;n=n.next)this.removeShape(n);var o=e.prev,a=e.next;o!==null&&(o.next=a),a!==null&&(a.prev=o),this.rigidBodies==e&&(this.rigidBodies=a),e.prev=null,e.next=null,e.parent=null,this.numRigidBodies--}},getByName:function(t){for(var e=this.rigidBodies;e!==null;){if(e.name===t)return e;e=e.next}for(var s=this.joints;s!==null;){if(s.name===t)return s;s=s.next}return null},addShape:function(t){(!t.parent||!t.parent.parent)&&Ni("World","It is not possible to be added alone to shape world"),t.proxy=this.broadPhase.createProxy(t),t.updateProxy(),this.broadPhase.addProxy(t.proxy)},removeShape:function(t){this.broadPhase.removeProxy(t.proxy),t.proxy=null},addJoint:function(t){t.parent&&Ni("World","It is not possible to be added to more than one world one of the joint"),this.joints!=null&&((this.joints.prev=t).next=this.joints),this.joints=t,t.setParent(this),this.numJoints++,t.awake(),t.attach()},removeJoint:function(t){var e=t,s=e.prev,r=e.next;s!==null&&(s.next=r),r!==null&&(r.prev=s),this.joints==e&&(this.joints=r),e.prev=null,e.next=null,this.numJoints--,e.awake(),e.detach(),e.parent=null},addContact:function(t,e){var s;this.unusedContacts!==null?(s=this.unusedContacts,this.unusedContacts=this.unusedContacts.next):s=new kd,s.attach(t,e),s.detector=this.detectors[t.type][e.type],this.contacts&&((this.contacts.prev=s).next=this.contacts),this.contacts=s,this.numContacts++},removeContact:function(t){var e=t.prev,s=t.next;s&&(s.prev=e),e&&(e.next=s),this.contacts==t&&(this.contacts=s),t.prev=null,t.next=null,t.detach(),t.next=this.unusedContacts,this.unusedContacts=t,this.numContacts--},getContact:function(t,e){t=t.constructor===pn?t.name:t,e=e.constructor===pn?e.name:e;for(var s,r,n=this.contacts;n!==null;){if(s=n.body1.name,r=n.body2.name,s===t&&r===e||r===t&&s===e)return n.touching?n:null;n=n.next}return null},checkContact:function(t,e){for(var s,r,n=this.contacts;n!==null;){if(s=n.body1.name||" ",r=n.body2.name||" ",s==t&&r==e||r==t&&s==e)return!!n.touching;n=n.next}},callSleep:function(t){return!(!t.allowSleep||t.linearVelocity.lengthSq()>.04||t.angularVelocity.lengthSq()>.25)},step:function(){var t=this.isStat;t&&this.performance.setTime(0);for(var e=this.rigidBodies;e!==null;)e.addedToIsland=!1,e.sleeping&&e.testWakeUp(),e=e.next;t&&this.performance.setTime(1),this.broadPhase.detectPairs();for(var s=this.broadPhase.pairs,r=this.broadPhase.numPairs;r--;){var n=s[r],o,a;n.shape1.id<n.shape2.id?(o=n.shape1,a=n.shape2):(o=n.shape2,a=n.shape1);var l;o.numContacts<a.numContacts?l=o.contactLink:l=a.contactLink;for(var h=!1;l;){var u=l.contact;if(u.shape1==o&&u.shape2==a){u.persisting=!0,h=!0;break}l=l.next}h||this.addContact(o,a)}for(t&&this.performance.calcBroadPhase(),this.numContactPoints=0,u=this.contacts;u!==null;){if(!u.persisting&&u.shape1.aabb.intersectTest(u.shape2.aabb)){var c=u.next;this.removeContact(u),u=c;continue}var f=u.body1,p=u.body2;(f.isDynamic&&!f.sleeping||p.isDynamic&&!p.sleeping)&&u.updateManifold(),this.numContactPoints+=u.manifold.numPoints,u.persisting=!1,u.constraint.addedToIsland=!1,u=u.next}t&&this.performance.calcNarrowPhase();var g=1/this.timeStep,y,v;for(y=this.joints;y!==null;y=y.next)y.addedToIsland=!1;this.islandRigidBodies=[],this.islandConstraints=[],this.islandStack=[],t&&this.performance.setTime(1),this.numIslands=0;for(var z=this.rigidBodies;z!==null;z=z.next)if(!(z.addedToIsland||z.isStatic||z.sleeping)){if(z.isLonely()){z.isDynamic&&z.linearVelocity.addScaledVector(this.gravity,this.timeStep),this.callSleep(z)?(z.sleepTime+=this.timeStep,z.sleepTime>.5?z.sleep():z.updatePosition(this.timeStep)):(z.sleepTime=0,z.updatePosition(this.timeStep)),this.numIslands++;continue}var x=0,m=0,d=1;this.islandStack[0]=z,z.addedToIsland=!0;do if(e=this.islandStack[--d],this.islandStack[d]=null,e.sleeping=!1,this.islandRigidBodies[x++]=e,!e.isStatic){for(var w=e.contactLink;w!==null;w=w.next){var u=w.contact;if(v=u.constraint,!(v.addedToIsland||!u.touching)){this.islandConstraints[m++]=v,v.addedToIsland=!0;var c=w.body;c.addedToIsland||(this.islandStack[d++]=c,c.addedToIsland=!0)}}for(var N=e.jointLink;N!==null;N=N.next)v=N.joint,!v.addedToIsland&&(this.islandConstraints[m++]=v,v.addedToIsland=!0,c=N.body,!(c.addedToIsland||!c.isDynamic)&&(this.islandStack[d++]=c,c.addedToIsland=!0))}while(d!=0);for(var S=new U().addScaledVector(this.gravity,this.timeStep),k=x;k--;)e=this.islandRigidBodies[k],e.isDynamic&&e.linearVelocity.addEqual(S);if(this.enableRandomizer){for(k=m;k--;)if(k!==0){var O=(this.randX=this.randX*this.randA+this.randB&2147483647)/2147483648*k|0;v=this.islandConstraints[k],this.islandConstraints[k]=this.islandConstraints[O],this.islandConstraints[O]=v}}for(k=m;k--;)this.islandConstraints[k].preSolve(this.timeStep,g);for(var E=this.numIterations;E--;)for(k=m;k--;)this.islandConstraints[k].solve();for(k=m;k--;)this.islandConstraints[k].postSolve(),this.islandConstraints[k]=null;var M=10;for(k=x;k--;)if(e=this.islandRigidBodies[k],this.callSleep(e))e.sleepTime+=this.timeStep,e.sleepTime<M&&(M=e.sleepTime);else{e.sleepTime=0,M=0;continue}if(M>.5)for(k=x;k--;)this.islandRigidBodies[k].sleep(),this.islandRigidBodies[k]=null;else for(k=x;k--;)this.islandRigidBodies[k].updatePosition(this.timeStep),this.islandRigidBodies[k]=null;this.numIslands++}t&&this.performance.calcEnd(),this.postLoop!==null&&this.postLoop()},remove:function(t){},add:function(t){t=t||{};var e=t.type||"box";e.constructor===String&&(e=[e]);var s=e[0].substring(0,5)==="joint";return s?this.initJoint(e[0],t):this.initBody(e,t)},initBody:function(t,e){var s=this.invScale,r=e.move||!1,n=e.kinematic||!1,o=e.pos||[0,0,0];o=o.map(function(x){return x*s});var a=e.posShape||[0,0,0];a=a.map(function(x){return x*s});var l=e.rot||[0,0,0];l=l.map(function(x){return x*B.degtorad});var h=e.rotShape||[0,0,0];h=l.map(function(x){return x*B.degtorad});var u=e.size===void 0?[1,1,1]:e.size;u.length===1&&(u[1]=u[0]),u.length===2&&(u[2]=u[0]),u=u.map(function(x){return x*s});var c=new Av;e.density!==void 0&&(c.density=e.density),e.friction!==void 0&&(c.friction=e.friction),e.restitution!==void 0&&(c.restitution=e.restitution),e.belongsTo!==void 0&&(c.belongsTo=e.belongsTo),e.collidesWith!==void 0&&(c.collidesWith=e.collidesWith),e.config!==void 0&&(e.config[0]!==void 0&&(c.density=e.config[0]),e.config[1]!==void 0&&(c.friction=e.config[1]),e.config[2]!==void 0&&(c.restitution=e.config[2]),e.config[3]!==void 0&&(c.belongsTo=e.config[3]),e.config[4]!==void 0&&(c.collidesWith=e.config[4]));for(var f=new U(o[0],o[1],o[2]),p=new Si().setFromEuler(l[0],l[1],l[2]),g=new pn(f,p),y,v,z=0;z<t.length;z++){switch(v=z*3,a[v]!==void 0&&c.relativePosition.set(a[v],a[v+1],a[v+2]),h[v]!==void 0&&c.relativeRotation.setQuat(new Si().setFromEuler(h[v],h[v+1],h[v+2])),t[z]){case"sphere":y=new nu(c,u[v]);break;case"cylinder":y=new ou(c,u[v],u[v+1]);break;case"box":y=new ru(c,u[v],u[v+1],u[v+2]);break;case"plane":y=new au(c);break}g.addShape(y)}return e.neverSleep||n?g.allowSleep=!1:g.allowSleep=!0,g.isKinematic=n,r?e.massPos||e.massRot?g.setupMass(el,!1):g.setupMass(el,!0):g.setupMass(lo),e.name!==void 0&&(g.name=e.name),this.addRigidBody(g),r&&(e.sleep?g.sleep():g.awake()),g},initJoint:function(t,e){var s=this.invScale,r=e.axe1||[1,0,0],n=e.axe2||[1,0,0],o=e.pos1||[0,0,0],a=e.pos2||[0,0,0];o=o.map(function(z){return z*s}),a=a.map(function(z){return z*s});var l,h;t==="jointDistance"?(l=e.min||0,h=e.max||10,l=l*s,h=h*s):(l=e.min||57.29578,h=e.max||0,l=l*B.degtorad,h=h*B.degtorad);var u=e.limit||null,c=e.spring||null,f=e.motor||null,p=new Fv;p.scale=this.scale,p.invScale=this.invScale,p.allowCollision=e.collision||!1,p.localAxis1.set(r[0],r[1],r[2]),p.localAxis2.set(n[0],n[1],n[2]),p.localAnchorPoint1.set(o[0],o[1],o[2]),p.localAnchorPoint2.set(a[0],a[1],a[2]);var g=null,y=null;if(e.body1===void 0||e.body2===void 0)return Ni("World","Can't add joint if attach rigidbodys not define !");if(e.body1.constructor===String?g=this.getByName(e.body1):e.body1.constructor===Number?g=this.getByName(e.body1):e.body1.constructor===pn&&(g=e.body1),e.body2.constructor===String?y=this.getByName(e.body2):e.body2.constructor===Number?y=this.getByName(e.body2):e.body2.constructor===pn&&(y=e.body2),g===null||y===null)return Ni("World","Can't add joint attach rigidbodys not find !");p.body1=g,p.body2=y;var v;switch(t){case"jointDistance":v=new uu(p,l,h),c!==null&&v.limitMotor.setSpring(c[0],c[1]),f!==null&&v.limitMotor.setMotor(f[0],f[1]);break;case"jointHinge":case"joint":v=new lu(p,l,h),c!==null&&v.limitMotor.setSpring(c[0],c[1]),f!==null&&v.limitMotor.setMotor(f[0],f[1]);break;case"jointPrisme":v=new cu(p,l,h);break;case"jointSlide":v=new fu(p,l,h);break;case"jointBall":v=new hu(p);break;case"jointWheel":v=new pu(p),u!==null&&v.rotationalLimitMotor1.setLimit(u[0],u[1]),c!==null&&v.rotationalLimitMotor1.setSpring(c[0],c[1]),f!==null&&v.rotationalLimitMotor1.setMotor(f[0],f[1]);break}return v.name=e.name||"",this.addJoint(v),v}});const jv=()=>new _d({timestep:1/30,info:!0,worldscale:1,gravity:[0,0,-9.8]}),$v=(t,e,s,r=1)=>t.add({type:"sphere",size:s.triplet,pos:e.triplet,move:!0,density:2,world:t,restitution:.5,friction:.3}),Gv=(t,e,s,r,n=1)=>t.add({type:"box",size:s.triplet,pos:e.triplet,rot:r,rotShape:r,move:!0,density:1,world:t,restitution:.5,friction:.3}),Hv=(t,e,s,r,n=1)=>t.add({type:"cylinder",size:s.triplet,pos:e.triplet,rot:r,move:!0,density:1,world:t,restitution:.5,friction:.3}),Wv=(t,e,s)=>{const r=t.add({type:"box",size:[s.x,s.y,s.z],pos:[e.x,e.y,e.z],rot:[0,0,0],move:!1,density:1,friction:.5,restitution:.2});return r.name="floor",r},qv=(t,e)=>{const s=e.getScene();t.step(),s.forEach(r=>{const n=r.body;if(n&&n.isDynamic){const o=n.getPosition();o.z<-20&&(t.remove(n),e.removeFromScene(r.id));const a=n.getQuaternion(),l=Ht.fromValues(o.x,o.y,o.z),h=En.fromValues(a.x,a.y,a.z,a.w);r.rotoTranslate(h,l)}})};let Qv=0,Xf=0,Yv=0,Xv=0;const Sc=18,qi=14,kc=20,Ld=t=>{const s=Ht.fromValues(0,0,0),r=Ht.fromValues(120,120,.1),n=fv()(Vt.identity(),{id:`ref-xyplane-${Xf++}`,colors:[[.3,.3,.3,.9]],steps:4});n.scale(r),n.translate(s.add(Ht.fromValues(0,0,-.1/2)));const o=dv()(Vt.scale(r.x,r.y,r.z),{id:`ref-xygrid-${Xf++}`,colors:[[1,1,1,.8],[1,1,1,.4],[1,1,1,.1]],showAxes:!0});o.translate(s);const a=Wv(t,s,r);return n.setBody(a),[n,o]},Kv=(t,e)=>{const s=[];for(let r=0;r<Sc;r++){const n=Ht.fromValues(-qi+Math.random()*qi*2,-qi+Math.random()*qi*2,kc+Math.random()*qi*2),o=Ht.fromValues(1,1,1),a=uv()(Vt.identity(),{id:`sphere-${Qv++}`,steps:2,textureCoordinates:!0,colors:[[Math.random(),Math.random(),Math.random(),1]]});a.scale(o),a.translate(n);const l=$v(t,n,o);a.setBody(l),e&&a.addMaterial(e),s.unshift(a)}return s},Zv=(t,e)=>{const s=[];for(let r=0;r<Sc;r++){const n=Ht.fromValues(-qi+Math.random()*qi*2,-qi+Math.random()*qi*2,kc+Math.random()*qi*2),o=Ht.fromValues(2,2,2),a=[Math.random()*90,Math.random()*90,Math.random()*90],l=En.fromAngles(...a.map(sr)),h=sv()(Vt.identity(),{id:`cube-${Yv++}`,colors:[[Math.random(),Math.random(),Math.random(),1]],textureCoordinates:!!e,alpha:.5,bumpIntensity:0});h.scale(o),h.translate(n),h.rotate(l);const u=Gv(t,n,o,a);h.setBody(u),e&&h.addMaterial(e),s.push(h)}return s},Jv=(t,e)=>{const s=[];for(let r=0;r<Sc;r++){const n=Ht.fromValues(-qi+Math.random()*qi*2,-qi+Math.random()*qi*2,kc+Math.random()*qi*2),o=[Math.random()*90,Math.random()*90,Math.random()*90],a=En.fromAngles(...o.map(sr)),l=Ht.fromValues(2,2,2),h=nv()(Vt.rotationX(sr(90)),{id:`cylinder-${Xv++}`,steps:12,colors:[[Math.random(),Math.random(),.3,1]],textureCoordinates:!0,alpha:.6,bumpIntensity:0});h.scale(l),h.translate(n),h.rotate(a);const u=Hv(t,n,Ht.fromValues(1,2,1),o);h.setBody(u),e&&h.addMaterial(e),s.push(h)}return s},ty=(t,e,s)=>{switch(t){case"plane":return Ld(e);case"sphere":return Kv(e,s[0]);case"cube":return Zv(e,s[1]);case"cylinder":return Jv(e,s[2]);default:throw new Error(`Unknown geoTool: ${t}`)}},ey=(t,e,s,r)=>{const n=ty(s,e,r);t.addToScene(n)},so="border-solid border-[1px] border-slate-800 mt-[-1px]";function iy(){const[t,e]=Ns.useState("Initializing WebGPU..."),[s,r]=Ns.useState(null),[n,o]=Ns.useState(null),[a,l]=Ns.useState([]);Ns.useEffect(()=>{s&&K2(s,["soccer.png","dice.jpg","wood.jpg"]).then(([p,g])=>{l(g)}).catch(p=>e(p.message))},[s]);const h=p=>{e(p.message)},u=p=>{r(p),e("");const g=jv();o(g),p.addToScene(Ld(g)),p.onRender(()=>{g&&qv(g,p)})},c=p=>{if(!s||!n){e("WebGPU not initialized");return}ey(s,n,p,a)},f=()=>{if(!s||!n){e("WebGPU not initialized");return}s.getScene().forEach(g=>{g.id.startsWith("ref-xy")||s.removeFromScene(g.id)});let p=n.getBodyList();for(;p;){const g=p.getNext();p.name!=="floor"&&n.removeBody(p),p=g}};return ye.jsxs(ye.Fragment,{children:[ye.jsx("div",{className:`flex flex-row justify-between items-center ${so} h-[40px]  leading-[40px]`,id:"top-bar",children:ye.jsx("h1",{className:"mx-2",children:"Demo # 3 - WebGPU and Oimo.js"})}),ye.jsxs("div",{id:"app-space",className:`flex-1 flex flex-row overflow-hidden ${so} min-h-[600px] bg-gray-800`,children:[ye.jsx(xv,{onSelected:c,onClear:f}),ye.jsx("div",{className:"flex-1",children:ye.jsx(yv,{onError:h,onConnected:u})})]}),ye.jsxs("div",{id:"bottom-bar",className:`flex flex-row justify-between items-stretch text-xs ${so} h-[30px] leading-[30px]`,children:[ye.jsx("h3",{className:"m-0",children:"Bottom bar"}),t.length===0?ye.jsx("div",{className:`px-2 ${so}`,children:"WebGPU  "}):ye.jsx("div",{className:`text-red-500 px-2 ${so}`,children:t})]})]})}ah.createRoot(document.getElementById("main")).render(ye.jsx(iy,{}));
